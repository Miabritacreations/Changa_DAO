import{c as Xr,g as qu}from"./vendor-D0rITPFI.js";const Vu="modulepreload",Gu=function(t){return"/"+t},ao={},Ku=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(r.map(h=>{if(h=Gu(h),h in ao)return;ao[h]=!0;const w=h.endsWith(".css"),A=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${A}`))return;const _=document.createElement("link");if(_.rel=w?"stylesheet":Vu,w||(_.as="script"),_.crossOrigin="",_.href=h,o&&_.setAttribute("nonce",o),document.head.appendChild(_),w)return new Promise((m,E)=>{_.addEventListener("load",m),_.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};var aa={},An={};An.byteLength=Yu;An.toByteArray=Lu;An.fromByteArray=Du;var Ut=[],lt=[],ju=typeof Uint8Array<"u"?Uint8Array:Array,Zi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Ur=0,Hu=Zi.length;Ur<Hu;++Ur)Ut[Ur]=Zi[Ur],lt[Zi.charCodeAt(Ur)]=Ur;lt[45]=62;lt[95]=63;function ca(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function Yu(t){var e=ca(t),r=e[0],n=e[1];return(r+n)*3/4-n}function Wu(t,e,r){return(e+r)*3/4-r}function Lu(t){var e,r=ca(t),n=r[0],i=r[1],s=new ju(Wu(t,n,i)),a=0,o=i>0?n-4:n,h;for(h=0;h<o;h+=4)e=lt[t.charCodeAt(h)]<<18|lt[t.charCodeAt(h+1)]<<12|lt[t.charCodeAt(h+2)]<<6|lt[t.charCodeAt(h+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=e&255;return i===2&&(e=lt[t.charCodeAt(h)]<<2|lt[t.charCodeAt(h+1)]>>4,s[a++]=e&255),i===1&&(e=lt[t.charCodeAt(h)]<<10|lt[t.charCodeAt(h+1)]<<4|lt[t.charCodeAt(h+2)]>>2,s[a++]=e>>8&255,s[a++]=e&255),s}function zu(t){return Ut[t>>18&63]+Ut[t>>12&63]+Ut[t>>6&63]+Ut[t&63]}function Zu(t,e,r){for(var n,i=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),i.push(zu(n));return i.join("")}function Du(t){for(var e,r=t.length,n=r%3,i=[],s=16383,a=0,o=r-n;a<o;a+=s)i.push(Zu(t,a,a+s>o?o:a+s));return n===1?(e=t[r-1],i.push(Ut[e>>2]+Ut[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(Ut[e>>10]+Ut[e>>4&63]+Ut[e<<2&63]+"=")),i.join("")}var Tn={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Tn.read=function(t,e,r,n,i){var s,a,o=i*8-n-1,h=(1<<o)-1,w=h>>1,A=-7,_=r?i-1:0,m=r?-1:1,E=t[e+_];for(_+=m,s=E&(1<<-A)-1,E>>=-A,A+=o;A>0;s=s*256+t[e+_],_+=m,A-=8);for(a=s&(1<<-A)-1,s>>=-A,A+=n;A>0;a=a*256+t[e+_],_+=m,A-=8);if(s===0)s=1-w;else{if(s===h)return a?NaN:(E?-1:1)*(1/0);a=a+Math.pow(2,n),s=s-w}return(E?-1:1)*a*Math.pow(2,s-n)};Tn.write=function(t,e,r,n,i,s){var a,o,h,w=s*8-i-1,A=(1<<w)-1,_=A>>1,m=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=n?0:s-1,T=n?1:-1,O=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=A):(a=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-a))<1&&(a--,h*=2),a+_>=1?e+=m/h:e+=m*Math.pow(2,1-_),e*h>=2&&(a++,h/=2),a+_>=A?(o=0,a=A):a+_>=1?(o=(e*h-1)*Math.pow(2,i),a=a+_):(o=e*Math.pow(2,_-1)*Math.pow(2,i),a=0));i>=8;t[r+E]=o&255,E+=T,o/=256,i-=8);for(a=a<<i|o,w+=i;w>0;t[r+E]=a&255,E+=T,a/=256,w-=8);t[r+E-T]|=O*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=An,r=Tn,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=o,t.SlowBuffer=G,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,o.TYPED_ARRAY_SUPPORT=s(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const p=new Uint8Array(1),f={foo:function(){return 42}};return Object.setPrototypeOf(f,Uint8Array.prototype),Object.setPrototypeOf(p,f),p.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function a(p){if(p>i)throw new RangeError('The value "'+p+'" is invalid for option "size"');const f=new Uint8Array(p);return Object.setPrototypeOf(f,o.prototype),f}function o(p,f,l){if(typeof p=="number"){if(typeof f=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return _(p)}return h(p,f,l)}o.poolSize=8192;function h(p,f,l){if(typeof p=="string")return m(p,f);if(ArrayBuffer.isView(p))return T(p);if(p==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p);if(V(p,ArrayBuffer)||p&&V(p.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(V(p,SharedArrayBuffer)||p&&V(p.buffer,SharedArrayBuffer)))return O(p,f,l);if(typeof p=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const v=p.valueOf&&p.valueOf();if(v!=null&&v!==p)return o.from(v,f,l);const R=Y(p);if(R)return R;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof p[Symbol.toPrimitive]=="function")return o.from(p[Symbol.toPrimitive]("string"),f,l);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p)}o.from=function(p,f,l){return h(p,f,l)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function w(p){if(typeof p!="number")throw new TypeError('"size" argument must be of type number');if(p<0)throw new RangeError('The value "'+p+'" is invalid for option "size"')}function A(p,f,l){return w(p),p<=0?a(p):f!==void 0?typeof l=="string"?a(p).fill(f,l):a(p).fill(f):a(p)}o.alloc=function(p,f,l){return A(p,f,l)};function _(p){return w(p),a(p<0?0:C(p)|0)}o.allocUnsafe=function(p){return _(p)},o.allocUnsafeSlow=function(p){return _(p)};function m(p,f){if((typeof f!="string"||f==="")&&(f="utf8"),!o.isEncoding(f))throw new TypeError("Unknown encoding: "+f);const l=F(p,f)|0;let v=a(l);const R=v.write(p,f);return R!==l&&(v=v.slice(0,R)),v}function E(p){const f=p.length<0?0:C(p.length)|0,l=a(f);for(let v=0;v<f;v+=1)l[v]=p[v]&255;return l}function T(p){if(V(p,Uint8Array)){const f=new Uint8Array(p);return O(f.buffer,f.byteOffset,f.byteLength)}return E(p)}function O(p,f,l){if(f<0||p.byteLength<f)throw new RangeError('"offset" is outside of buffer bounds');if(p.byteLength<f+(l||0))throw new RangeError('"length" is outside of buffer bounds');let v;return f===void 0&&l===void 0?v=new Uint8Array(p):l===void 0?v=new Uint8Array(p,f):v=new Uint8Array(p,f,l),Object.setPrototypeOf(v,o.prototype),v}function Y(p){if(o.isBuffer(p)){const f=C(p.length)|0,l=a(f);return l.length===0||p.copy(l,0,0,f),l}if(p.length!==void 0)return typeof p.length!="number"||ee(p.length)?a(0):E(p);if(p.type==="Buffer"&&Array.isArray(p.data))return E(p.data)}function C(p){if(p>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return p|0}function G(p){return+p!=p&&(p=0),o.alloc(+p)}o.isBuffer=function(f){return f!=null&&f._isBuffer===!0&&f!==o.prototype},o.compare=function(f,l){if(V(f,Uint8Array)&&(f=o.from(f,f.offset,f.byteLength)),V(l,Uint8Array)&&(l=o.from(l,l.offset,l.byteLength)),!o.isBuffer(f)||!o.isBuffer(l))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(f===l)return 0;let v=f.length,R=l.length;for(let H=0,K=Math.min(v,R);H<K;++H)if(f[H]!==l[H]){v=f[H],R=l[H];break}return v<R?-1:R<v?1:0},o.isEncoding=function(f){switch(String(f).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(f,l){if(!Array.isArray(f))throw new TypeError('"list" argument must be an Array of Buffers');if(f.length===0)return o.alloc(0);let v;if(l===void 0)for(l=0,v=0;v<f.length;++v)l+=f[v].length;const R=o.allocUnsafe(l);let H=0;for(v=0;v<f.length;++v){let K=f[v];if(V(K,Uint8Array))H+K.length>R.length?(o.isBuffer(K)||(K=o.from(K)),K.copy(R,H)):Uint8Array.prototype.set.call(R,K,H);else if(o.isBuffer(K))K.copy(R,H);else throw new TypeError('"list" argument must be an Array of Buffers');H+=K.length}return R};function F(p,f){if(o.isBuffer(p))return p.length;if(ArrayBuffer.isView(p)||V(p,ArrayBuffer))return p.byteLength;if(typeof p!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof p);const l=p.length,v=arguments.length>2&&arguments[2]===!0;if(!v&&l===0)return 0;let R=!1;for(;;)switch(f){case"ascii":case"latin1":case"binary":return l;case"utf8":case"utf-8":return c(p).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return l*2;case"hex":return l>>>1;case"base64":return g(p).length;default:if(R)return v?-1:c(p).length;f=(""+f).toLowerCase(),R=!0}}o.byteLength=F;function z(p,f,l){let v=!1;if((f===void 0||f<0)&&(f=0),f>this.length||((l===void 0||l>this.length)&&(l=this.length),l<=0)||(l>>>=0,f>>>=0,l<=f))return"";for(p||(p="utf8");;)switch(p){case"hex":return se(this,f,l);case"utf8":case"utf-8":return Z(this,f,l);case"ascii":return le(this,f,l);case"latin1":case"binary":return J(this,f,l);case"base64":return q(this,f,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oe(this,f,l);default:if(v)throw new TypeError("Unknown encoding: "+p);p=(p+"").toLowerCase(),v=!0}}o.prototype._isBuffer=!0;function L(p,f,l){const v=p[f];p[f]=p[l],p[l]=v}o.prototype.swap16=function(){const f=this.length;if(f%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let l=0;l<f;l+=2)L(this,l,l+1);return this},o.prototype.swap32=function(){const f=this.length;if(f%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let l=0;l<f;l+=4)L(this,l,l+3),L(this,l+1,l+2);return this},o.prototype.swap64=function(){const f=this.length;if(f%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let l=0;l<f;l+=8)L(this,l,l+7),L(this,l+1,l+6),L(this,l+2,l+5),L(this,l+3,l+4);return this},o.prototype.toString=function(){const f=this.length;return f===0?"":arguments.length===0?Z(this,0,f):z.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(f){if(!o.isBuffer(f))throw new TypeError("Argument must be a Buffer");return this===f?!0:o.compare(this,f)===0},o.prototype.inspect=function(){let f="";const l=t.INSPECT_MAX_BYTES;return f=this.toString("hex",0,l).replace(/(.{2})/g,"$1 ").trim(),this.length>l&&(f+=" ... "),"<Buffer "+f+">"},n&&(o.prototype[n]=o.prototype.inspect),o.prototype.compare=function(f,l,v,R,H){if(V(f,Uint8Array)&&(f=o.from(f,f.offset,f.byteLength)),!o.isBuffer(f))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof f);if(l===void 0&&(l=0),v===void 0&&(v=f?f.length:0),R===void 0&&(R=0),H===void 0&&(H=this.length),l<0||v>f.length||R<0||H>this.length)throw new RangeError("out of range index");if(R>=H&&l>=v)return 0;if(R>=H)return-1;if(l>=v)return 1;if(l>>>=0,v>>>=0,R>>>=0,H>>>=0,this===f)return 0;let K=H-R,ye=v-l;const _e=Math.min(K,ye),we=this.slice(R,H),pe=f.slice(l,v);for(let Se=0;Se<_e;++Se)if(we[Se]!==pe[Se]){K=we[Se],ye=pe[Se];break}return K<ye?-1:ye<K?1:0};function j(p,f,l,v,R){if(p.length===0)return-1;if(typeof l=="string"?(v=l,l=0):l>2147483647?l=2147483647:l<-2147483648&&(l=-2147483648),l=+l,ee(l)&&(l=R?0:p.length-1),l<0&&(l=p.length+l),l>=p.length){if(R)return-1;l=p.length-1}else if(l<0)if(R)l=0;else return-1;if(typeof f=="string"&&(f=o.from(f,v)),o.isBuffer(f))return f.length===0?-1:W(p,f,l,v,R);if(typeof f=="number")return f=f&255,typeof Uint8Array.prototype.indexOf=="function"?R?Uint8Array.prototype.indexOf.call(p,f,l):Uint8Array.prototype.lastIndexOf.call(p,f,l):W(p,[f],l,v,R);throw new TypeError("val must be string, number or Buffer")}function W(p,f,l,v,R){let H=1,K=p.length,ye=f.length;if(v!==void 0&&(v=String(v).toLowerCase(),v==="ucs2"||v==="ucs-2"||v==="utf16le"||v==="utf-16le")){if(p.length<2||f.length<2)return-1;H=2,K/=2,ye/=2,l/=2}function _e(pe,Se){return H===1?pe[Se]:pe.readUInt16BE(Se*H)}let we;if(R){let pe=-1;for(we=l;we<K;we++)if(_e(p,we)===_e(f,pe===-1?0:we-pe)){if(pe===-1&&(pe=we),we-pe+1===ye)return pe*H}else pe!==-1&&(we-=we-pe),pe=-1}else for(l+ye>K&&(l=K-ye),we=l;we>=0;we--){let pe=!0;for(let Se=0;Se<ye;Se++)if(_e(p,we+Se)!==_e(f,Se)){pe=!1;break}if(pe)return we}return-1}o.prototype.includes=function(f,l,v){return this.indexOf(f,l,v)!==-1},o.prototype.indexOf=function(f,l,v){return j(this,f,l,v,!0)},o.prototype.lastIndexOf=function(f,l,v){return j(this,f,l,v,!1)};function D(p,f,l,v){l=Number(l)||0;const R=p.length-l;v?(v=Number(v),v>R&&(v=R)):v=R;const H=f.length;v>H/2&&(v=H/2);let K;for(K=0;K<v;++K){const ye=parseInt(f.substr(K*2,2),16);if(ee(ye))return K;p[l+K]=ye}return K}function $(p,f,l,v){return S(c(f,p.length-l),p,l,v)}function k(p,f,l,v){return S(u(f),p,l,v)}function te(p,f,l,v){return S(g(f),p,l,v)}function X(p,f,l,v){return S(y(f,p.length-l),p,l,v)}o.prototype.write=function(f,l,v,R){if(l===void 0)R="utf8",v=this.length,l=0;else if(v===void 0&&typeof l=="string")R=l,v=this.length,l=0;else if(isFinite(l))l=l>>>0,isFinite(v)?(v=v>>>0,R===void 0&&(R="utf8")):(R=v,v=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const H=this.length-l;if((v===void 0||v>H)&&(v=H),f.length>0&&(v<0||l<0)||l>this.length)throw new RangeError("Attempt to write outside buffer bounds");R||(R="utf8");let K=!1;for(;;)switch(R){case"hex":return D(this,f,l,v);case"utf8":case"utf-8":return $(this,f,l,v);case"ascii":case"latin1":case"binary":return k(this,f,l,v);case"base64":return te(this,f,l,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X(this,f,l,v);default:if(K)throw new TypeError("Unknown encoding: "+R);R=(""+R).toLowerCase(),K=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function q(p,f,l){return f===0&&l===p.length?e.fromByteArray(p):e.fromByteArray(p.slice(f,l))}function Z(p,f,l){l=Math.min(p.length,l);const v=[];let R=f;for(;R<l;){const H=p[R];let K=null,ye=H>239?4:H>223?3:H>191?2:1;if(R+ye<=l){let _e,we,pe,Se;switch(ye){case 1:H<128&&(K=H);break;case 2:_e=p[R+1],(_e&192)===128&&(Se=(H&31)<<6|_e&63,Se>127&&(K=Se));break;case 3:_e=p[R+1],we=p[R+2],(_e&192)===128&&(we&192)===128&&(Se=(H&15)<<12|(_e&63)<<6|we&63,Se>2047&&(Se<55296||Se>57343)&&(K=Se));break;case 4:_e=p[R+1],we=p[R+2],pe=p[R+3],(_e&192)===128&&(we&192)===128&&(pe&192)===128&&(Se=(H&15)<<18|(_e&63)<<12|(we&63)<<6|pe&63,Se>65535&&Se<1114112&&(K=Se))}}K===null?(K=65533,ye=1):K>65535&&(K-=65536,v.push(K>>>10&1023|55296),K=56320|K&1023),v.push(K),R+=ye}return ue(v)}const Q=4096;function ue(p){const f=p.length;if(f<=Q)return String.fromCharCode.apply(String,p);let l="",v=0;for(;v<f;)l+=String.fromCharCode.apply(String,p.slice(v,v+=Q));return l}function le(p,f,l){let v="";l=Math.min(p.length,l);for(let R=f;R<l;++R)v+=String.fromCharCode(p[R]&127);return v}function J(p,f,l){let v="";l=Math.min(p.length,l);for(let R=f;R<l;++R)v+=String.fromCharCode(p[R]);return v}function se(p,f,l){const v=p.length;(!f||f<0)&&(f=0),(!l||l<0||l>v)&&(l=v);let R="";for(let H=f;H<l;++H)R+=fe[p[H]];return R}function oe(p,f,l){const v=p.slice(f,l);let R="";for(let H=0;H<v.length-1;H+=2)R+=String.fromCharCode(v[H]+v[H+1]*256);return R}o.prototype.slice=function(f,l){const v=this.length;f=~~f,l=l===void 0?v:~~l,f<0?(f+=v,f<0&&(f=0)):f>v&&(f=v),l<0?(l+=v,l<0&&(l=0)):l>v&&(l=v),l<f&&(l=f);const R=this.subarray(f,l);return Object.setPrototypeOf(R,o.prototype),R};function re(p,f,l){if(p%1!==0||p<0)throw new RangeError("offset is not uint");if(p+f>l)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(f,l,v){f=f>>>0,l=l>>>0,v||re(f,l,this.length);let R=this[f],H=1,K=0;for(;++K<l&&(H*=256);)R+=this[f+K]*H;return R},o.prototype.readUintBE=o.prototype.readUIntBE=function(f,l,v){f=f>>>0,l=l>>>0,v||re(f,l,this.length);let R=this[f+--l],H=1;for(;l>0&&(H*=256);)R+=this[f+--l]*H;return R},o.prototype.readUint8=o.prototype.readUInt8=function(f,l){return f=f>>>0,l||re(f,1,this.length),this[f]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(f,l){return f=f>>>0,l||re(f,2,this.length),this[f]|this[f+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(f,l){return f=f>>>0,l||re(f,2,this.length),this[f]<<8|this[f+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(f,l){return f=f>>>0,l||re(f,4,this.length),(this[f]|this[f+1]<<8|this[f+2]<<16)+this[f+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(f,l){return f=f>>>0,l||re(f,4,this.length),this[f]*16777216+(this[f+1]<<16|this[f+2]<<8|this[f+3])},o.prototype.readBigUInt64LE=he(function(f){f=f>>>0,P(f,"offset");const l=this[f],v=this[f+7];(l===void 0||v===void 0)&&U(f,this.length-8);const R=l+this[++f]*2**8+this[++f]*2**16+this[++f]*2**24,H=this[++f]+this[++f]*2**8+this[++f]*2**16+v*2**24;return BigInt(R)+(BigInt(H)<<BigInt(32))}),o.prototype.readBigUInt64BE=he(function(f){f=f>>>0,P(f,"offset");const l=this[f],v=this[f+7];(l===void 0||v===void 0)&&U(f,this.length-8);const R=l*2**24+this[++f]*2**16+this[++f]*2**8+this[++f],H=this[++f]*2**24+this[++f]*2**16+this[++f]*2**8+v;return(BigInt(R)<<BigInt(32))+BigInt(H)}),o.prototype.readIntLE=function(f,l,v){f=f>>>0,l=l>>>0,v||re(f,l,this.length);let R=this[f],H=1,K=0;for(;++K<l&&(H*=256);)R+=this[f+K]*H;return H*=128,R>=H&&(R-=Math.pow(2,8*l)),R},o.prototype.readIntBE=function(f,l,v){f=f>>>0,l=l>>>0,v||re(f,l,this.length);let R=l,H=1,K=this[f+--R];for(;R>0&&(H*=256);)K+=this[f+--R]*H;return H*=128,K>=H&&(K-=Math.pow(2,8*l)),K},o.prototype.readInt8=function(f,l){return f=f>>>0,l||re(f,1,this.length),this[f]&128?(255-this[f]+1)*-1:this[f]},o.prototype.readInt16LE=function(f,l){f=f>>>0,l||re(f,2,this.length);const v=this[f]|this[f+1]<<8;return v&32768?v|4294901760:v},o.prototype.readInt16BE=function(f,l){f=f>>>0,l||re(f,2,this.length);const v=this[f+1]|this[f]<<8;return v&32768?v|4294901760:v},o.prototype.readInt32LE=function(f,l){return f=f>>>0,l||re(f,4,this.length),this[f]|this[f+1]<<8|this[f+2]<<16|this[f+3]<<24},o.prototype.readInt32BE=function(f,l){return f=f>>>0,l||re(f,4,this.length),this[f]<<24|this[f+1]<<16|this[f+2]<<8|this[f+3]},o.prototype.readBigInt64LE=he(function(f){f=f>>>0,P(f,"offset");const l=this[f],v=this[f+7];(l===void 0||v===void 0)&&U(f,this.length-8);const R=this[f+4]+this[f+5]*2**8+this[f+6]*2**16+(v<<24);return(BigInt(R)<<BigInt(32))+BigInt(l+this[++f]*2**8+this[++f]*2**16+this[++f]*2**24)}),o.prototype.readBigInt64BE=he(function(f){f=f>>>0,P(f,"offset");const l=this[f],v=this[f+7];(l===void 0||v===void 0)&&U(f,this.length-8);const R=(l<<24)+this[++f]*2**16+this[++f]*2**8+this[++f];return(BigInt(R)<<BigInt(32))+BigInt(this[++f]*2**24+this[++f]*2**16+this[++f]*2**8+v)}),o.prototype.readFloatLE=function(f,l){return f=f>>>0,l||re(f,4,this.length),r.read(this,f,!0,23,4)},o.prototype.readFloatBE=function(f,l){return f=f>>>0,l||re(f,4,this.length),r.read(this,f,!1,23,4)},o.prototype.readDoubleLE=function(f,l){return f=f>>>0,l||re(f,8,this.length),r.read(this,f,!0,52,8)},o.prototype.readDoubleBE=function(f,l){return f=f>>>0,l||re(f,8,this.length),r.read(this,f,!1,52,8)};function ne(p,f,l,v,R,H){if(!o.isBuffer(p))throw new TypeError('"buffer" argument must be a Buffer instance');if(f>R||f<H)throw new RangeError('"value" argument is out of bounds');if(l+v>p.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(f,l,v,R){if(f=+f,l=l>>>0,v=v>>>0,!R){const ye=Math.pow(2,8*v)-1;ne(this,f,l,v,ye,0)}let H=1,K=0;for(this[l]=f&255;++K<v&&(H*=256);)this[l+K]=f/H&255;return l+v},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(f,l,v,R){if(f=+f,l=l>>>0,v=v>>>0,!R){const ye=Math.pow(2,8*v)-1;ne(this,f,l,v,ye,0)}let H=v-1,K=1;for(this[l+H]=f&255;--H>=0&&(K*=256);)this[l+H]=f/K&255;return l+v},o.prototype.writeUint8=o.prototype.writeUInt8=function(f,l,v){return f=+f,l=l>>>0,v||ne(this,f,l,1,255,0),this[l]=f&255,l+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(f,l,v){return f=+f,l=l>>>0,v||ne(this,f,l,2,65535,0),this[l]=f&255,this[l+1]=f>>>8,l+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(f,l,v){return f=+f,l=l>>>0,v||ne(this,f,l,2,65535,0),this[l]=f>>>8,this[l+1]=f&255,l+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(f,l,v){return f=+f,l=l>>>0,v||ne(this,f,l,4,4294967295,0),this[l+3]=f>>>24,this[l+2]=f>>>16,this[l+1]=f>>>8,this[l]=f&255,l+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(f,l,v){return f=+f,l=l>>>0,v||ne(this,f,l,4,4294967295,0),this[l]=f>>>24,this[l+1]=f>>>16,this[l+2]=f>>>8,this[l+3]=f&255,l+4};function Te(p,f,l,v,R){N(f,v,R,p,l,7);let H=Number(f&BigInt(4294967295));p[l++]=H,H=H>>8,p[l++]=H,H=H>>8,p[l++]=H,H=H>>8,p[l++]=H;let K=Number(f>>BigInt(32)&BigInt(4294967295));return p[l++]=K,K=K>>8,p[l++]=K,K=K>>8,p[l++]=K,K=K>>8,p[l++]=K,l}function x(p,f,l,v,R){N(f,v,R,p,l,7);let H=Number(f&BigInt(4294967295));p[l+7]=H,H=H>>8,p[l+6]=H,H=H>>8,p[l+5]=H,H=H>>8,p[l+4]=H;let K=Number(f>>BigInt(32)&BigInt(4294967295));return p[l+3]=K,K=K>>8,p[l+2]=K,K=K>>8,p[l+1]=K,K=K>>8,p[l]=K,l+8}o.prototype.writeBigUInt64LE=he(function(f,l=0){return Te(this,f,l,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=he(function(f,l=0){return x(this,f,l,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(f,l,v,R){if(f=+f,l=l>>>0,!R){const _e=Math.pow(2,8*v-1);ne(this,f,l,v,_e-1,-_e)}let H=0,K=1,ye=0;for(this[l]=f&255;++H<v&&(K*=256);)f<0&&ye===0&&this[l+H-1]!==0&&(ye=1),this[l+H]=(f/K>>0)-ye&255;return l+v},o.prototype.writeIntBE=function(f,l,v,R){if(f=+f,l=l>>>0,!R){const _e=Math.pow(2,8*v-1);ne(this,f,l,v,_e-1,-_e)}let H=v-1,K=1,ye=0;for(this[l+H]=f&255;--H>=0&&(K*=256);)f<0&&ye===0&&this[l+H+1]!==0&&(ye=1),this[l+H]=(f/K>>0)-ye&255;return l+v},o.prototype.writeInt8=function(f,l,v){return f=+f,l=l>>>0,v||ne(this,f,l,1,127,-128),f<0&&(f=255+f+1),this[l]=f&255,l+1},o.prototype.writeInt16LE=function(f,l,v){return f=+f,l=l>>>0,v||ne(this,f,l,2,32767,-32768),this[l]=f&255,this[l+1]=f>>>8,l+2},o.prototype.writeInt16BE=function(f,l,v){return f=+f,l=l>>>0,v||ne(this,f,l,2,32767,-32768),this[l]=f>>>8,this[l+1]=f&255,l+2},o.prototype.writeInt32LE=function(f,l,v){return f=+f,l=l>>>0,v||ne(this,f,l,4,2147483647,-2147483648),this[l]=f&255,this[l+1]=f>>>8,this[l+2]=f>>>16,this[l+3]=f>>>24,l+4},o.prototype.writeInt32BE=function(f,l,v){return f=+f,l=l>>>0,v||ne(this,f,l,4,2147483647,-2147483648),f<0&&(f=4294967295+f+1),this[l]=f>>>24,this[l+1]=f>>>16,this[l+2]=f>>>8,this[l+3]=f&255,l+4},o.prototype.writeBigInt64LE=he(function(f,l=0){return Te(this,f,l,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=he(function(f,l=0){return x(this,f,l,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function me(p,f,l,v,R,H){if(l+v>p.length)throw new RangeError("Index out of range");if(l<0)throw new RangeError("Index out of range")}function Fe(p,f,l,v,R){return f=+f,l=l>>>0,R||me(p,f,l,4),r.write(p,f,l,v,23,4),l+4}o.prototype.writeFloatLE=function(f,l,v){return Fe(this,f,l,!0,v)},o.prototype.writeFloatBE=function(f,l,v){return Fe(this,f,l,!1,v)};function Pe(p,f,l,v,R){return f=+f,l=l>>>0,R||me(p,f,l,8),r.write(p,f,l,v,52,8),l+8}o.prototype.writeDoubleLE=function(f,l,v){return Pe(this,f,l,!0,v)},o.prototype.writeDoubleBE=function(f,l,v){return Pe(this,f,l,!1,v)},o.prototype.copy=function(f,l,v,R){if(!o.isBuffer(f))throw new TypeError("argument should be a Buffer");if(v||(v=0),!R&&R!==0&&(R=this.length),l>=f.length&&(l=f.length),l||(l=0),R>0&&R<v&&(R=v),R===v||f.length===0||this.length===0)return 0;if(l<0)throw new RangeError("targetStart out of bounds");if(v<0||v>=this.length)throw new RangeError("Index out of range");if(R<0)throw new RangeError("sourceEnd out of bounds");R>this.length&&(R=this.length),f.length-l<R-v&&(R=f.length-l+v);const H=R-v;return this===f&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(l,v,R):Uint8Array.prototype.set.call(f,this.subarray(v,R),l),H},o.prototype.fill=function(f,l,v,R){if(typeof f=="string"){if(typeof l=="string"?(R=l,l=0,v=this.length):typeof v=="string"&&(R=v,v=this.length),R!==void 0&&typeof R!="string")throw new TypeError("encoding must be a string");if(typeof R=="string"&&!o.isEncoding(R))throw new TypeError("Unknown encoding: "+R);if(f.length===1){const K=f.charCodeAt(0);(R==="utf8"&&K<128||R==="latin1")&&(f=K)}}else typeof f=="number"?f=f&255:typeof f=="boolean"&&(f=Number(f));if(l<0||this.length<l||this.length<v)throw new RangeError("Out of range index");if(v<=l)return this;l=l>>>0,v=v===void 0?this.length:v>>>0,f||(f=0);let H;if(typeof f=="number")for(H=l;H<v;++H)this[H]=f;else{const K=o.isBuffer(f)?f:o.from(f,R),ye=K.length;if(ye===0)throw new TypeError('The value "'+f+'" is invalid for argument "value"');for(H=0;H<v-l;++H)this[H+l]=K[H%ye]}return this};const ae={};function ce(p,f,l){ae[p]=class extends l{constructor(){super(),Object.defineProperty(this,"message",{value:f.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${p}]`,this.stack,delete this.name}get code(){return p}set code(R){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:R,writable:!0})}toString(){return`${this.name} [${p}]: ${this.message}`}}}ce("ERR_BUFFER_OUT_OF_BOUNDS",function(p){return p?`${p} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ce("ERR_INVALID_ARG_TYPE",function(p,f){return`The "${p}" argument must be of type number. Received type ${typeof f}`},TypeError),ce("ERR_OUT_OF_RANGE",function(p,f,l){let v=`The value of "${p}" is out of range.`,R=l;return Number.isInteger(l)&&Math.abs(l)>2**32?R=b(String(l)):typeof l=="bigint"&&(R=String(l),(l>BigInt(2)**BigInt(32)||l<-(BigInt(2)**BigInt(32)))&&(R=b(R)),R+="n"),v+=` It must be ${f}. Received ${R}`,v},RangeError);function b(p){let f="",l=p.length;const v=p[0]==="-"?1:0;for(;l>=v+4;l-=3)f=`_${p.slice(l-3,l)}${f}`;return`${p.slice(0,l)}${f}`}function B(p,f,l){P(f,"offset"),(p[f]===void 0||p[f+l]===void 0)&&U(f,p.length-(l+1))}function N(p,f,l,v,R,H){if(p>l||p<f){const K=typeof f=="bigint"?"n":"";let ye;throw f===0||f===BigInt(0)?ye=`>= 0${K} and < 2${K} ** ${(H+1)*8}${K}`:ye=`>= -(2${K} ** ${(H+1)*8-1}${K}) and < 2 ** ${(H+1)*8-1}${K}`,new ae.ERR_OUT_OF_RANGE("value",ye,p)}B(v,R,H)}function P(p,f){if(typeof p!="number")throw new ae.ERR_INVALID_ARG_TYPE(f,"number",p)}function U(p,f,l){throw Math.floor(p)!==p?(P(p,l),new ae.ERR_OUT_OF_RANGE("offset","an integer",p)):f<0?new ae.ERR_BUFFER_OUT_OF_BOUNDS:new ae.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${f}`,p)}const M=/[^+/0-9A-Za-z-_]/g;function d(p){if(p=p.split("=")[0],p=p.trim().replace(M,""),p.length<2)return"";for(;p.length%4!==0;)p=p+"=";return p}function c(p,f){f=f||1/0;let l;const v=p.length;let R=null;const H=[];for(let K=0;K<v;++K){if(l=p.charCodeAt(K),l>55295&&l<57344){if(!R){if(l>56319){(f-=3)>-1&&H.push(239,191,189);continue}else if(K+1===v){(f-=3)>-1&&H.push(239,191,189);continue}R=l;continue}if(l<56320){(f-=3)>-1&&H.push(239,191,189),R=l;continue}l=(R-55296<<10|l-56320)+65536}else R&&(f-=3)>-1&&H.push(239,191,189);if(R=null,l<128){if((f-=1)<0)break;H.push(l)}else if(l<2048){if((f-=2)<0)break;H.push(l>>6|192,l&63|128)}else if(l<65536){if((f-=3)<0)break;H.push(l>>12|224,l>>6&63|128,l&63|128)}else if(l<1114112){if((f-=4)<0)break;H.push(l>>18|240,l>>12&63|128,l>>6&63|128,l&63|128)}else throw new Error("Invalid code point")}return H}function u(p){const f=[];for(let l=0;l<p.length;++l)f.push(p.charCodeAt(l)&255);return f}function y(p,f){let l,v,R;const H=[];for(let K=0;K<p.length&&!((f-=2)<0);++K)l=p.charCodeAt(K),v=l>>8,R=l%256,H.push(R),H.push(v);return H}function g(p){return e.toByteArray(d(p))}function S(p,f,l,v){let R;for(R=0;R<v&&!(R+l>=f.length||R>=p.length);++R)f[R+l]=p[R];return R}function V(p,f){return p instanceof f||p!=null&&p.constructor!=null&&p.constructor.name!=null&&p.constructor.name===f.name}function ee(p){return p!==p}const fe=function(){const p="0123456789abcdef",f=new Array(256);for(let l=0;l<16;++l){const v=l*16;for(let R=0;R<16;++R)f[v+R]=p[l]+p[R]}return f}();function he(p){return typeof BigInt>"u"?ge:p}function ge(){throw new Error("BigInt not supported")}})(aa);var xs;(function(t){t[t.SysFatal=1]="SysFatal",t[t.SysTransient=2]="SysTransient",t[t.DestinationInvalid=3]="DestinationInvalid",t[t.CanisterReject=4]="CanisterReject",t[t.CanisterError=5]="CanisterError"})(xs||(xs={}));const pi="abcdefghijklmnopqrstuvwxyz234567",Jr=Object.create(null);for(let t=0;t<pi.length;t++)Jr[pi[t]]=t;Jr[0]=Jr.o;Jr[1]=Jr.i;function Xu(t){let e=0,r=0,n="";function i(s){return e<0?r|=s>>-e:r=s<<e&248,e>3?(e-=8,1):(e<4&&(n+=pi[r>>3],e+=5),0)}for(let s=0;s<t.length;)s+=i(t[s]);return n+(e<0?pi[r>>3]:"")}function Ju(t){let e=0,r=0;const n=new Uint8Array(t.length*4/3|0);let i=0;function s(a){let o=Jr[a.toLowerCase()];if(o===void 0)throw new Error(`Invalid character: ${JSON.stringify(a)}`);o<<=3,r|=o>>>e,e+=5,e>=8&&(n[i++]=r,e-=8,e>0?r=o<<5-e&255:r=0)}for(const a of t)s(a);return n.slice(0,i)}const Qu=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function ef(t){const e=new Uint8Array(t);let r=-1;for(let n=0;n<e.length;n++){const s=(e[n]^r)&255;r=Qu[s]^r>>>8}return(r^-1)>>>0}const Or=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Sn(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function tf(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function pt(t,...e){if(!Sn(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function co(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function rf(t,e){pt(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function wn(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Di(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Bt(t,e){return t<<32-e|t>>>e}const ua=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",nf=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Qr(t){if(pt(t),ua)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=nf[t[r]];return e}const Pt={_0:48,_9:57,A:65,F:70,a:97,f:102};function uo(t){if(t>=Pt._0&&t<=Pt._9)return t-Pt._0;if(t>=Pt.A&&t<=Pt.F)return t-(Pt.A-10);if(t>=Pt.a&&t<=Pt.f)return t-(Pt.a-10)}function fa(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(ua)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const a=uo(t.charCodeAt(s)),o=uo(t.charCodeAt(s+1));if(a===void 0||o===void 0){const h=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+h+'" at index '+s)}n[i]=a*16+o}return n}function Nn(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function la(t){return typeof t=="string"&&(t=Nn(t)),pt(t),t}function qe(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];pt(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}class sf{}function Gs(t){const e=n=>t().update(la(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function ha(t=32){if(Or&&typeof Or.getRandomValues=="function")return Or.getRandomValues(new Uint8Array(t));if(Or&&typeof Or.randomBytes=="function")return Uint8Array.from(Or.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function of(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),a=Number(r>>i&s),o=Number(r&s),h=n?4:0,w=n?0:4;t.setUint32(e+h,a,n),t.setUint32(e+w,o,n)}function af(t,e,r){return t&e^~t&r}function cf(t,e,r){return t&e^t&r^e&r}class da extends sf{constructor(e,r,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(e),this.view=Di(this.buffer)}update(e){co(this),e=la(e),pt(e);const{view:r,buffer:n,blockLen:i}=this,s=e.length;for(let a=0;a<s;){const o=Math.min(i-this.pos,s-a);if(o===i){const h=Di(e);for(;i<=s-a;a+=i)this.process(h,a);continue}n.set(e.subarray(a,a+o),this.pos),this.pos+=o,a+=o,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){co(this),rf(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:s}=this;let{pos:a}=this;r[a++]=128,wn(this.buffer.subarray(a)),this.padOffset>i-a&&(this.process(n,0),a=0);for(let _=a;_<i;_++)r[_]=0;of(n,i-8,BigInt(this.length*8),s),this.process(n,0);const o=Di(e),h=this.outputLen;if(h%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const w=h/4,A=this.get();if(w>A.length)throw new Error("_sha2: outputLen bigger than state");for(let _=0;_<w;_++)o.setUint32(4*_,A[_],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:s,destroyed:a,pos:o}=this;return e.destroyed=a,e.finished=s,e.length=i,e.pos=o,i%r&&e.buffer.set(n),e}clone(){return this._cloneInto()}}const Jt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Qt=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),Xe=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Mn=BigInt(2**32-1),fo=BigInt(32);function uf(t,e=!1){return e?{h:Number(t&Mn),l:Number(t>>fo&Mn)}:{h:Number(t>>fo&Mn)|0,l:Number(t&Mn)|0}}function ff(t,e=!1){const r=t.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let s=0;s<r;s++){const{h:a,l:o}=uf(t[s],e);[n[s],i[s]]=[a,o]}return[n,i]}const lo=(t,e,r)=>t>>>r,ho=(t,e,r)=>t<<32-r|e>>>r,Fr=(t,e,r)=>t>>>r|e<<32-r,Pr=(t,e,r)=>t<<32-r|e>>>r,Cn=(t,e,r)=>t<<64-r|e>>>r-32,$n=(t,e,r)=>t>>>r-32|e<<64-r;function kt(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}const lf=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),hf=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,df=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),pf=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,yf=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),wf=(t,e,r,n,i,s)=>e+r+n+i+s+(t/2**32|0)|0,gf=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),er=new Uint32Array(64);class pa extends da{constructor(e=32){super(64,e,8,!1),this.A=Jt[0]|0,this.B=Jt[1]|0,this.C=Jt[2]|0,this.D=Jt[3]|0,this.E=Jt[4]|0,this.F=Jt[5]|0,this.G=Jt[6]|0,this.H=Jt[7]|0}get(){const{A:e,B:r,C:n,D:i,E:s,F:a,G:o,H:h}=this;return[e,r,n,i,s,a,o,h]}set(e,r,n,i,s,a,o,h){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=a|0,this.G=o|0,this.H=h|0}process(e,r){for(let _=0;_<16;_++,r+=4)er[_]=e.getUint32(r,!1);for(let _=16;_<64;_++){const m=er[_-15],E=er[_-2],T=Bt(m,7)^Bt(m,18)^m>>>3,O=Bt(E,17)^Bt(E,19)^E>>>10;er[_]=O+er[_-7]+T+er[_-16]|0}let{A:n,B:i,C:s,D:a,E:o,F:h,G:w,H:A}=this;for(let _=0;_<64;_++){const m=Bt(o,6)^Bt(o,11)^Bt(o,25),E=A+m+af(o,h,w)+gf[_]+er[_]|0,O=(Bt(n,2)^Bt(n,13)^Bt(n,22))+cf(n,i,s)|0;A=w,w=h,h=o,o=a+E|0,a=s,s=i,i=n,n=E+O|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,h=h+this.F|0,w=w+this.G|0,A=A+this.H|0,this.set(n,i,s,a,o,h,w,A)}roundClean(){wn(er)}destroy(){this.set(0,0,0,0,0,0,0,0),wn(this.buffer)}}class mf extends pa{constructor(){super(28),this.A=Qt[0]|0,this.B=Qt[1]|0,this.C=Qt[2]|0,this.D=Qt[3]|0,this.E=Qt[4]|0,this.F=Qt[5]|0,this.G=Qt[6]|0,this.H=Qt[7]|0}}const ya=ff(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),bf=ya[0],_f=ya[1],tr=new Uint32Array(80),rr=new Uint32Array(80);class xf extends da{constructor(e=64){super(128,e,16,!1),this.Ah=Xe[0]|0,this.Al=Xe[1]|0,this.Bh=Xe[2]|0,this.Bl=Xe[3]|0,this.Ch=Xe[4]|0,this.Cl=Xe[5]|0,this.Dh=Xe[6]|0,this.Dl=Xe[7]|0,this.Eh=Xe[8]|0,this.El=Xe[9]|0,this.Fh=Xe[10]|0,this.Fl=Xe[11]|0,this.Gh=Xe[12]|0,this.Gl=Xe[13]|0,this.Hh=Xe[14]|0,this.Hl=Xe[15]|0}get(){const{Ah:e,Al:r,Bh:n,Bl:i,Ch:s,Cl:a,Dh:o,Dl:h,Eh:w,El:A,Fh:_,Fl:m,Gh:E,Gl:T,Hh:O,Hl:Y}=this;return[e,r,n,i,s,a,o,h,w,A,_,m,E,T,O,Y]}set(e,r,n,i,s,a,o,h,w,A,_,m,E,T,O,Y){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=a|0,this.Dh=o|0,this.Dl=h|0,this.Eh=w|0,this.El=A|0,this.Fh=_|0,this.Fl=m|0,this.Gh=E|0,this.Gl=T|0,this.Hh=O|0,this.Hl=Y|0}process(e,r){for(let F=0;F<16;F++,r+=4)tr[F]=e.getUint32(r),rr[F]=e.getUint32(r+=4);for(let F=16;F<80;F++){const z=tr[F-15]|0,L=rr[F-15]|0,j=Fr(z,L,1)^Fr(z,L,8)^lo(z,L,7),W=Pr(z,L,1)^Pr(z,L,8)^ho(z,L,7),D=tr[F-2]|0,$=rr[F-2]|0,k=Fr(D,$,19)^Cn(D,$,61)^lo(D,$,6),te=Pr(D,$,19)^$n(D,$,61)^ho(D,$,6),X=df(W,te,rr[F-7],rr[F-16]),q=pf(X,j,k,tr[F-7],tr[F-16]);tr[F]=q|0,rr[F]=X|0}let{Ah:n,Al:i,Bh:s,Bl:a,Ch:o,Cl:h,Dh:w,Dl:A,Eh:_,El:m,Fh:E,Fl:T,Gh:O,Gl:Y,Hh:C,Hl:G}=this;for(let F=0;F<80;F++){const z=Fr(_,m,14)^Fr(_,m,18)^Cn(_,m,41),L=Pr(_,m,14)^Pr(_,m,18)^$n(_,m,41),j=_&E^~_&O,W=m&T^~m&Y,D=yf(G,L,W,_f[F],rr[F]),$=wf(D,C,z,j,bf[F],tr[F]),k=D|0,te=Fr(n,i,28)^Cn(n,i,34)^Cn(n,i,39),X=Pr(n,i,28)^$n(n,i,34)^$n(n,i,39),q=n&s^n&o^s&o,Z=i&a^i&h^a&h;C=O|0,G=Y|0,O=E|0,Y=T|0,E=_|0,T=m|0,{h:_,l:m}=kt(w|0,A|0,$|0,k|0),w=o|0,A=h|0,o=s|0,h=a|0,s=n|0,a=i|0;const Q=lf(k,X,Z);n=hf(Q,$,te,q),i=Q|0}({h:n,l:i}=kt(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:a}=kt(this.Bh|0,this.Bl|0,s|0,a|0),{h:o,l:h}=kt(this.Ch|0,this.Cl|0,o|0,h|0),{h:w,l:A}=kt(this.Dh|0,this.Dl|0,w|0,A|0),{h:_,l:m}=kt(this.Eh|0,this.El|0,_|0,m|0),{h:E,l:T}=kt(this.Fh|0,this.Fl|0,E|0,T|0),{h:O,l:Y}=kt(this.Gh|0,this.Gl|0,O|0,Y|0),{h:C,l:G}=kt(this.Hh|0,this.Hl|0,C|0,G|0),this.set(n,i,s,a,o,h,w,A,_,m,E,T,O,Y,C,G)}roundClean(){wn(tr,rr)}destroy(){wn(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const wa=Gs(()=>new pa),Ef=Gs(()=>new mf),vf=Gs(()=>new xf),Bf=wa,Af=Ef;function Tf(t){return Af.create().update(new Uint8Array(t)).digest()}const qn="__principal__",Sf=2,po=4,Nf="aaaaa-aa",If=t=>{var e;return new Uint8Array(((e=t.match(/.{1,2}/g))!==null&&e!==void 0?e:[]).map(r=>parseInt(r,16)))},Rf=t=>t.reduce((e,r)=>e+r.toString(16).padStart(2,"0"),"");let be=class Ln{constructor(e){this._arr=e,this._isPrincipal=!0}static anonymous(){return new this(new Uint8Array([po]))}static managementCanister(){return this.fromText(Nf)}static selfAuthenticating(e){const r=Tf(e);return new this(new Uint8Array([...r,Sf]))}static from(e){if(typeof e=="string")return Ln.fromText(e);if(Object.getPrototypeOf(e)===Uint8Array.prototype)return new Ln(e);if(typeof e=="object"&&e!==null&&e._isPrincipal===!0)return new Ln(e._arr);throw new Error(`Impossible to convert ${JSON.stringify(e)} to Principal.`)}static fromHex(e){return new this(If(e))}static fromText(e){let r=e;if(e.includes(qn)){const a=JSON.parse(e);qn in a&&(r=a[qn])}const n=r.toLowerCase().replace(/-/g,"");let i=Ju(n);i=i.slice(4,i.length);const s=new this(i);if(s.toText()!==r)throw new Error(`Principal "${s.toText()}" does not have a valid checksum (original value "${r}" may not be a valid Principal ID).`);return s}static fromUint8Array(e){return new this(e)}isAnonymous(){return this._arr.byteLength===1&&this._arr[0]===po}toUint8Array(){return this._arr}toHex(){return Rf(this._arr).toUpperCase()}toText(){const e=new ArrayBuffer(4);new DataView(e).setUint32(0,ef(this._arr));const n=new Uint8Array(e),i=Uint8Array.from(this._arr),s=new Uint8Array([...n,...i]),o=Xu(s).match(/.{1,5}/g);if(!o)throw new Error;return o.join("-")}toString(){return this.toText()}toJSON(){return{[qn]:this.toText()}}compareTo(e){for(let r=0;r<Math.min(this._arr.length,e._arr.length);r++){if(this._arr[r]<e._arr[r])return"lt";if(this._arr[r]>e._arr[r])return"gt"}return this._arr.length<e._arr.length?"lt":this._arr.length>e._arr.length?"gt":"eq"}ltEq(e){const r=this.compareTo(e);return r=="lt"||r=="eq"}gtEq(e){const r=this.compareTo(e);return r=="gt"||r=="eq"}};function Et(...t){const e=new Uint8Array(t.reduce((n,i)=>n+i.byteLength,0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e.buffer}function ke(t){return[...new Uint8Array(t)].map(e=>e.toString(16).padStart(2,"0")).join("")}const Uf=new RegExp(/^[0-9a-fA-F]+$/);function zt(t){if(!Uf.test(t))throw new Error("Invalid hexadecimal string.");const e=[...t].reduce((r,n,i)=>(r[i/2|0]=(r[i/2|0]||"")+n,r),[]).map(r=>Number.parseInt(r,16));return new Uint8Array(e).buffer}function ga(t,e){if(t.byteLength!==e.byteLength)return t.byteLength-e.byteLength;const r=new Uint8Array(t),n=new Uint8Array(e);for(let i=0;i<r.length;i++)if(r[i]!==n[i])return r[i]-n[i];return 0}function In(t,e){return ga(t,e)===0}function yn(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function jt(t){return t instanceof Uint8Array?yn(t):t instanceof ArrayBuffer?t:Array.isArray(t)?yn(new Uint8Array(t)):"buffer"in t?jt(t.buffer):yn(new Uint8Array(t))}class Me extends Error{constructor(e){super(e),this.message=e,this.name="AgentError",this.__proto__=Me.prototype,Object.setPrototypeOf(this,Me.prototype)}}function Ne(...t){const e=new Uint8Array(t.reduce((n,i)=>n+i.byteLength,0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e}class nn{constructor(e,r=(e==null?void 0:e.byteLength)||0){this._buffer=vr(e||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,r)}save(){return this._view}restore(e){this._view=e}get buffer(){return vr(this._view.slice())}get byteLength(){return this._view.byteLength}read(e){const r=this._view.subarray(0,e);return this._view=this._view.subarray(e),r.slice().buffer}readUint8(){const e=this._view[0];return this._view=this._view.subarray(1),e}write(e){const r=new Uint8Array(e),n=this._view.byteLength;this._view.byteOffset+this._view.byteLength+r.byteLength>=this._buffer.byteLength?this.alloc(r.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+r.byteLength),this._view.set(r,n)}get end(){return this._view.byteLength===0}alloc(e){const r=new ArrayBuffer((this._buffer.byteLength+e)*1.2|0),n=new Uint8Array(r,0,this._view.byteLength+e);n.set(this._view),this._buffer=r,this._view=n}}function Xi(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function vr(t){return t instanceof Uint8Array?Xi(t):t instanceof ArrayBuffer?t:Array.isArray(t)?Xi(new Uint8Array(t)):"buffer"in t?vr(t.buffer):Xi(new Uint8Array(t))}function Of(t){const r=new TextEncoder().encode(t);let n=0;for(const i of r)n=(n*223+i)%2**32;return n}function Ot(t){if(/^_\d+_$/.test(t)||/^_0x[0-9a-fA-F]+_$/.test(t)){const e=+t.slice(1,-1);if(Number.isSafeInteger(e)&&e>=0&&e<2**32)return e}return Of(t)}function ma(){throw new Error("unexpected end of buffer")}function Br(t,e){return t.byteLength<e&&ma(),t.read(e)}function Ar(t){const e=t.readUint8();return e===void 0&&ma(),e}function Ce(t){if(typeof t=="number"&&(t=BigInt(t)),t<BigInt(0))throw new Error("Cannot leb encode negative values.");const e=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,r=new nn(new ArrayBuffer(e),0);for(;;){const n=Number(t&BigInt(127));if(t/=BigInt(128),t===BigInt(0)){r.write(new Uint8Array([n]));break}else r.write(new Uint8Array([n|128]))}return r.buffer}function Le(t){let e=BigInt(1),r=BigInt(0),n;do n=Ar(t),r+=BigInt(n&127).valueOf()*e,e*=BigInt(128);while(n>=128);return r}function je(t){typeof t=="number"&&(t=BigInt(t));const e=t<BigInt(0);e&&(t=-t-BigInt(1));const r=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,n=new nn(new ArrayBuffer(r),0);for(;;){const s=i(t);if(t/=BigInt(128),e&&t===BigInt(0)&&s&64||!e&&t===BigInt(0)&&!(s&64)){n.write(new Uint8Array([s]));break}else n.write(new Uint8Array([s|128]))}function i(s){const a=s%BigInt(128);return Number(e?BigInt(128)-a-BigInt(1):a)}return n.buffer}function ir(t){const e=new Uint8Array(t.buffer);let r=0;for(;r<e.byteLength;r++)if(e[r]<128){if(!(e[r]&64))return Le(t);break}const n=new Uint8Array(Br(t,r+1));let i=BigInt(0);for(let s=n.byteLength-1;s>=0;s--)i=i*BigInt(128)+BigInt(128-(n[s]&127)-1);return-i-BigInt(1)}function Ff(t,e){if(BigInt(t)<BigInt(0))throw new Error("Cannot write negative values.");return ba(t,e)}function ba(t,e){t=BigInt(t);const r=new nn(new ArrayBuffer(Math.min(1,e)),0);let n=0,i=BigInt(256),s=BigInt(0),a=Number(t%i);for(r.write(new Uint8Array([a]));++n<e;)t<0&&s===BigInt(0)&&a!==0&&(s=BigInt(1)),a=Number((t/i-s)%BigInt(256)),r.write(new Uint8Array([a])),i*=BigInt(256);return r.buffer}function _a(t,e){let r=BigInt(Ar(t)),n=BigInt(1),i=0;for(;++i<e;){n*=BigInt(256);const s=BigInt(Ar(t));r=r+n*s}return r}function Pf(t,e){let r=_a(t,e);const n=BigInt(2)**(BigInt(8)*BigInt(e-1)+BigInt(7));return r>=n&&(r-=n*BigInt(2)),r}function Es(t){const e=BigInt(t);if(t<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<e}const zn="DIDL",yo=400;function gn(t,e,r){return t.map((n,i)=>r(n,e[i]))}class kf{constructor(){this._typs=[],this._idx=new Map}has(e){return this._idx.has(e.name)}add(e,r){const n=this._typs.length;this._idx.set(e.name,n),this._typs.push(r)}merge(e,r){const n=this._idx.get(e.name),i=this._idx.get(r);if(n===void 0)throw new Error("Missing type index for "+e);if(i===void 0)throw new Error("Missing type index for "+r);this._typs[n]=this._typs[i],this._typs.splice(i,1),this._idx.delete(r)}encode(){const e=Ce(this._typs.length),r=Ne(...this._typs);return Ne(e,r)}indexOf(e){if(!this._idx.has(e))throw new Error("Missing type index for "+e);return je(this._idx.get(e)||0)}}class Mf{visitType(e,r){throw new Error("Not implemented")}visitPrimitive(e,r){return this.visitType(e,r)}visitEmpty(e,r){return this.visitPrimitive(e,r)}visitBool(e,r){return this.visitPrimitive(e,r)}visitNull(e,r){return this.visitPrimitive(e,r)}visitReserved(e,r){return this.visitPrimitive(e,r)}visitText(e,r){return this.visitPrimitive(e,r)}visitNumber(e,r){return this.visitPrimitive(e,r)}visitInt(e,r){return this.visitNumber(e,r)}visitNat(e,r){return this.visitNumber(e,r)}visitFloat(e,r){return this.visitPrimitive(e,r)}visitFixedInt(e,r){return this.visitNumber(e,r)}visitFixedNat(e,r){return this.visitNumber(e,r)}visitPrincipal(e,r){return this.visitPrimitive(e,r)}visitConstruct(e,r){return this.visitType(e,r)}visitVec(e,r,n){return this.visitConstruct(e,n)}visitOpt(e,r,n){return this.visitConstruct(e,n)}visitRecord(e,r,n){return this.visitConstruct(e,n)}visitTuple(e,r,n){const i=r.map((s,a)=>[`_${a}_`,s]);return this.visitRecord(e,i,n)}visitVariant(e,r,n){return this.visitConstruct(e,n)}visitRec(e,r,n){return this.visitConstruct(r,n)}visitFunc(e,r){return this.visitConstruct(e,r)}visitService(e,r){return this.visitConstruct(e,r)}}class Ii{display(){return this.name}valueToString(e){return Ve(e)}buildTypeTable(e){e.has(this)||this._buildTypeTableImpl(e)}}class wt extends Ii{checkType(e){if(this.name!==e.name)throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`);return e}_buildTypeTableImpl(e){}}class lr extends Ii{checkType(e){if(e instanceof Dt){const r=e.getType();if(typeof r>"u")throw new Error("type mismatch with uninitialized type");return r}throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`)}encodeType(e){return e.indexOf(this.name)}}class xa extends wt{accept(e,r){return e.visitEmpty(this,r)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return je(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class Ea extends Ii{checkType(e){throw new Error("Method not implemented for unknown.")}accept(e,r){throw e.visitType(this,r)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(e,r){let n=r.decodeValue(e,r);Object(n)!==n&&(n=Object(n));let i;return r instanceof Dt?i=()=>r.getType():i=()=>r,Object.defineProperty(n,"type",{value:i,writable:!0,enumerable:!1,configurable:!0}),n}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class va extends wt{accept(e,r){return e.visitBool(this,r)}covariant(e){if(typeof e=="boolean")return!0;throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(e){return new Uint8Array([e?1:0])}encodeType(){return je(-2)}decodeValue(e,r){switch(this.checkType(r),Ar(e)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class yi extends wt{accept(e,r){return e.visitNull(this,r)}covariant(e){if(e===null)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return je(-1)}decodeValue(e,r){return this.checkType(r),null}get name(){return"null"}}class en extends wt{accept(e,r){return e.visitReserved(this,r)}covariant(e){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return je(-16)}decodeValue(e,r){return r.name!==this.name&&r.decodeValue(e,r),null}get name(){return"reserved"}}class Ba extends wt{accept(e,r){return e.visitText(this,r)}covariant(e){if(typeof e=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(e){const r=new TextEncoder().encode(e),n=Ce(r.byteLength);return Ne(n,r)}encodeType(){return je(-15)}decodeValue(e,r){this.checkType(r);const n=Le(e),i=Br(e,Number(n));return new TextDecoder("utf8",{fatal:!0}).decode(i)}get name(){return"text"}valueToString(e){return'"'+e+'"'}}class Aa extends wt{accept(e,r){return e.visitInt(this,r)}covariant(e){if(typeof e=="bigint"||Number.isInteger(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(e){return je(e)}encodeType(){return je(-4)}decodeValue(e,r){return this.checkType(r),ir(e)}get name(){return"int"}valueToString(e){return e.toString()}}class Ta extends wt{accept(e,r){return e.visitNat(this,r)}covariant(e){if(typeof e=="bigint"&&e>=BigInt(0)||Number.isInteger(e)&&e>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(e){return Ce(e)}encodeType(){return je(-3)}decodeValue(e,r){return this.checkType(r),Le(e)}get name(){return"nat"}valueToString(e){return e.toString()}}class Ks extends wt{constructor(e){if(super(),this._bits=e,e!==32&&e!==64)throw new Error("not a valid float type")}accept(e,r){return e.visitFloat(this,r)}covariant(e){if(typeof e=="number"||e instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(e){const r=new ArrayBuffer(this._bits/8),n=new DataView(r);return this._bits===32?n.setFloat32(0,e,!0):n.setFloat64(0,e,!0),r}encodeType(){const e=this._bits===32?-13:-14;return je(e)}decodeValue(e,r){this.checkType(r);const n=Br(e,this._bits/8),i=new DataView(n);return this._bits===32?i.getFloat32(0,!0):i.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(e){return e.toString()}}class Tr extends wt{constructor(e){super(),this._bits=e}accept(e,r){return e.visitFixedInt(this,r)}covariant(e){const r=Es(this._bits-1)*BigInt(-1),n=Es(this._bits-1)-BigInt(1);let i=!1;if(typeof e=="bigint")i=e>=r&&e<=n;else if(Number.isInteger(e)){const s=BigInt(e);i=s>=r&&s<=n}else i=!1;if(i)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(e){return ba(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return je(-9-e)}decodeValue(e,r){this.checkType(r);const n=Pf(e,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`int${this._bits}`}valueToString(e){return e.toString()}}class ur extends wt{constructor(e){super(),this._bits=e}accept(e,r){return e.visitFixedNat(this,r)}covariant(e){const r=Es(this._bits);let n=!1;if(typeof e=="bigint"&&e>=BigInt(0)?n=e<r:Number.isInteger(e)&&e>=0?n=BigInt(e)<r:n=!1,n)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(e){return Ff(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return je(-5-e)}decodeValue(e,r){this.checkType(r);const n=_a(e,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`nat${this._bits}`}valueToString(e){return e.toString()}}class Ri extends lr{constructor(e){super(),this._type=e,this._blobOptimization=!1,e instanceof ur&&e._bits===8&&(this._blobOptimization=!0)}accept(e,r){return e.visitVec(this,this._type,r)}covariant(e){const r=this._type instanceof ur?this._type._bits:this._type instanceof Tr?this._type._bits:0;if(ArrayBuffer.isView(e)&&r==e.BYTES_PER_ELEMENT*8||Array.isArray(e)&&e.every((n,i)=>{try{return this._type.covariant(n)}catch(s){throw new Error(`Invalid ${this.display()} argument: 

index ${i} -> ${s.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(e){const r=Ce(e.length);if(this._blobOptimization)return Ne(r,new Uint8Array(e));if(ArrayBuffer.isView(e))return Ne(r,new Uint8Array(e.buffer));const n=new nn(new ArrayBuffer(r.byteLength+e.length),0);n.write(r);for(const i of e){const s=this._type.encodeValue(i);n.write(new Uint8Array(s))}return n.buffer}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const r=je(-19),n=this._type.encodeType(e);e.add(this,Ne(r,n))}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof Ri))throw new Error("Not a vector type");const i=Number(Le(e));if(this._type instanceof ur){if(this._type._bits==8)return new Uint8Array(e.read(i));if(this._type._bits==16)return new Uint16Array(e.read(i*2));if(this._type._bits==32)return new Uint32Array(e.read(i*4));if(this._type._bits==64)return new BigUint64Array(e.read(i*8))}if(this._type instanceof Tr){if(this._type._bits==8)return new Int8Array(e.read(i));if(this._type._bits==16)return new Int16Array(e.read(i*2));if(this._type._bits==32)return new Int32Array(e.read(i*4));if(this._type._bits==64)return new BigInt64Array(e.read(i*8))}const s=[];for(let a=0;a<i;a++)s.push(this._type.decodeValue(e,n._type));return s}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(e){return"vec {"+e.map(n=>this._type.valueToString(n)).join("; ")+"}"}}class Sr extends lr{constructor(e){super(),this._type=e}accept(e,r){return e.visitOpt(this,this._type,r)}covariant(e){try{if(Array.isArray(e)&&(e.length===0||e.length===1&&this._type.covariant(e[0])))return!0}catch(r){throw new Error(`Invalid ${this.display()} argument: ${Ve(e)} 

-> ${r.message}`)}throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(e){return e.length===0?new Uint8Array([0]):Ne(new Uint8Array([1]),this._type.encodeValue(e[0]))}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const r=je(-18),n=this._type.encodeType(e);e.add(this,Ne(r,n))}decodeValue(e,r){if(r instanceof yi)return[];if(r instanceof en)return[];let n=r;if(r instanceof Dt){const i=r.getType();if(typeof i>"u")throw new Error("type mismatch with uninitialized type");n=i}if(n instanceof Sr)switch(Ar(e)){case 0:return[];case 1:{const i=e.save();try{return[this._type.decodeValue(e,n._type)]}catch{return e.restore(i),n._type.decodeValue(e,n._type),[]}}default:throw new Error("Not an option value")}else{if(this._type instanceof yi||this._type instanceof Sr||this._type instanceof en)return n.decodeValue(e,n),[];{const i=e.save();try{return[this._type.decodeValue(e,r)]}catch{return e.restore(i),n.decodeValue(e,r),[]}}}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(e){return e.length===0?"null":`opt ${this._type.valueToString(e[0])}`}}class Rn extends lr{constructor(e={}){super(),this._fields=Object.entries(e).sort((r,n)=>Ot(r[0])-Ot(n[0]))}accept(e,r){return e.visitRecord(this,this._fields,r)}tryAsTuple(){const e=[];for(let r=0;r<this._fields.length;r++){const[n,i]=this._fields[r];if(n!==`_${r}_`)return null;e.push(i)}return e}covariant(e){if(typeof e=="object"&&this._fields.every(([r,n])=>{if(!e.hasOwnProperty(r))throw new Error(`Record is missing key "${r}".`);try{return n.covariant(e[r])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

field ${r} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(e){const r=this._fields.map(([i])=>e[i]),n=gn(this._fields,r,([,i],s)=>i.encodeValue(s));return Ne(...n)}_buildTypeTableImpl(e){this._fields.forEach(([s,a])=>a.buildTypeTable(e));const r=je(-20),n=Ce(this._fields.length),i=this._fields.map(([s,a])=>Ne(Ce(Ot(s)),a.encodeType(e)));e.add(this,Ne(r,n,Ne(...i)))}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof Rn))throw new Error("Not a record type");const i={};let s=0,a=0;for(;a<n._fields.length;){const[o,h]=n._fields[a];if(s>=this._fields.length){h.decodeValue(e,h),a++;continue}const[w,A]=this._fields[s],_=Ot(this._fields[s][0]),m=Ot(o);if(_===m)i[w]=A.decodeValue(e,h),s++,a++;else if(m>_)if(A instanceof Sr||A instanceof en)i[w]=[],s++;else throw new Error("Cannot find required field "+w);else h.decodeValue(e,h),a++}for(const[o,h]of this._fields.slice(s))if(h instanceof Sr||h instanceof en)i[o]=[];else throw new Error("Cannot find required field "+o);return i}get name(){return`record {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}display(){return`record {${this._fields.map(([r,n])=>r+":"+n.display()).join("; ")}}`}valueToString(e){const r=this._fields.map(([i])=>e[i]);return`record {${gn(this._fields,r,([i,s],a)=>i+"="+s.valueToString(a)).join("; ")}}`}}class Ui extends Rn{constructor(e){const r={};e.forEach((n,i)=>r["_"+i+"_"]=n),super(r),this._components=e}accept(e,r){return e.visitTuple(this,this._components,r)}covariant(e){if(Array.isArray(e)&&e.length>=this._fields.length&&this._components.every((r,n)=>{try{return r.covariant(e[n])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

index ${n} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(e){const r=gn(this._components,e,(n,i)=>n.encodeValue(i));return Ne(...r)}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof Ui))throw new Error("not a tuple type");if(n._components.length<this._components.length)throw new Error("tuple mismatch");const i=[];for(const[s,a]of n._components.entries())s>=this._components.length?a.decodeValue(e,a):i.push(this._components[s].decodeValue(e,a));return i}display(){return`record {${this._components.map(r=>r.display()).join("; ")}}`}valueToString(e){return`record {${gn(this._components,e,(n,i)=>n.valueToString(i)).join("; ")}}`}}class Oi extends lr{constructor(e={}){super(),this._fields=Object.entries(e).sort((r,n)=>Ot(r[0])-Ot(n[0]))}accept(e,r){return e.visitVariant(this,this._fields,r)}covariant(e){if(typeof e=="object"&&Object.entries(e).length===1&&this._fields.every(([r,n])=>{try{return!e.hasOwnProperty(r)||n.covariant(e[r])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

variant ${r} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(e){for(let r=0;r<this._fields.length;r++){const[n,i]=this._fields[r];if(e.hasOwnProperty(n)){const s=Ce(r),a=i.encodeValue(e[n]);return Ne(s,a)}}throw Error("Variant has no data: "+e)}_buildTypeTableImpl(e){this._fields.forEach(([,s])=>{s.buildTypeTable(e)});const r=je(-21),n=Ce(this._fields.length),i=this._fields.map(([s,a])=>Ne(Ce(Ot(s)),a.encodeType(e)));e.add(this,Ne(r,n,...i))}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof Oi))throw new Error("Not a variant type");const i=Number(Le(e));if(i>=n._fields.length)throw Error("Invalid variant index: "+i);const[s,a]=n._fields[i];for(const[o,h]of this._fields)if(Ot(s)===Ot(o)){const w=h.decodeValue(e,a);return{[o]:w}}throw new Error("Cannot find field hash "+s)}get name(){return`variant {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}display(){return`variant {${this._fields.map(([r,n])=>r+(n.name==="null"?"":`:${n.display()}`)).join("; ")}}`}valueToString(e){for(const[r,n]of this._fields)if(e.hasOwnProperty(r)){const i=n.valueToString(e[r]);return i==="null"?`variant {${r}}`:`variant {${r}=${i}}`}throw new Error("Variant has no data: "+e)}}class Dt extends lr{constructor(){super(...arguments),this._id=Dt._counter++,this._type=void 0}accept(e,r){if(!this._type)throw Error("Recursive type uninitialized.");return e.visitRec(this,this._type,r)}fill(e){this._type=e}getType(){return this._type}covariant(e){if(this._type&&this._type.covariant(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(e)}_buildTypeTableImpl(e){if(!this._type)throw Error("Recursive type uninitialized.");e.add(this,new Uint8Array([])),this._type.buildTypeTable(e),e.merge(this,this._type.name)}decodeValue(e,r){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(e,r)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`${this.name}.${this._type.name}`}valueToString(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(e)}}Dt._counter=0;function js(t){if(Ar(t)!==1)throw new Error("Cannot decode principal");const r=Number(Le(t));return be.fromUint8Array(new Uint8Array(Br(t,r)))}class Sa extends wt{accept(e,r){return e.visitPrincipal(this,r)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(e){const r=e.toUint8Array(),n=Ce(r.byteLength);return Ne(new Uint8Array([1]),n,r)}encodeType(){return je(-24)}decodeValue(e,r){return this.checkType(r),js(e)}get name(){return"principal"}valueToString(e){return`${this.name} "${e.toText()}"`}}class Hs extends lr{constructor(e,r,n=[]){super(),this.argTypes=e,this.retTypes=r,this.annotations=n}static argsToString(e,r){if(e.length!==r.length)throw new Error("arity mismatch");return"("+e.map((n,i)=>n.valueToString(r[i])).join(", ")+")"}accept(e,r){return e.visitFunc(this,r)}covariant(e){if(Array.isArray(e)&&e.length===2&&e[0]&&e[0]._isPrincipal&&typeof e[1]=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue([e,r]){const n=e.toUint8Array(),i=Ce(n.byteLength),s=Ne(new Uint8Array([1]),i,n),a=new TextEncoder().encode(r),o=Ce(a.byteLength);return Ne(new Uint8Array([1]),s,o,a)}_buildTypeTableImpl(e){this.argTypes.forEach(w=>w.buildTypeTable(e)),this.retTypes.forEach(w=>w.buildTypeTable(e));const r=je(-22),n=Ce(this.argTypes.length),i=Ne(...this.argTypes.map(w=>w.encodeType(e))),s=Ce(this.retTypes.length),a=Ne(...this.retTypes.map(w=>w.encodeType(e))),o=Ce(this.annotations.length),h=Ne(...this.annotations.map(w=>this.encodeAnnotation(w)));e.add(this,Ne(r,n,i,s,a,o,h))}decodeValue(e){if(Ar(e)!==1)throw new Error("Cannot decode function reference");const n=js(e),i=Number(Le(e)),s=Br(e,i),o=new TextDecoder("utf8",{fatal:!0}).decode(s);return[n,o]}get name(){const e=this.argTypes.map(i=>i.name).join(", "),r=this.retTypes.map(i=>i.name).join(", "),n=" "+this.annotations.join(" ");return`(${e}) -> (${r})${n}`}valueToString([e,r]){return`func "${e.toText()}".${r}`}display(){const e=this.argTypes.map(i=>i.display()).join(", "),r=this.retTypes.map(i=>i.display()).join(", "),n=" "+this.annotations.join(" ");return`(${e})  (${r})${n}`}encodeAnnotation(e){if(e==="query")return new Uint8Array([1]);if(e==="oneway")return new Uint8Array([2]);if(e==="composite_query")return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class Na extends lr{constructor(e){super(),this._fields=Object.entries(e).sort((r,n)=>r[0]<n[0]?-1:r[0]>n[0]?1:0)}accept(e,r){return e.visitService(this,r)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ve(e)}`)}encodeValue(e){const r=e.toUint8Array(),n=Ce(r.length);return Ne(new Uint8Array([1]),n,r)}_buildTypeTableImpl(e){this._fields.forEach(([s,a])=>a.buildTypeTable(e));const r=je(-23),n=Ce(this._fields.length),i=this._fields.map(([s,a])=>{const o=new TextEncoder().encode(s),h=Ce(o.length);return Ne(h,o,a.encodeType(e))});e.add(this,Ne(r,n,...i))}decodeValue(e){return js(e)}get name(){return`service {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}valueToString(e){return`service "${e.toText()}"`}}function Ve(t){const e=JSON.stringify(t,(r,n)=>typeof n=="bigint"?`BigInt(${n})`:n);return e&&e.length>yo?e.substring(0,yo-3)+"...":e}function vs(t,e){if(e.length<t.length)throw Error("Wrong number of message arguments");const r=new kf;t.forEach(h=>h.buildTypeTable(r));const n=new TextEncoder().encode(zn),i=r.encode(),s=Ce(e.length),a=Ne(...t.map(h=>h.encodeType(r))),o=Ne(...gn(t,e,(h,w)=>{try{h.covariant(w)}catch(A){throw new Error(A.message+`

`)}return h.encodeValue(w)}));return Ne(n,i,s,a,o)}function Ia(t,e){const r=new nn(e);if(e.byteLength<zn.length)throw new Error("Message length smaller than magic number");const n=Br(r,zn.length),i=new TextDecoder().decode(n);if(i!==zn)throw new Error("Wrong magic number: "+JSON.stringify(i));function s(E){const T=[],O=Number(Le(E));for(let G=0;G<O;G++){const F=Number(ir(E));switch(F){case-18:case-19:{const z=Number(ir(E));T.push([F,z]);break}case-20:case-21:{const z=[];let L=Number(Le(E)),j;for(;L--;){const W=Number(Le(E));if(W>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if(typeof j=="number"&&j>=W)throw new Error("field id collision or not sorted");j=W;const D=Number(ir(E));z.push([W,D])}T.push([F,z]);break}case-22:{const z=[];let L=Number(Le(E));for(;L--;)z.push(Number(ir(E)));const j=[];let W=Number(Le(E));for(;W--;)j.push(Number(ir(E)));const D=[];let $=Number(Le(E));for(;$--;)switch(Number(Le(E))){case 1:{D.push("query");break}case 2:{D.push("oneway");break}case 3:{D.push("composite_query");break}default:throw new Error("unknown annotation")}T.push([F,[z,j,D]]);break}case-23:{let z=Number(Le(E));const L=[];for(;z--;){const j=Number(Le(E)),W=new TextDecoder().decode(Br(E,j)),D=ir(E);L.push([W,D])}T.push([F,L]);break}default:throw new Error("Illegal op_code: "+F)}}const Y=[],C=Number(Le(E));for(let G=0;G<C;G++)Y.push(Number(ir(E)));return[T,Y]}const[a,o]=s(r);if(o.length<t.length)throw new Error("Wrong number of return values");const h=a.map(E=>Qa());function w(E){if(E<-24)throw new Error("future value not supported");if(E<0)switch(E){case-1:return Fa;case-2:return Oa;case-3:return Ma;case-4:return ka;case-5:return ja;case-6:return Ha;case-7:return Ya;case-8:return Wa;case-9:return qa;case-10:return Va;case-11:return Ga;case-12:return Ka;case-13:return Ca;case-14:return $a;case-15:return Pa;case-16:return Ua;case-17:return Ra;case-24:return La;default:throw new Error("Illegal op_code: "+E)}if(E>=a.length)throw new Error("type index out of range");return h[E]}function A(E){switch(E[0]){case-19:{const T=w(E[1]);return Za(T)}case-18:{const T=w(E[1]);return Da(T)}case-20:{const T={};for(const[C,G]of E[1]){const F=`_${C}_`;T[F]=w(G)}const O=Xa(T),Y=O.tryAsTuple();return Array.isArray(Y)?za(...Y):O}case-21:{const T={};for(const[O,Y]of E[1]){const C=`_${O}_`;T[C]=w(Y)}return Ja(T)}case-22:{const[T,O,Y]=E[1];return ec(T.map(C=>w(C)),O.map(C=>w(C)),Y)}case-23:{const T={},O=E[1];for(const[Y,C]of O){let G=w(C);if(G instanceof Dt&&(G=G.getType()),!(G instanceof Hs))throw new Error("Illegal service definition: services can only contain functions");T[Y]=G}return tc(T)}default:throw new Error("Illegal op_code: "+E[0])}}a.forEach((E,T)=>{if(E[0]===-22){const O=A(E);h[T].fill(O)}}),a.forEach((E,T)=>{if(E[0]!==-22){const O=A(E);h[T].fill(O)}});const _=o.map(E=>w(E)),m=t.map((E,T)=>E.decodeValue(r,_[T]));for(let E=t.length;E<_.length;E++)_[E].decodeValue(r,_[E]);if(r.byteLength>0)throw new Error("decode: Left-over bytes");return m}const Ra=new xa,Ua=new en,Cf=new Ea,Oa=new va,Fa=new yi,Pa=new Ba,ka=new Aa,Ma=new Ta,Ca=new Ks(32),$a=new Ks(64),qa=new Tr(8),Va=new Tr(16),Ga=new Tr(32),Ka=new Tr(64),ja=new ur(8),Ha=new ur(16),Ya=new ur(32),Wa=new ur(64),La=new Sa;function za(...t){return new Ui(t)}function Za(t){return new Ri(t)}function Da(t){return new Sr(t)}function Xa(t){return new Rn(t)}function Ja(t){return new Oi(t)}function Qa(){return new Dt}function ec(t,e,r=[]){return new Hs(t,e,r)}function tc(t){return new Na(t)}const $f=Object.freeze(Object.defineProperty({__proto__:null,Bool:Oa,BoolClass:va,ConstructType:lr,Empty:Ra,EmptyClass:xa,FixedIntClass:Tr,FixedNatClass:ur,Float32:Ca,Float64:$a,FloatClass:Ks,Func:ec,FuncClass:Hs,Int:ka,Int16:Va,Int32:Ga,Int64:Ka,Int8:qa,IntClass:Aa,Nat:Ma,Nat16:Ha,Nat32:Ya,Nat64:Wa,Nat8:ja,NatClass:Ta,Null:Fa,NullClass:yi,Opt:Da,OptClass:Sr,PrimitiveType:wt,Principal:La,PrincipalClass:Sa,Rec:Qa,RecClass:Dt,Record:Xa,RecordClass:Rn,Reserved:Ua,ReservedClass:en,Service:tc,ServiceClass:Na,Text:Pa,TextClass:Ba,Tuple:za,TupleClass:Ui,Type:Ii,Unknown:Cf,UnknownClass:Ea,Variant:Ja,VariantClass:Oi,Vec:Za,VecClass:Ri,Visitor:Mf,decode:Ia,encode:vs},Symbol.toStringTag,{value:"Module"}));var rc={},Un={};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){var e=An,r=Tn,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=o,t.SlowBuffer=G,t.INSPECT_MAX_BYTES=50;var i=2147483647;t.kMaxLength=i,o.TYPED_ARRAY_SUPPORT=s(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{var d=new Uint8Array(1),c={foo:function(){return 42}};return Object.setPrototypeOf(c,Uint8Array.prototype),Object.setPrototypeOf(d,c),d.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function a(d){if(d>i)throw new RangeError('The value "'+d+'" is invalid for option "size"');var c=new Uint8Array(d);return Object.setPrototypeOf(c,o.prototype),c}function o(d,c,u){if(typeof d=="number"){if(typeof c=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return _(d)}return h(d,c,u)}o.poolSize=8192;function h(d,c,u){if(typeof d=="string")return m(d,c);if(ArrayBuffer.isView(d))return T(d);if(d==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d);if(P(d,ArrayBuffer)||d&&P(d.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(P(d,SharedArrayBuffer)||d&&P(d.buffer,SharedArrayBuffer)))return O(d,c,u);if(typeof d=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var y=d.valueOf&&d.valueOf();if(y!=null&&y!==d)return o.from(y,c,u);var g=Y(d);if(g)return g;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof d[Symbol.toPrimitive]=="function")return o.from(d[Symbol.toPrimitive]("string"),c,u);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d)}o.from=function(d,c,u){return h(d,c,u)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function w(d){if(typeof d!="number")throw new TypeError('"size" argument must be of type number');if(d<0)throw new RangeError('The value "'+d+'" is invalid for option "size"')}function A(d,c,u){return w(d),d<=0?a(d):c!==void 0?typeof u=="string"?a(d).fill(c,u):a(d).fill(c):a(d)}o.alloc=function(d,c,u){return A(d,c,u)};function _(d){return w(d),a(d<0?0:C(d)|0)}o.allocUnsafe=function(d){return _(d)},o.allocUnsafeSlow=function(d){return _(d)};function m(d,c){if((typeof c!="string"||c==="")&&(c="utf8"),!o.isEncoding(c))throw new TypeError("Unknown encoding: "+c);var u=F(d,c)|0,y=a(u),g=y.write(d,c);return g!==u&&(y=y.slice(0,g)),y}function E(d){for(var c=d.length<0?0:C(d.length)|0,u=a(c),y=0;y<c;y+=1)u[y]=d[y]&255;return u}function T(d){if(P(d,Uint8Array)){var c=new Uint8Array(d);return O(c.buffer,c.byteOffset,c.byteLength)}return E(d)}function O(d,c,u){if(c<0||d.byteLength<c)throw new RangeError('"offset" is outside of buffer bounds');if(d.byteLength<c+(u||0))throw new RangeError('"length" is outside of buffer bounds');var y;return c===void 0&&u===void 0?y=new Uint8Array(d):u===void 0?y=new Uint8Array(d,c):y=new Uint8Array(d,c,u),Object.setPrototypeOf(y,o.prototype),y}function Y(d){if(o.isBuffer(d)){var c=C(d.length)|0,u=a(c);return u.length===0||d.copy(u,0,0,c),u}if(d.length!==void 0)return typeof d.length!="number"||U(d.length)?a(0):E(d);if(d.type==="Buffer"&&Array.isArray(d.data))return E(d.data)}function C(d){if(d>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return d|0}function G(d){return+d!=d&&(d=0),o.alloc(+d)}o.isBuffer=function(c){return c!=null&&c._isBuffer===!0&&c!==o.prototype},o.compare=function(c,u){if(P(c,Uint8Array)&&(c=o.from(c,c.offset,c.byteLength)),P(u,Uint8Array)&&(u=o.from(u,u.offset,u.byteLength)),!o.isBuffer(c)||!o.isBuffer(u))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(c===u)return 0;for(var y=c.length,g=u.length,S=0,V=Math.min(y,g);S<V;++S)if(c[S]!==u[S]){y=c[S],g=u[S];break}return y<g?-1:g<y?1:0},o.isEncoding=function(c){switch(String(c).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(c,u){if(!Array.isArray(c))throw new TypeError('"list" argument must be an Array of Buffers');if(c.length===0)return o.alloc(0);var y;if(u===void 0)for(u=0,y=0;y<c.length;++y)u+=c[y].length;var g=o.allocUnsafe(u),S=0;for(y=0;y<c.length;++y){var V=c[y];if(P(V,Uint8Array))S+V.length>g.length?o.from(V).copy(g,S):Uint8Array.prototype.set.call(g,V,S);else if(o.isBuffer(V))V.copy(g,S);else throw new TypeError('"list" argument must be an Array of Buffers');S+=V.length}return g};function F(d,c){if(o.isBuffer(d))return d.length;if(ArrayBuffer.isView(d)||P(d,ArrayBuffer))return d.byteLength;if(typeof d!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof d);var u=d.length,y=arguments.length>2&&arguments[2]===!0;if(!y&&u===0)return 0;for(var g=!1;;)switch(c){case"ascii":case"latin1":case"binary":return u;case"utf8":case"utf-8":return ae(d).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u*2;case"hex":return u>>>1;case"base64":return B(d).length;default:if(g)return y?-1:ae(d).length;c=(""+c).toLowerCase(),g=!0}}o.byteLength=F;function z(d,c,u){var y=!1;if((c===void 0||c<0)&&(c=0),c>this.length||((u===void 0||u>this.length)&&(u=this.length),u<=0)||(u>>>=0,c>>>=0,u<=c))return"";for(d||(d="utf8");;)switch(d){case"hex":return se(this,c,u);case"utf8":case"utf-8":return Z(this,c,u);case"ascii":return le(this,c,u);case"latin1":case"binary":return J(this,c,u);case"base64":return q(this,c,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oe(this,c,u);default:if(y)throw new TypeError("Unknown encoding: "+d);d=(d+"").toLowerCase(),y=!0}}o.prototype._isBuffer=!0;function L(d,c,u){var y=d[c];d[c]=d[u],d[u]=y}o.prototype.swap16=function(){var c=this.length;if(c%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var u=0;u<c;u+=2)L(this,u,u+1);return this},o.prototype.swap32=function(){var c=this.length;if(c%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var u=0;u<c;u+=4)L(this,u,u+3),L(this,u+1,u+2);return this},o.prototype.swap64=function(){var c=this.length;if(c%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var u=0;u<c;u+=8)L(this,u,u+7),L(this,u+1,u+6),L(this,u+2,u+5),L(this,u+3,u+4);return this},o.prototype.toString=function(){var c=this.length;return c===0?"":arguments.length===0?Z(this,0,c):z.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(c){if(!o.isBuffer(c))throw new TypeError("Argument must be a Buffer");return this===c?!0:o.compare(this,c)===0},o.prototype.inspect=function(){var c="",u=t.INSPECT_MAX_BYTES;return c=this.toString("hex",0,u).replace(/(.{2})/g,"$1 ").trim(),this.length>u&&(c+=" ... "),"<Buffer "+c+">"},n&&(o.prototype[n]=o.prototype.inspect),o.prototype.compare=function(c,u,y,g,S){if(P(c,Uint8Array)&&(c=o.from(c,c.offset,c.byteLength)),!o.isBuffer(c))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof c);if(u===void 0&&(u=0),y===void 0&&(y=c?c.length:0),g===void 0&&(g=0),S===void 0&&(S=this.length),u<0||y>c.length||g<0||S>this.length)throw new RangeError("out of range index");if(g>=S&&u>=y)return 0;if(g>=S)return-1;if(u>=y)return 1;if(u>>>=0,y>>>=0,g>>>=0,S>>>=0,this===c)return 0;for(var V=S-g,ee=y-u,fe=Math.min(V,ee),he=this.slice(g,S),ge=c.slice(u,y),p=0;p<fe;++p)if(he[p]!==ge[p]){V=he[p],ee=ge[p];break}return V<ee?-1:ee<V?1:0};function j(d,c,u,y,g){if(d.length===0)return-1;if(typeof u=="string"?(y=u,u=0):u>2147483647?u=2147483647:u<-2147483648&&(u=-2147483648),u=+u,U(u)&&(u=g?0:d.length-1),u<0&&(u=d.length+u),u>=d.length){if(g)return-1;u=d.length-1}else if(u<0)if(g)u=0;else return-1;if(typeof c=="string"&&(c=o.from(c,y)),o.isBuffer(c))return c.length===0?-1:W(d,c,u,y,g);if(typeof c=="number")return c=c&255,typeof Uint8Array.prototype.indexOf=="function"?g?Uint8Array.prototype.indexOf.call(d,c,u):Uint8Array.prototype.lastIndexOf.call(d,c,u):W(d,[c],u,y,g);throw new TypeError("val must be string, number or Buffer")}function W(d,c,u,y,g){var S=1,V=d.length,ee=c.length;if(y!==void 0&&(y=String(y).toLowerCase(),y==="ucs2"||y==="ucs-2"||y==="utf16le"||y==="utf-16le")){if(d.length<2||c.length<2)return-1;S=2,V/=2,ee/=2,u/=2}function fe(l,v){return S===1?l[v]:l.readUInt16BE(v*S)}var he;if(g){var ge=-1;for(he=u;he<V;he++)if(fe(d,he)===fe(c,ge===-1?0:he-ge)){if(ge===-1&&(ge=he),he-ge+1===ee)return ge*S}else ge!==-1&&(he-=he-ge),ge=-1}else for(u+ee>V&&(u=V-ee),he=u;he>=0;he--){for(var p=!0,f=0;f<ee;f++)if(fe(d,he+f)!==fe(c,f)){p=!1;break}if(p)return he}return-1}o.prototype.includes=function(c,u,y){return this.indexOf(c,u,y)!==-1},o.prototype.indexOf=function(c,u,y){return j(this,c,u,y,!0)},o.prototype.lastIndexOf=function(c,u,y){return j(this,c,u,y,!1)};function D(d,c,u,y){u=Number(u)||0;var g=d.length-u;y?(y=Number(y),y>g&&(y=g)):y=g;var S=c.length;y>S/2&&(y=S/2);for(var V=0;V<y;++V){var ee=parseInt(c.substr(V*2,2),16);if(U(ee))return V;d[u+V]=ee}return V}function $(d,c,u,y){return N(ae(c,d.length-u),d,u,y)}function k(d,c,u,y){return N(ce(c),d,u,y)}function te(d,c,u,y){return N(B(c),d,u,y)}function X(d,c,u,y){return N(b(c,d.length-u),d,u,y)}o.prototype.write=function(c,u,y,g){if(u===void 0)g="utf8",y=this.length,u=0;else if(y===void 0&&typeof u=="string")g=u,y=this.length,u=0;else if(isFinite(u))u=u>>>0,isFinite(y)?(y=y>>>0,g===void 0&&(g="utf8")):(g=y,y=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var S=this.length-u;if((y===void 0||y>S)&&(y=S),c.length>0&&(y<0||u<0)||u>this.length)throw new RangeError("Attempt to write outside buffer bounds");g||(g="utf8");for(var V=!1;;)switch(g){case"hex":return D(this,c,u,y);case"utf8":case"utf-8":return $(this,c,u,y);case"ascii":case"latin1":case"binary":return k(this,c,u,y);case"base64":return te(this,c,u,y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X(this,c,u,y);default:if(V)throw new TypeError("Unknown encoding: "+g);g=(""+g).toLowerCase(),V=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function q(d,c,u){return c===0&&u===d.length?e.fromByteArray(d):e.fromByteArray(d.slice(c,u))}function Z(d,c,u){u=Math.min(d.length,u);for(var y=[],g=c;g<u;){var S=d[g],V=null,ee=S>239?4:S>223?3:S>191?2:1;if(g+ee<=u){var fe,he,ge,p;switch(ee){case 1:S<128&&(V=S);break;case 2:fe=d[g+1],(fe&192)===128&&(p=(S&31)<<6|fe&63,p>127&&(V=p));break;case 3:fe=d[g+1],he=d[g+2],(fe&192)===128&&(he&192)===128&&(p=(S&15)<<12|(fe&63)<<6|he&63,p>2047&&(p<55296||p>57343)&&(V=p));break;case 4:fe=d[g+1],he=d[g+2],ge=d[g+3],(fe&192)===128&&(he&192)===128&&(ge&192)===128&&(p=(S&15)<<18|(fe&63)<<12|(he&63)<<6|ge&63,p>65535&&p<1114112&&(V=p))}}V===null?(V=65533,ee=1):V>65535&&(V-=65536,y.push(V>>>10&1023|55296),V=56320|V&1023),y.push(V),g+=ee}return ue(y)}var Q=4096;function ue(d){var c=d.length;if(c<=Q)return String.fromCharCode.apply(String,d);for(var u="",y=0;y<c;)u+=String.fromCharCode.apply(String,d.slice(y,y+=Q));return u}function le(d,c,u){var y="";u=Math.min(d.length,u);for(var g=c;g<u;++g)y+=String.fromCharCode(d[g]&127);return y}function J(d,c,u){var y="";u=Math.min(d.length,u);for(var g=c;g<u;++g)y+=String.fromCharCode(d[g]);return y}function se(d,c,u){var y=d.length;(!c||c<0)&&(c=0),(!u||u<0||u>y)&&(u=y);for(var g="",S=c;S<u;++S)g+=M[d[S]];return g}function oe(d,c,u){for(var y=d.slice(c,u),g="",S=0;S<y.length-1;S+=2)g+=String.fromCharCode(y[S]+y[S+1]*256);return g}o.prototype.slice=function(c,u){var y=this.length;c=~~c,u=u===void 0?y:~~u,c<0?(c+=y,c<0&&(c=0)):c>y&&(c=y),u<0?(u+=y,u<0&&(u=0)):u>y&&(u=y),u<c&&(u=c);var g=this.subarray(c,u);return Object.setPrototypeOf(g,o.prototype),g};function re(d,c,u){if(d%1!==0||d<0)throw new RangeError("offset is not uint");if(d+c>u)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(c,u,y){c=c>>>0,u=u>>>0,y||re(c,u,this.length);for(var g=this[c],S=1,V=0;++V<u&&(S*=256);)g+=this[c+V]*S;return g},o.prototype.readUintBE=o.prototype.readUIntBE=function(c,u,y){c=c>>>0,u=u>>>0,y||re(c,u,this.length);for(var g=this[c+--u],S=1;u>0&&(S*=256);)g+=this[c+--u]*S;return g},o.prototype.readUint8=o.prototype.readUInt8=function(c,u){return c=c>>>0,u||re(c,1,this.length),this[c]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(c,u){return c=c>>>0,u||re(c,2,this.length),this[c]|this[c+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(c,u){return c=c>>>0,u||re(c,2,this.length),this[c]<<8|this[c+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(c,u){return c=c>>>0,u||re(c,4,this.length),(this[c]|this[c+1]<<8|this[c+2]<<16)+this[c+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(c,u){return c=c>>>0,u||re(c,4,this.length),this[c]*16777216+(this[c+1]<<16|this[c+2]<<8|this[c+3])},o.prototype.readIntLE=function(c,u,y){c=c>>>0,u=u>>>0,y||re(c,u,this.length);for(var g=this[c],S=1,V=0;++V<u&&(S*=256);)g+=this[c+V]*S;return S*=128,g>=S&&(g-=Math.pow(2,8*u)),g},o.prototype.readIntBE=function(c,u,y){c=c>>>0,u=u>>>0,y||re(c,u,this.length);for(var g=u,S=1,V=this[c+--g];g>0&&(S*=256);)V+=this[c+--g]*S;return S*=128,V>=S&&(V-=Math.pow(2,8*u)),V},o.prototype.readInt8=function(c,u){return c=c>>>0,u||re(c,1,this.length),this[c]&128?(255-this[c]+1)*-1:this[c]},o.prototype.readInt16LE=function(c,u){c=c>>>0,u||re(c,2,this.length);var y=this[c]|this[c+1]<<8;return y&32768?y|4294901760:y},o.prototype.readInt16BE=function(c,u){c=c>>>0,u||re(c,2,this.length);var y=this[c+1]|this[c]<<8;return y&32768?y|4294901760:y},o.prototype.readInt32LE=function(c,u){return c=c>>>0,u||re(c,4,this.length),this[c]|this[c+1]<<8|this[c+2]<<16|this[c+3]<<24},o.prototype.readInt32BE=function(c,u){return c=c>>>0,u||re(c,4,this.length),this[c]<<24|this[c+1]<<16|this[c+2]<<8|this[c+3]},o.prototype.readFloatLE=function(c,u){return c=c>>>0,u||re(c,4,this.length),r.read(this,c,!0,23,4)},o.prototype.readFloatBE=function(c,u){return c=c>>>0,u||re(c,4,this.length),r.read(this,c,!1,23,4)},o.prototype.readDoubleLE=function(c,u){return c=c>>>0,u||re(c,8,this.length),r.read(this,c,!0,52,8)},o.prototype.readDoubleBE=function(c,u){return c=c>>>0,u||re(c,8,this.length),r.read(this,c,!1,52,8)};function ne(d,c,u,y,g,S){if(!o.isBuffer(d))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>g||c<S)throw new RangeError('"value" argument is out of bounds');if(u+y>d.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(c,u,y,g){if(c=+c,u=u>>>0,y=y>>>0,!g){var S=Math.pow(2,8*y)-1;ne(this,c,u,y,S,0)}var V=1,ee=0;for(this[u]=c&255;++ee<y&&(V*=256);)this[u+ee]=c/V&255;return u+y},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(c,u,y,g){if(c=+c,u=u>>>0,y=y>>>0,!g){var S=Math.pow(2,8*y)-1;ne(this,c,u,y,S,0)}var V=y-1,ee=1;for(this[u+V]=c&255;--V>=0&&(ee*=256);)this[u+V]=c/ee&255;return u+y},o.prototype.writeUint8=o.prototype.writeUInt8=function(c,u,y){return c=+c,u=u>>>0,y||ne(this,c,u,1,255,0),this[u]=c&255,u+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(c,u,y){return c=+c,u=u>>>0,y||ne(this,c,u,2,65535,0),this[u]=c&255,this[u+1]=c>>>8,u+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(c,u,y){return c=+c,u=u>>>0,y||ne(this,c,u,2,65535,0),this[u]=c>>>8,this[u+1]=c&255,u+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(c,u,y){return c=+c,u=u>>>0,y||ne(this,c,u,4,4294967295,0),this[u+3]=c>>>24,this[u+2]=c>>>16,this[u+1]=c>>>8,this[u]=c&255,u+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(c,u,y){return c=+c,u=u>>>0,y||ne(this,c,u,4,4294967295,0),this[u]=c>>>24,this[u+1]=c>>>16,this[u+2]=c>>>8,this[u+3]=c&255,u+4},o.prototype.writeIntLE=function(c,u,y,g){if(c=+c,u=u>>>0,!g){var S=Math.pow(2,8*y-1);ne(this,c,u,y,S-1,-S)}var V=0,ee=1,fe=0;for(this[u]=c&255;++V<y&&(ee*=256);)c<0&&fe===0&&this[u+V-1]!==0&&(fe=1),this[u+V]=(c/ee>>0)-fe&255;return u+y},o.prototype.writeIntBE=function(c,u,y,g){if(c=+c,u=u>>>0,!g){var S=Math.pow(2,8*y-1);ne(this,c,u,y,S-1,-S)}var V=y-1,ee=1,fe=0;for(this[u+V]=c&255;--V>=0&&(ee*=256);)c<0&&fe===0&&this[u+V+1]!==0&&(fe=1),this[u+V]=(c/ee>>0)-fe&255;return u+y},o.prototype.writeInt8=function(c,u,y){return c=+c,u=u>>>0,y||ne(this,c,u,1,127,-128),c<0&&(c=255+c+1),this[u]=c&255,u+1},o.prototype.writeInt16LE=function(c,u,y){return c=+c,u=u>>>0,y||ne(this,c,u,2,32767,-32768),this[u]=c&255,this[u+1]=c>>>8,u+2},o.prototype.writeInt16BE=function(c,u,y){return c=+c,u=u>>>0,y||ne(this,c,u,2,32767,-32768),this[u]=c>>>8,this[u+1]=c&255,u+2},o.prototype.writeInt32LE=function(c,u,y){return c=+c,u=u>>>0,y||ne(this,c,u,4,2147483647,-2147483648),this[u]=c&255,this[u+1]=c>>>8,this[u+2]=c>>>16,this[u+3]=c>>>24,u+4},o.prototype.writeInt32BE=function(c,u,y){return c=+c,u=u>>>0,y||ne(this,c,u,4,2147483647,-2147483648),c<0&&(c=4294967295+c+1),this[u]=c>>>24,this[u+1]=c>>>16,this[u+2]=c>>>8,this[u+3]=c&255,u+4};function Te(d,c,u,y,g,S){if(u+y>d.length)throw new RangeError("Index out of range");if(u<0)throw new RangeError("Index out of range")}function x(d,c,u,y,g){return c=+c,u=u>>>0,g||Te(d,c,u,4),r.write(d,c,u,y,23,4),u+4}o.prototype.writeFloatLE=function(c,u,y){return x(this,c,u,!0,y)},o.prototype.writeFloatBE=function(c,u,y){return x(this,c,u,!1,y)};function me(d,c,u,y,g){return c=+c,u=u>>>0,g||Te(d,c,u,8),r.write(d,c,u,y,52,8),u+8}o.prototype.writeDoubleLE=function(c,u,y){return me(this,c,u,!0,y)},o.prototype.writeDoubleBE=function(c,u,y){return me(this,c,u,!1,y)},o.prototype.copy=function(c,u,y,g){if(!o.isBuffer(c))throw new TypeError("argument should be a Buffer");if(y||(y=0),!g&&g!==0&&(g=this.length),u>=c.length&&(u=c.length),u||(u=0),g>0&&g<y&&(g=y),g===y||c.length===0||this.length===0)return 0;if(u<0)throw new RangeError("targetStart out of bounds");if(y<0||y>=this.length)throw new RangeError("Index out of range");if(g<0)throw new RangeError("sourceEnd out of bounds");g>this.length&&(g=this.length),c.length-u<g-y&&(g=c.length-u+y);var S=g-y;return this===c&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(u,y,g):Uint8Array.prototype.set.call(c,this.subarray(y,g),u),S},o.prototype.fill=function(c,u,y,g){if(typeof c=="string"){if(typeof u=="string"?(g=u,u=0,y=this.length):typeof y=="string"&&(g=y,y=this.length),g!==void 0&&typeof g!="string")throw new TypeError("encoding must be a string");if(typeof g=="string"&&!o.isEncoding(g))throw new TypeError("Unknown encoding: "+g);if(c.length===1){var S=c.charCodeAt(0);(g==="utf8"&&S<128||g==="latin1")&&(c=S)}}else typeof c=="number"?c=c&255:typeof c=="boolean"&&(c=Number(c));if(u<0||this.length<u||this.length<y)throw new RangeError("Out of range index");if(y<=u)return this;u=u>>>0,y=y===void 0?this.length:y>>>0,c||(c=0);var V;if(typeof c=="number")for(V=u;V<y;++V)this[V]=c;else{var ee=o.isBuffer(c)?c:o.from(c,g),fe=ee.length;if(fe===0)throw new TypeError('The value "'+c+'" is invalid for argument "value"');for(V=0;V<y-u;++V)this[V+u]=ee[V%fe]}return this};var Fe=/[^+/0-9A-Za-z-_]/g;function Pe(d){if(d=d.split("=")[0],d=d.trim().replace(Fe,""),d.length<2)return"";for(;d.length%4!==0;)d=d+"=";return d}function ae(d,c){c=c||1/0;for(var u,y=d.length,g=null,S=[],V=0;V<y;++V){if(u=d.charCodeAt(V),u>55295&&u<57344){if(!g){if(u>56319){(c-=3)>-1&&S.push(239,191,189);continue}else if(V+1===y){(c-=3)>-1&&S.push(239,191,189);continue}g=u;continue}if(u<56320){(c-=3)>-1&&S.push(239,191,189),g=u;continue}u=(g-55296<<10|u-56320)+65536}else g&&(c-=3)>-1&&S.push(239,191,189);if(g=null,u<128){if((c-=1)<0)break;S.push(u)}else if(u<2048){if((c-=2)<0)break;S.push(u>>6|192,u&63|128)}else if(u<65536){if((c-=3)<0)break;S.push(u>>12|224,u>>6&63|128,u&63|128)}else if(u<1114112){if((c-=4)<0)break;S.push(u>>18|240,u>>12&63|128,u>>6&63|128,u&63|128)}else throw new Error("Invalid code point")}return S}function ce(d){for(var c=[],u=0;u<d.length;++u)c.push(d.charCodeAt(u)&255);return c}function b(d,c){for(var u,y,g,S=[],V=0;V<d.length&&!((c-=2)<0);++V)u=d.charCodeAt(V),y=u>>8,g=u%256,S.push(g),S.push(y);return S}function B(d){return e.toByteArray(Pe(d))}function N(d,c,u,y){for(var g=0;g<y&&!(g+u>=c.length||g>=d.length);++g)c[g+u]=d[g];return g}function P(d,c){return d instanceof c||d!=null&&d.constructor!=null&&d.constructor.name!=null&&d.constructor.name===c.name}function U(d){return d!==d}var M=function(){for(var d="0123456789abcdef",c=new Array(256),u=0;u<16;++u)for(var y=u*16,g=0;g<16;++g)c[y+g]=d[u]+d[g];return c}()})(Un);var nc={exports:{}};(function(t){(function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,a="[BigNumber Error] ",o=a+"Number primitive has more than 15 significant digits: ",h=1e14,w=14,A=9007199254740991,_=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],m=1e7,E=1e9;function T(j){var W,D,$,k=x.prototype={constructor:x,toString:null,valueOf:null},te=new x(1),X=20,q=4,Z=-7,Q=21,ue=-1e7,le=1e7,J=!1,se=1,oe=0,re={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},ne="0123456789abcdefghijklmnopqrstuvwxyz",Te=!0;function x(b,B){var N,P,U,M,d,c,u,y,g=this;if(!(g instanceof x))return new x(b,B);if(B==null){if(b&&b._isBigNumber===!0){g.s=b.s,!b.c||b.e>le?g.c=g.e=null:b.e<ue?g.c=[g.e=0]:(g.e=b.e,g.c=b.c.slice());return}if((c=typeof b=="number")&&b*0==0){if(g.s=1/b<0?(b=-b,-1):1,b===~~b){for(M=0,d=b;d>=10;d/=10,M++);M>le?g.c=g.e=null:(g.e=M,g.c=[b]);return}y=String(b)}else{if(!n.test(y=String(b)))return $(g,y,c);g.s=y.charCodeAt(0)==45?(y=y.slice(1),-1):1}(M=y.indexOf("."))>-1&&(y=y.replace(".","")),(d=y.search(/e/i))>0?(M<0&&(M=d),M+=+y.slice(d+1),y=y.substring(0,d)):M<0&&(M=y.length)}else{if(G(B,2,ne.length,"Base"),B==10&&Te)return g=new x(b),ae(g,X+g.e+1,q);if(y=String(b),c=typeof b=="number"){if(b*0!=0)return $(g,y,c,B);if(g.s=1/b<0?(y=y.slice(1),-1):1,x.DEBUG&&y.replace(/^0\.0*|\./,"").length>15)throw Error(o+b)}else g.s=y.charCodeAt(0)===45?(y=y.slice(1),-1):1;for(N=ne.slice(0,B),M=d=0,u=y.length;d<u;d++)if(N.indexOf(P=y.charAt(d))<0){if(P=="."){if(d>M){M=u;continue}}else if(!U&&(y==y.toUpperCase()&&(y=y.toLowerCase())||y==y.toLowerCase()&&(y=y.toUpperCase()))){U=!0,d=-1,M=0;continue}return $(g,String(b),c,B)}c=!1,y=D(y,B,10,g.s),(M=y.indexOf("."))>-1?y=y.replace(".",""):M=y.length}for(d=0;y.charCodeAt(d)===48;d++);for(u=y.length;y.charCodeAt(--u)===48;);if(y=y.slice(d,++u)){if(u-=d,c&&x.DEBUG&&u>15&&(b>A||b!==s(b)))throw Error(o+g.s*b);if((M=M-d-1)>le)g.c=g.e=null;else if(M<ue)g.c=[g.e=0];else{if(g.e=M,g.c=[],d=(M+1)%w,M<0&&(d+=w),d<u){for(d&&g.c.push(+y.slice(0,d)),u-=w;d<u;)g.c.push(+y.slice(d,d+=w));d=w-(y=y.slice(d)).length}else d-=u;for(;d--;y+="0");g.c.push(+y)}}else g.c=[g.e=0]}x.clone=T,x.ROUND_UP=0,x.ROUND_DOWN=1,x.ROUND_CEIL=2,x.ROUND_FLOOR=3,x.ROUND_HALF_UP=4,x.ROUND_HALF_DOWN=5,x.ROUND_HALF_EVEN=6,x.ROUND_HALF_CEIL=7,x.ROUND_HALF_FLOOR=8,x.EUCLID=9,x.config=x.set=function(b){var B,N;if(b!=null)if(typeof b=="object"){if(b.hasOwnProperty(B="DECIMAL_PLACES")&&(N=b[B],G(N,0,E,B),X=N),b.hasOwnProperty(B="ROUNDING_MODE")&&(N=b[B],G(N,0,8,B),q=N),b.hasOwnProperty(B="EXPONENTIAL_AT")&&(N=b[B],N&&N.pop?(G(N[0],-E,0,B),G(N[1],0,E,B),Z=N[0],Q=N[1]):(G(N,-E,E,B),Z=-(Q=N<0?-N:N))),b.hasOwnProperty(B="RANGE"))if(N=b[B],N&&N.pop)G(N[0],-E,-1,B),G(N[1],1,E,B),ue=N[0],le=N[1];else if(G(N,-E,E,B),N)ue=-(le=N<0?-N:N);else throw Error(a+B+" cannot be zero: "+N);if(b.hasOwnProperty(B="CRYPTO"))if(N=b[B],N===!!N)if(N)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))J=N;else throw J=!N,Error(a+"crypto unavailable");else J=N;else throw Error(a+B+" not true or false: "+N);if(b.hasOwnProperty(B="MODULO_MODE")&&(N=b[B],G(N,0,9,B),se=N),b.hasOwnProperty(B="POW_PRECISION")&&(N=b[B],G(N,0,E,B),oe=N),b.hasOwnProperty(B="FORMAT"))if(N=b[B],typeof N=="object")re=N;else throw Error(a+B+" not an object: "+N);if(b.hasOwnProperty(B="ALPHABET"))if(N=b[B],typeof N=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(N))Te=N.slice(0,10)=="0123456789",ne=N;else throw Error(a+B+" invalid: "+N)}else throw Error(a+"Object expected: "+b);return{DECIMAL_PLACES:X,ROUNDING_MODE:q,EXPONENTIAL_AT:[Z,Q],RANGE:[ue,le],CRYPTO:J,MODULO_MODE:se,POW_PRECISION:oe,FORMAT:re,ALPHABET:ne}},x.isBigNumber=function(b){if(!b||b._isBigNumber!==!0)return!1;if(!x.DEBUG)return!0;var B,N,P=b.c,U=b.e,M=b.s;e:if({}.toString.call(P)=="[object Array]"){if((M===1||M===-1)&&U>=-E&&U<=E&&U===s(U)){if(P[0]===0){if(U===0&&P.length===1)return!0;break e}if(B=(U+1)%w,B<1&&(B+=w),String(P[0]).length==B){for(B=0;B<P.length;B++)if(N=P[B],N<0||N>=h||N!==s(N))break e;if(N!==0)return!0}}}else if(P===null&&U===null&&(M===null||M===1||M===-1))return!0;throw Error(a+"Invalid BigNumber: "+b)},x.maximum=x.max=function(){return Fe(arguments,-1)},x.minimum=x.min=function(){return Fe(arguments,1)},x.random=function(){var b=9007199254740992,B=Math.random()*b&2097151?function(){return s(Math.random()*b)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(N){var P,U,M,d,c,u=0,y=[],g=new x(te);if(N==null?N=X:G(N,0,E),d=i(N/w),J)if(crypto.getRandomValues){for(P=crypto.getRandomValues(new Uint32Array(d*=2));u<d;)c=P[u]*131072+(P[u+1]>>>11),c>=9e15?(U=crypto.getRandomValues(new Uint32Array(2)),P[u]=U[0],P[u+1]=U[1]):(y.push(c%1e14),u+=2);u=d/2}else if(crypto.randomBytes){for(P=crypto.randomBytes(d*=7);u<d;)c=(P[u]&31)*281474976710656+P[u+1]*1099511627776+P[u+2]*4294967296+P[u+3]*16777216+(P[u+4]<<16)+(P[u+5]<<8)+P[u+6],c>=9e15?crypto.randomBytes(7).copy(P,u):(y.push(c%1e14),u+=7);u=d/7}else throw J=!1,Error(a+"crypto unavailable");if(!J)for(;u<d;)c=B(),c<9e15&&(y[u++]=c%1e14);for(d=y[--u],N%=w,d&&N&&(c=_[w-N],y[u]=s(d/c)*c);y[u]===0;y.pop(),u--);if(u<0)y=[M=0];else{for(M=-1;y[0]===0;y.splice(0,1),M-=w);for(u=1,c=y[0];c>=10;c/=10,u++);u<w&&(M-=w-u)}return g.e=M,g.c=y,g}}(),x.sum=function(){for(var b=1,B=arguments,N=new x(B[0]);b<B.length;)N=N.plus(B[b++]);return N},D=function(){var b="0123456789";function B(N,P,U,M){for(var d,c=[0],u,y=0,g=N.length;y<g;){for(u=c.length;u--;c[u]*=P);for(c[0]+=M.indexOf(N.charAt(y++)),d=0;d<c.length;d++)c[d]>U-1&&(c[d+1]==null&&(c[d+1]=0),c[d+1]+=c[d]/U|0,c[d]%=U)}return c.reverse()}return function(N,P,U,M,d){var c,u,y,g,S,V,ee,fe,he=N.indexOf("."),ge=X,p=q;for(he>=0&&(g=oe,oe=0,N=N.replace(".",""),fe=new x(P),V=fe.pow(N.length-he),oe=g,fe.c=B(L(Y(V.c),V.e,"0"),10,U,b),fe.e=fe.c.length),ee=B(N,P,U,d?(c=ne,b):(c=b,ne)),y=g=ee.length;ee[--g]==0;ee.pop());if(!ee[0])return c.charAt(0);if(he<0?--y:(V.c=ee,V.e=y,V.s=M,V=W(V,fe,ge,p,U),ee=V.c,S=V.r,y=V.e),u=y+ge+1,he=ee[u],g=U/2,S=S||u<0||ee[u+1]!=null,S=p<4?(he!=null||S)&&(p==0||p==(V.s<0?3:2)):he>g||he==g&&(p==4||S||p==6&&ee[u-1]&1||p==(V.s<0?8:7)),u<1||!ee[0])N=S?L(c.charAt(1),-ge,c.charAt(0)):c.charAt(0);else{if(ee.length=u,S)for(--U;++ee[--u]>U;)ee[u]=0,u||(++y,ee=[1].concat(ee));for(g=ee.length;!ee[--g];);for(he=0,N="";he<=g;N+=c.charAt(ee[he++]));N=L(N,y,c.charAt(0))}return N}}(),W=function(){function b(P,U,M){var d,c,u,y,g=0,S=P.length,V=U%m,ee=U/m|0;for(P=P.slice();S--;)u=P[S]%m,y=P[S]/m|0,d=ee*u+y*V,c=V*u+d%m*m+g,g=(c/M|0)+(d/m|0)+ee*y,P[S]=c%M;return g&&(P=[g].concat(P)),P}function B(P,U,M,d){var c,u;if(M!=d)u=M>d?1:-1;else for(c=u=0;c<M;c++)if(P[c]!=U[c]){u=P[c]>U[c]?1:-1;break}return u}function N(P,U,M,d){for(var c=0;M--;)P[M]-=c,c=P[M]<U[M]?1:0,P[M]=c*d+P[M]-U[M];for(;!P[0]&&P.length>1;P.splice(0,1));}return function(P,U,M,d,c){var u,y,g,S,V,ee,fe,he,ge,p,f,l,v,R,H,K,ye,_e=P.s==U.s?1:-1,we=P.c,pe=U.c;if(!we||!we[0]||!pe||!pe[0])return new x(!P.s||!U.s||(we?pe&&we[0]==pe[0]:!pe)?NaN:we&&we[0]==0||!pe?_e*0:_e/0);for(he=new x(_e),ge=he.c=[],y=P.e-U.e,_e=M+y+1,c||(c=h,y=O(P.e/w)-O(U.e/w),_e=_e/w|0),g=0;pe[g]==(we[g]||0);g++);if(pe[g]>(we[g]||0)&&y--,_e<0)ge.push(1),S=!0;else{for(R=we.length,K=pe.length,g=0,_e+=2,V=s(c/(pe[0]+1)),V>1&&(pe=b(pe,V,c),we=b(we,V,c),K=pe.length,R=we.length),v=K,p=we.slice(0,K),f=p.length;f<K;p[f++]=0);ye=pe.slice(),ye=[0].concat(ye),H=pe[0],pe[1]>=c/2&&H++;do{if(V=0,u=B(pe,p,K,f),u<0){if(l=p[0],K!=f&&(l=l*c+(p[1]||0)),V=s(l/H),V>1)for(V>=c&&(V=c-1),ee=b(pe,V,c),fe=ee.length,f=p.length;B(ee,p,fe,f)==1;)V--,N(ee,K<fe?ye:pe,fe,c),fe=ee.length,u=1;else V==0&&(u=V=1),ee=pe.slice(),fe=ee.length;if(fe<f&&(ee=[0].concat(ee)),N(p,ee,f,c),f=p.length,u==-1)for(;B(pe,p,K,f)<1;)V++,N(p,K<f?ye:pe,f,c),f=p.length}else u===0&&(V++,p=[0]);ge[g++]=V,p[0]?p[f++]=we[v]||0:(p=[we[v]],f=1)}while((v++<R||p[0]!=null)&&_e--);S=p[0]!=null,ge[0]||ge.splice(0,1)}if(c==h){for(g=1,_e=ge[0];_e>=10;_e/=10,g++);ae(he,M+(he.e=g+y*w-1)+1,d,S)}else he.e=y,he.r=+S;return he}}();function me(b,B,N,P){var U,M,d,c,u;if(N==null?N=q:G(N,0,8),!b.c)return b.toString();if(U=b.c[0],d=b.e,B==null)u=Y(b.c),u=P==1||P==2&&(d<=Z||d>=Q)?z(u,d):L(u,d,"0");else if(b=ae(new x(b),B,N),M=b.e,u=Y(b.c),c=u.length,P==1||P==2&&(B<=M||M<=Z)){for(;c<B;u+="0",c++);u=z(u,M)}else if(B-=d+(P===2&&M>d),u=L(u,M,"0"),M+1>c){if(--B>0)for(u+=".";B--;u+="0");}else if(B+=M-c,B>0)for(M+1==c&&(u+=".");B--;u+="0");return b.s<0&&U?"-"+u:u}function Fe(b,B){for(var N,P,U=1,M=new x(b[0]);U<b.length;U++)P=new x(b[U]),(!P.s||(N=C(M,P))===B||N===0&&M.s===B)&&(M=P);return M}function Pe(b,B,N){for(var P=1,U=B.length;!B[--U];B.pop());for(U=B[0];U>=10;U/=10,P++);return(N=P+N*w-1)>le?b.c=b.e=null:N<ue?b.c=[b.e=0]:(b.e=N,b.c=B),b}$=function(){var b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,B=/^([^.]+)\.$/,N=/^\.([^.]+)$/,P=/^-?(Infinity|NaN)$/,U=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(M,d,c,u){var y,g=c?d:d.replace(U,"");if(P.test(g))M.s=isNaN(g)?null:g<0?-1:1;else{if(!c&&(g=g.replace(b,function(S,V,ee){return y=(ee=ee.toLowerCase())=="x"?16:ee=="b"?2:8,!u||u==y?V:S}),u&&(y=u,g=g.replace(B,"$1").replace(N,"0.$1")),d!=g))return new x(g,y);if(x.DEBUG)throw Error(a+"Not a"+(u?" base "+u:"")+" number: "+d);M.s=null}M.c=M.e=null}}();function ae(b,B,N,P){var U,M,d,c,u,y,g,S=b.c,V=_;if(S){e:{for(U=1,c=S[0];c>=10;c/=10,U++);if(M=B-U,M<0)M+=w,d=B,u=S[y=0],g=s(u/V[U-d-1]%10);else if(y=i((M+1)/w),y>=S.length)if(P){for(;S.length<=y;S.push(0));u=g=0,U=1,M%=w,d=M-w+1}else break e;else{for(u=c=S[y],U=1;c>=10;c/=10,U++);M%=w,d=M-w+U,g=d<0?0:s(u/V[U-d-1]%10)}if(P=P||B<0||S[y+1]!=null||(d<0?u:u%V[U-d-1]),P=N<4?(g||P)&&(N==0||N==(b.s<0?3:2)):g>5||g==5&&(N==4||P||N==6&&(M>0?d>0?u/V[U-d]:0:S[y-1])%10&1||N==(b.s<0?8:7)),B<1||!S[0])return S.length=0,P?(B-=b.e+1,S[0]=V[(w-B%w)%w],b.e=-B||0):S[0]=b.e=0,b;if(M==0?(S.length=y,c=1,y--):(S.length=y+1,c=V[w-M],S[y]=d>0?s(u/V[U-d]%V[d])*c:0),P)for(;;)if(y==0){for(M=1,d=S[0];d>=10;d/=10,M++);for(d=S[0]+=c,c=1;d>=10;d/=10,c++);M!=c&&(b.e++,S[0]==h&&(S[0]=1));break}else{if(S[y]+=c,S[y]!=h)break;S[y--]=0,c=1}for(M=S.length;S[--M]===0;S.pop());}b.e>le?b.c=b.e=null:b.e<ue&&(b.c=[b.e=0])}return b}function ce(b){var B,N=b.e;return N===null?b.toString():(B=Y(b.c),B=N<=Z||N>=Q?z(B,N):L(B,N,"0"),b.s<0?"-"+B:B)}return k.absoluteValue=k.abs=function(){var b=new x(this);return b.s<0&&(b.s=1),b},k.comparedTo=function(b,B){return C(this,new x(b,B))},k.decimalPlaces=k.dp=function(b,B){var N,P,U,M=this;if(b!=null)return G(b,0,E),B==null?B=q:G(B,0,8),ae(new x(M),b+M.e+1,B);if(!(N=M.c))return null;if(P=((U=N.length-1)-O(this.e/w))*w,U=N[U])for(;U%10==0;U/=10,P--);return P<0&&(P=0),P},k.dividedBy=k.div=function(b,B){return W(this,new x(b,B),X,q)},k.dividedToIntegerBy=k.idiv=function(b,B){return W(this,new x(b,B),0,1)},k.exponentiatedBy=k.pow=function(b,B){var N,P,U,M,d,c,u,y,g,S=this;if(b=new x(b),b.c&&!b.isInteger())throw Error(a+"Exponent not an integer: "+ce(b));if(B!=null&&(B=new x(B)),c=b.e>14,!S.c||!S.c[0]||S.c[0]==1&&!S.e&&S.c.length==1||!b.c||!b.c[0])return g=new x(Math.pow(+ce(S),c?b.s*(2-F(b)):+ce(b))),B?g.mod(B):g;if(u=b.s<0,B){if(B.c?!B.c[0]:!B.s)return new x(NaN);P=!u&&S.isInteger()&&B.isInteger(),P&&(S=S.mod(B))}else{if(b.e>9&&(S.e>0||S.e<-1||(S.e==0?S.c[0]>1||c&&S.c[1]>=24e7:S.c[0]<8e13||c&&S.c[0]<=9999975e7)))return M=S.s<0&&F(b)?-0:0,S.e>-1&&(M=1/M),new x(u?1/M:M);oe&&(M=i(oe/w+2))}for(c?(N=new x(.5),u&&(b.s=1),y=F(b)):(U=Math.abs(+ce(b)),y=U%2),g=new x(te);;){if(y){if(g=g.times(S),!g.c)break;M?g.c.length>M&&(g.c.length=M):P&&(g=g.mod(B))}if(U){if(U=s(U/2),U===0)break;y=U%2}else if(b=b.times(N),ae(b,b.e+1,1),b.e>14)y=F(b);else{if(U=+ce(b),U===0)break;y=U%2}S=S.times(S),M?S.c&&S.c.length>M&&(S.c.length=M):P&&(S=S.mod(B))}return P?g:(u&&(g=te.div(g)),B?g.mod(B):M?ae(g,oe,q,d):g)},k.integerValue=function(b){var B=new x(this);return b==null?b=q:G(b,0,8),ae(B,B.e+1,b)},k.isEqualTo=k.eq=function(b,B){return C(this,new x(b,B))===0},k.isFinite=function(){return!!this.c},k.isGreaterThan=k.gt=function(b,B){return C(this,new x(b,B))>0},k.isGreaterThanOrEqualTo=k.gte=function(b,B){return(B=C(this,new x(b,B)))===1||B===0},k.isInteger=function(){return!!this.c&&O(this.e/w)>this.c.length-2},k.isLessThan=k.lt=function(b,B){return C(this,new x(b,B))<0},k.isLessThanOrEqualTo=k.lte=function(b,B){return(B=C(this,new x(b,B)))===-1||B===0},k.isNaN=function(){return!this.s},k.isNegative=function(){return this.s<0},k.isPositive=function(){return this.s>0},k.isZero=function(){return!!this.c&&this.c[0]==0},k.minus=function(b,B){var N,P,U,M,d=this,c=d.s;if(b=new x(b,B),B=b.s,!c||!B)return new x(NaN);if(c!=B)return b.s=-B,d.plus(b);var u=d.e/w,y=b.e/w,g=d.c,S=b.c;if(!u||!y){if(!g||!S)return g?(b.s=-B,b):new x(S?d:NaN);if(!g[0]||!S[0])return S[0]?(b.s=-B,b):new x(g[0]?d:q==3?-0:0)}if(u=O(u),y=O(y),g=g.slice(),c=u-y){for((M=c<0)?(c=-c,U=g):(y=u,U=S),U.reverse(),B=c;B--;U.push(0));U.reverse()}else for(P=(M=(c=g.length)<(B=S.length))?c:B,c=B=0;B<P;B++)if(g[B]!=S[B]){M=g[B]<S[B];break}if(M&&(U=g,g=S,S=U,b.s=-b.s),B=(P=S.length)-(N=g.length),B>0)for(;B--;g[N++]=0);for(B=h-1;P>c;){if(g[--P]<S[P]){for(N=P;N&&!g[--N];g[N]=B);--g[N],g[P]+=h}g[P]-=S[P]}for(;g[0]==0;g.splice(0,1),--y);return g[0]?Pe(b,g,y):(b.s=q==3?-1:1,b.c=[b.e=0],b)},k.modulo=k.mod=function(b,B){var N,P,U=this;return b=new x(b,B),!U.c||!b.s||b.c&&!b.c[0]?new x(NaN):!b.c||U.c&&!U.c[0]?new x(U):(se==9?(P=b.s,b.s=1,N=W(U,b,0,3),b.s=P,N.s*=P):N=W(U,b,0,se),b=U.minus(N.times(b)),!b.c[0]&&se==1&&(b.s=U.s),b)},k.multipliedBy=k.times=function(b,B){var N,P,U,M,d,c,u,y,g,S,V,ee,fe,he,ge,p=this,f=p.c,l=(b=new x(b,B)).c;if(!f||!l||!f[0]||!l[0])return!p.s||!b.s||f&&!f[0]&&!l||l&&!l[0]&&!f?b.c=b.e=b.s=null:(b.s*=p.s,!f||!l?b.c=b.e=null:(b.c=[0],b.e=0)),b;for(P=O(p.e/w)+O(b.e/w),b.s*=p.s,u=f.length,S=l.length,u<S&&(fe=f,f=l,l=fe,U=u,u=S,S=U),U=u+S,fe=[];U--;fe.push(0));for(he=h,ge=m,U=S;--U>=0;){for(N=0,V=l[U]%ge,ee=l[U]/ge|0,d=u,M=U+d;M>U;)y=f[--d]%ge,g=f[d]/ge|0,c=ee*y+g*V,y=V*y+c%ge*ge+fe[M]+N,N=(y/he|0)+(c/ge|0)+ee*g,fe[M--]=y%he;fe[M]=N}return N?++P:fe.splice(0,1),Pe(b,fe,P)},k.negated=function(){var b=new x(this);return b.s=-b.s||null,b},k.plus=function(b,B){var N,P=this,U=P.s;if(b=new x(b,B),B=b.s,!U||!B)return new x(NaN);if(U!=B)return b.s=-B,P.minus(b);var M=P.e/w,d=b.e/w,c=P.c,u=b.c;if(!M||!d){if(!c||!u)return new x(U/0);if(!c[0]||!u[0])return u[0]?b:new x(c[0]?P:U*0)}if(M=O(M),d=O(d),c=c.slice(),U=M-d){for(U>0?(d=M,N=u):(U=-U,N=c),N.reverse();U--;N.push(0));N.reverse()}for(U=c.length,B=u.length,U-B<0&&(N=u,u=c,c=N,B=U),U=0;B;)U=(c[--B]=c[B]+u[B]+U)/h|0,c[B]=h===c[B]?0:c[B]%h;return U&&(c=[U].concat(c),++d),Pe(b,c,d)},k.precision=k.sd=function(b,B){var N,P,U,M=this;if(b!=null&&b!==!!b)return G(b,1,E),B==null?B=q:G(B,0,8),ae(new x(M),b,B);if(!(N=M.c))return null;if(U=N.length-1,P=U*w+1,U=N[U]){for(;U%10==0;U/=10,P--);for(U=N[0];U>=10;U/=10,P++);}return b&&M.e+1>P&&(P=M.e+1),P},k.shiftedBy=function(b){return G(b,-A,A),this.times("1e"+b)},k.squareRoot=k.sqrt=function(){var b,B,N,P,U,M=this,d=M.c,c=M.s,u=M.e,y=X+4,g=new x("0.5");if(c!==1||!d||!d[0])return new x(!c||c<0&&(!d||d[0])?NaN:d?M:1/0);if(c=Math.sqrt(+ce(M)),c==0||c==1/0?(B=Y(d),(B.length+u)%2==0&&(B+="0"),c=Math.sqrt(+B),u=O((u+1)/2)-(u<0||u%2),c==1/0?B="5e"+u:(B=c.toExponential(),B=B.slice(0,B.indexOf("e")+1)+u),N=new x(B)):N=new x(c+""),N.c[0]){for(u=N.e,c=u+y,c<3&&(c=0);;)if(U=N,N=g.times(U.plus(W(M,U,y,1))),Y(U.c).slice(0,c)===(B=Y(N.c)).slice(0,c))if(N.e<u&&--c,B=B.slice(c-3,c+1),B=="9999"||!P&&B=="4999"){if(!P&&(ae(U,U.e+X+2,0),U.times(U).eq(M))){N=U;break}y+=4,c+=4,P=1}else{(!+B||!+B.slice(1)&&B.charAt(0)=="5")&&(ae(N,N.e+X+2,1),b=!N.times(N).eq(M));break}}return ae(N,N.e+X+1,q,b)},k.toExponential=function(b,B){return b!=null&&(G(b,0,E),b++),me(this,b,B,1)},k.toFixed=function(b,B){return b!=null&&(G(b,0,E),b=b+this.e+1),me(this,b,B)},k.toFormat=function(b,B,N){var P,U=this;if(N==null)b!=null&&B&&typeof B=="object"?(N=B,B=null):b&&typeof b=="object"?(N=b,b=B=null):N=re;else if(typeof N!="object")throw Error(a+"Argument not an object: "+N);if(P=U.toFixed(b,B),U.c){var M,d=P.split("."),c=+N.groupSize,u=+N.secondaryGroupSize,y=N.groupSeparator||"",g=d[0],S=d[1],V=U.s<0,ee=V?g.slice(1):g,fe=ee.length;if(u&&(M=c,c=u,u=M,fe-=M),c>0&&fe>0){for(M=fe%c||c,g=ee.substr(0,M);M<fe;M+=c)g+=y+ee.substr(M,c);u>0&&(g+=y+ee.slice(M)),V&&(g="-"+g)}P=S?g+(N.decimalSeparator||"")+((u=+N.fractionGroupSize)?S.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(N.fractionGroupSeparator||"")):S):g}return(N.prefix||"")+P+(N.suffix||"")},k.toFraction=function(b){var B,N,P,U,M,d,c,u,y,g,S,V,ee=this,fe=ee.c;if(b!=null&&(c=new x(b),!c.isInteger()&&(c.c||c.s!==1)||c.lt(te)))throw Error(a+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+ce(c));if(!fe)return new x(ee);for(B=new x(te),y=N=new x(te),P=u=new x(te),V=Y(fe),M=B.e=V.length-ee.e-1,B.c[0]=_[(d=M%w)<0?w+d:d],b=!b||c.comparedTo(B)>0?M>0?B:y:c,d=le,le=1/0,c=new x(V),u.c[0]=0;g=W(c,B,0,1),U=N.plus(g.times(P)),U.comparedTo(b)!=1;)N=P,P=U,y=u.plus(g.times(U=y)),u=U,B=c.minus(g.times(U=B)),c=U;return U=W(b.minus(N),P,0,1),u=u.plus(U.times(y)),N=N.plus(U.times(P)),u.s=y.s=ee.s,M=M*2,S=W(y,P,M,q).minus(ee).abs().comparedTo(W(u,N,M,q).minus(ee).abs())<1?[y,P]:[u,N],le=d,S},k.toNumber=function(){return+ce(this)},k.toPrecision=function(b,B){return b!=null&&G(b,1,E),me(this,b,B,2)},k.toString=function(b){var B,N=this,P=N.s,U=N.e;return U===null?P?(B="Infinity",P<0&&(B="-"+B)):B="NaN":(b==null?B=U<=Z||U>=Q?z(Y(N.c),U):L(Y(N.c),U,"0"):b===10&&Te?(N=ae(new x(N),X+U+1,q),B=L(Y(N.c),N.e,"0")):(G(b,2,ne.length,"Base"),B=D(L(Y(N.c),U,"0"),10,b,P,!0)),P<0&&N.c[0]&&(B="-"+B)),B},k.valueOf=k.toJSON=function(){return ce(this)},k._isBigNumber=!0,j!=null&&x.set(j),x}function O(j){var W=j|0;return j>0||j===W?W:W-1}function Y(j){for(var W,D,$=1,k=j.length,te=j[0]+"";$<k;){for(W=j[$++]+"",D=w-W.length;D--;W="0"+W);te+=W}for(k=te.length;te.charCodeAt(--k)===48;);return te.slice(0,k+1||1)}function C(j,W){var D,$,k=j.c,te=W.c,X=j.s,q=W.s,Z=j.e,Q=W.e;if(!X||!q)return null;if(D=k&&!k[0],$=te&&!te[0],D||$)return D?$?0:-q:X;if(X!=q)return X;if(D=X<0,$=Z==Q,!k||!te)return $?0:!k^D?1:-1;if(!$)return Z>Q^D?1:-1;for(q=(Z=k.length)<(Q=te.length)?Z:Q,X=0;X<q;X++)if(k[X]!=te[X])return k[X]>te[X]^D?1:-1;return Z==Q?0:Z>Q^D?1:-1}function G(j,W,D,$){if(j<W||j>D||j!==s(j))throw Error(a+($||"Argument")+(typeof j=="number"?j<W||j>D?" out of range: ":" not an integer: ":" not a primitive number: ")+String(j))}function F(j){var W=j.c.length-1;return O(j.e/w)==W&&j.c[W]%2!=0}function z(j,W){return(j.length>1?j.charAt(0)+"."+j.slice(1):j)+(W<0?"e":"e+")+W}function L(j,W,D){var $,k;if(W<0){for(k=D+".";++W;k+=D);j=k+j}else if($=j.length,++W>$){for(k=D,W-=$;--W;k+=D);j+=k}else W<$&&(j=j.slice(0,W)+"."+j.slice(W));return j}r=T(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(Xr)})(nc);var Fi=nc.exports,qf=function(e,r,n){var i=new e.Uint8Array(n),s=r.pushInt,a=r.pushInt32,o=r.pushInt32Neg,h=r.pushInt64,w=r.pushInt64Neg,A=r.pushFloat,_=r.pushFloatSingle,m=r.pushFloatDouble,E=r.pushTrue,T=r.pushFalse,O=r.pushUndefined,Y=r.pushNull,C=r.pushInfinity,G=r.pushInfinityNeg,F=r.pushNaN,z=r.pushNaNNeg,L=r.pushArrayStart,j=r.pushArrayStartFixed,W=r.pushArrayStartFixed32,D=r.pushArrayStartFixed64,$=r.pushObjectStart,k=r.pushObjectStartFixed,te=r.pushObjectStartFixed32,X=r.pushObjectStartFixed64,q=r.pushByteString,Z=r.pushByteStringStart,Q=r.pushUtf8String,ue=r.pushUtf8StringStart,le=r.pushSimpleUnassigned,J=r.pushTagStart,se=r.pushTagStart4,oe=r.pushTagStart8,re=r.pushTagUnassigned,ne=r.pushBreak,Te=e.Math.pow,x=0,me=0,Fe=0;function Pe(I){for(I=I|0,x=0,me=I;(x|0)<(me|0)&&(Fe=$u[i[x]&255](i[x]|0)|0,!((Fe|0)>0)););return Fe|0}function ae(I){return I=I|0,((x|0)+(I|0)|0)<(me|0)?0:1}function ce(I){return I=I|0,i[I|0]<<8|i[I+1|0]|0}function b(I){return I=I|0,i[I|0]<<24|i[I+1|0]<<16|i[I+2|0]<<8|i[I+3|0]|0}function B(I){return I=I|0,s(I|0),x=x+1|0,0}function N(I){return I=I|0,ae(1)|0?1:(s(i[x+1|0]|0),x=x+2|0,0)}function P(I){return I=I|0,ae(2)|0?1:(s(ce(x+1|0)|0),x=x+3|0,0)}function U(I){return I=I|0,ae(4)|0?1:(a(ce(x+1|0)|0,ce(x+3|0)|0),x=x+5|0,0)}function M(I){return I=I|0,ae(8)|0?1:(h(ce(x+1|0)|0,ce(x+3|0)|0,ce(x+5|0)|0,ce(x+7|0)|0),x=x+9|0,0)}function d(I){return I=I|0,s(-1-(I-32|0)|0),x=x+1|0,0}function c(I){return I=I|0,ae(1)|0?1:(s(-1-(i[x+1|0]|0)|0),x=x+2|0,0)}function u(I){I=I|0;var ve=0;return ae(2)|0?1:(ve=ce(x+1|0)|0,s(-1-(ve|0)|0),x=x+3|0,0)}function y(I){return I=I|0,ae(4)|0?1:(o(ce(x+1|0)|0,ce(x+3|0)|0),x=x+5|0,0)}function g(I){return I=I|0,ae(8)|0?1:(w(ce(x+1|0)|0,ce(x+3|0)|0,ce(x+5|0)|0,ce(x+7|0)|0),x=x+9|0,0)}function S(I){I=I|0;var ve=0,Be=0,Ee=0;return Ee=I-64|0,ae(Ee|0)|0?1:(ve=x+1|0,Be=(x+1|0)+(Ee|0)|0,q(ve|0,Be|0),x=Be|0,0)}function V(I){I=I|0;var ve=0,Be=0,Ee=0;return ae(1)|0||(Ee=i[x+1|0]|0,ve=x+2|0,Be=(x+2|0)+(Ee|0)|0,ae(Ee+1|0)|0)?1:(q(ve|0,Be|0),x=Be|0,0)}function ee(I){I=I|0;var ve=0,Be=0,Ee=0;return ae(2)|0||(Ee=ce(x+1|0)|0,ve=x+3|0,Be=(x+3|0)+(Ee|0)|0,ae(Ee+2|0)|0)?1:(q(ve|0,Be|0),x=Be|0,0)}function fe(I){I=I|0;var ve=0,Be=0,Ee=0;return ae(4)|0||(Ee=b(x+1|0)|0,ve=x+5|0,Be=(x+5|0)+(Ee|0)|0,ae(Ee+4|0)|0)?1:(q(ve|0,Be|0),x=Be|0,0)}function he(I){return I=I|0,1}function ge(I){return I=I|0,Z(),x=x+1|0,0}function p(I){I=I|0;var ve=0,Be=0,Ee=0;return Ee=I-96|0,ae(Ee|0)|0?1:(ve=x+1|0,Be=(x+1|0)+(Ee|0)|0,Q(ve|0,Be|0),x=Be|0,0)}function f(I){I=I|0;var ve=0,Be=0,Ee=0;return ae(1)|0||(Ee=i[x+1|0]|0,ve=x+2|0,Be=(x+2|0)+(Ee|0)|0,ae(Ee+1|0)|0)?1:(Q(ve|0,Be|0),x=Be|0,0)}function l(I){I=I|0;var ve=0,Be=0,Ee=0;return ae(2)|0||(Ee=ce(x+1|0)|0,ve=x+3|0,Be=(x+3|0)+(Ee|0)|0,ae(Ee+2|0)|0)?1:(Q(ve|0,Be|0),x=Be|0,0)}function v(I){I=I|0;var ve=0,Be=0,Ee=0;return ae(4)|0||(Ee=b(x+1|0)|0,ve=x+5|0,Be=(x+5|0)+(Ee|0)|0,ae(Ee+4|0)|0)?1:(Q(ve|0,Be|0),x=Be|0,0)}function R(I){return I=I|0,1}function H(I){return I=I|0,ue(),x=x+1|0,0}function K(I){return I=I|0,j(I-128|0),x=x+1|0,0}function ye(I){return I=I|0,ae(1)|0?1:(j(i[x+1|0]|0),x=x+2|0,0)}function _e(I){return I=I|0,ae(2)|0?1:(j(ce(x+1|0)|0),x=x+3|0,0)}function we(I){return I=I|0,ae(4)|0?1:(W(ce(x+1|0)|0,ce(x+3|0)|0),x=x+5|0,0)}function pe(I){return I=I|0,ae(8)|0?1:(D(ce(x+1|0)|0,ce(x+3|0)|0,ce(x+5|0)|0,ce(x+7|0)|0),x=x+9|0,0)}function Se(I){return I=I|0,L(),x=x+1|0,0}function Oe(I){I=I|0;var ve=0;return ve=I-160|0,ae(ve|0)|0?1:(k(ve|0),x=x+1|0,0)}function Hi(I){return I=I|0,ae(1)|0?1:(k(i[x+1|0]|0),x=x+2|0,0)}function Yi(I){return I=I|0,ae(2)|0?1:(k(ce(x+1|0)|0),x=x+3|0,0)}function Wi(I){return I=I|0,ae(4)|0?1:(te(ce(x+1|0)|0,ce(x+3|0)|0),x=x+5|0,0)}function Li(I){return I=I|0,ae(8)|0?1:(X(ce(x+1|0)|0,ce(x+3|0)|0,ce(x+5|0)|0,ce(x+7|0)|0),x=x+9|0,0)}function zi(I){return I=I|0,$(),x=x+1|0,0}function Xt(I){return I=I|0,J(I-192|0|0),x=x+1|0,0}function od(I){return I=I|0,J(I|0),x=x+1|0,0}function ad(I){return I=I|0,J(I|0),x=x+1|0,0}function cd(I){return I=I|0,J(I|0),x=x+1|0,0}function ud(I){return I=I|0,J(I|0),x=x+1|0,0}function Ye(I){return I=I|0,J(I-192|0|0),x=x+1|0,0}function fd(I){return I=I|0,J(I|0),x=x+1|0,0}function ld(I){return I=I|0,J(I|0),x=x+1|0,0}function hd(I){return I=I|0,J(I|0),x=x+1|0,0}function Au(I){return I=I|0,ae(1)|0?1:(J(i[x+1|0]|0),x=x+2|0,0)}function Tu(I){return I=I|0,ae(2)|0?1:(J(ce(x+1|0)|0),x=x+3|0,0)}function Su(I){return I=I|0,ae(4)|0?1:(se(ce(x+1|0)|0,ce(x+3|0)|0),x=x+5|0,0)}function Nu(I){return I=I|0,ae(8)|0?1:(oe(ce(x+1|0)|0,ce(x+3|0)|0,ce(x+5|0)|0,ce(x+7|0)|0),x=x+9|0,0)}function Ge(I){return I=I|0,le((I|0)-224|0),x=x+1|0,0}function Iu(I){return I=I|0,T(),x=x+1|0,0}function Ru(I){return I=I|0,E(),x=x+1|0,0}function Uu(I){return I=I|0,Y(),x=x+1|0,0}function Ou(I){return I=I|0,O(),x=x+1|0,0}function Fu(I){return I=I|0,ae(1)|0?1:(le(i[x+1|0]|0),x=x+2|0,0)}function Pu(I){I=I|0;var ve=0,Be=0,Ee=1,kn=0,on=0,dd=0;return ae(2)|0?1:(ve=i[x+1|0]|0,Be=i[x+2|0]|0,(ve|0)&128&&(Ee=-1),kn=+(((ve|0)&124)>>2),on=+(((ve|0)&3)<<8|Be),+kn==0?A(+(+Ee*5960464477539063e-23*+on)):+kn==31?+Ee==1?+on>0?F():C():+on>0?z():G():A(+(+Ee*Te(2,+(+kn-25))*+(1024+on))),x=x+3|0,0)}function ku(I){return I=I|0,ae(4)|0?1:(_(i[x+1|0]|0,i[x+2|0]|0,i[x+3|0]|0,i[x+4|0]|0),x=x+5|0,0)}function Mu(I){return I=I|0,ae(8)|0?1:(m(i[x+1|0]|0,i[x+2|0]|0,i[x+3|0]|0,i[x+4|0]|0,i[x+5|0]|0,i[x+6|0]|0,i[x+7|0]|0,i[x+8|0]|0),x=x+9|0,0)}function Re(I){return I=I|0,1}function Cu(I){return I=I|0,ne(),x=x+1|0,0}var $u=[B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,N,P,U,M,Re,Re,Re,Re,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,c,u,y,g,Re,Re,Re,Re,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,V,ee,fe,he,Re,Re,Re,ge,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,f,l,v,R,Re,Re,Re,H,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,ye,_e,we,pe,Re,Re,Re,Se,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Oe,Hi,Yi,Wi,Li,Re,Re,Re,zi,Xt,Xt,Xt,Xt,Xt,Xt,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Ye,Au,Tu,Su,Nu,Re,Re,Re,Re,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge,Iu,Ru,Uu,Ou,Fu,Pu,ku,Mu,Re,Re,Re,Cu];return{parse:Pe}},Pi={},rt={};const Ys=Fi.BigNumber;rt.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7};rt.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36};rt.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31};rt.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23};rt.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")};rt.SHIFT32=Math.pow(2,32);rt.SHIFT16=Math.pow(2,16);rt.MAX_SAFE_HIGH=2097151;rt.NEG_ONE=new Ys(-1);rt.TEN=new Ys(10);rt.TWO=new Ys(2);rt.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5};(function(t){const{Buffer:e}=Un,r=Fi.BigNumber,n=rt,i=n.SHIFT32,s=n.SHIFT16,a=2097151;t.parseHalf=function(w){var A,_,m;return m=w[0]&128?-1:1,A=(w[0]&124)>>2,_=(w[0]&3)<<8|w[1],A?A===31?m*(_?NaN:1/0):m*Math.pow(2,A-25)*(1024+_):m*5960464477539063e-23*_};function o(h){return h<16?"0"+h.toString(16):h.toString(16)}t.arrayBufferToBignumber=function(h){const w=h.byteLength;let A="";for(let _=0;_<w;_++)A+=o(h[_]);return new r(A,16)},t.buildMap=h=>{const w=new Map,A=Object.keys(h),_=A.length;for(let m=0;m<_;m++)w.set(A[m],h[A[m]]);return w},t.buildInt32=(h,w)=>h*s+w,t.buildInt64=(h,w,A,_)=>{const m=t.buildInt32(h,w),E=t.buildInt32(A,_);return m>a?new r(m).times(i).plus(E):m*i+E},t.writeHalf=function(w,A){const _=e.allocUnsafe(4);_.writeFloatBE(A,0);const m=_.readUInt32BE(0);if(m&8191)return!1;var E=m>>16&32768;const T=m>>23&255,O=m&8388607;if(T>=113&&T<=142)E+=(T-112<<10)+(O>>13);else if(T>=103&&T<113){if(O&(1<<126-T)-1)return!1;E+=O+8388608>>126-T}else return!1;return w.writeUInt16BE(E,0),!0},t.keySorter=function(h,w){var A=h[0].byteLength,_=w[0].byteLength;return A>_?1:_>A?-1:h[0].compare(w[0])},t.isNegativeZero=h=>h===0&&1/h<0,t.nextPowerOf2=h=>{let w=0;if(h&&!(h&h-1))return h;for(;h!==0;)h>>=1,w+=1;return 1<<w}})(Pi);const Ws=rt,Vf=Ws.MT,Vn=Ws.SIMPLE,Ji=Ws.SYMS;let Gf=class Bs{constructor(e){if(typeof e!="number")throw new Error("Invalid Simple type: "+typeof e);if(e<0||e>255||(e|0)!==e)throw new Error("value must be a small positive integer: "+e);this.value=e}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(e){return e._pushInt(this.value,Vf.SIMPLE_FLOAT)}static isSimple(e){return e instanceof Bs}static decode(e,r){switch(r==null&&(r=!0),e){case Vn.FALSE:return!1;case Vn.TRUE:return!0;case Vn.NULL:return r?null:Ji.NULL;case Vn.UNDEFINED:return r?void 0:Ji.UNDEFINED;case-1:if(!r)throw new Error("Invalid BREAK");return Ji.BREAK;default:return new Bs(e)}}};var ic=Gf;let Kf=class As{constructor(e,r,n){if(this.tag=e,this.value=r,this.err=n,typeof this.tag!="number")throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(this.tag|0)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(e){return e._pushTag(this.tag),e.pushAny(this.value)}convert(e){var r,n;if(n=e!=null?e[this.tag]:void 0,typeof n!="function"&&(n=As["_tag"+this.tag],typeof n!="function"))return this;try{return n.call(As,this.value)}catch(i){return r=i,this.err=r,this}}};var sc=Kf;const oc=self.location?self.location.protocol+"//"+self.location.host:"",Ts=self.URL;let jf=class{constructor(e="",r=oc){this.super=new Ts(e,r),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set origin(e){this.super.origin=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set searchParams(e){this.super.searchParams=e}set username(e){this.super.username=e}createObjectURL(e){return this.super.createObjectURL(e)}revokeObjectURL(e){this.super.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function Hf(t){if(typeof t=="string")return new Ts(t).toString();if(!(t instanceof Ts)){const e=t.username&&t.password?`${t.username}:${t.password}@`:"",r=t.auth?t.auth+"@":"",n=t.port?":"+t.port:"",i=t.protocol?t.protocol+"//":"",s=t.host||"",a=t.hostname||"",o=t.search||(t.query?"?"+t.query:""),h=t.hash||"",w=t.pathname||"",A=t.path||w+o;return`${i}${e||r}${s||a+n}${A}${h}`}}var ac={URLWithLegacySupport:jf,URLSearchParams:self.URLSearchParams,defaultBase:oc,format:Hf};const{URLWithLegacySupport:gd,format:md}=ac,{URLWithLegacySupport:Yf,format:bd,URLSearchParams:_d,defaultBase:xd}=ac;var cc={URL:Yf};const{Buffer:kr}=Un,wo=Tn,Wf=Fi.BigNumber,Lf=qf,nt=Pi,Ie=rt,zf=ic,Zf=sc,{URL:Df}=cc;let Ss=class Ns{constructor(e){e=e||{},!e.size||e.size<65536?e.size=65536:e.size=nt.nextPowerOf2(e.size),this._heap=new ArrayBuffer(e.size),this._heap8=new Uint8Array(this._heap),this._buffer=kr.from(this._heap),this._reset(),this._knownTags=Object.assign({0:r=>new Date(r),1:r=>new Date(r*1e3),2:r=>nt.arrayBufferToBignumber(r),3:r=>Ie.NEG_ONE.minus(nt.arrayBufferToBignumber(r)),4:r=>Ie.TEN.pow(r[0]).times(r[1]),5:r=>Ie.TWO.pow(r[0]).times(r[1]),32:r=>new Df(r),35:r=>new RegExp(r)},e.tags),this.parser=Lf(Xr,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var e=this._parents.pop();if(e.length>0)throw new Error(`Missing ${e.length} elements`);switch(e.type){case Ie.PARENT.TAG:this._push(this.createTag(e.ref[0],e.ref[1]));break;case Ie.PARENT.BYTE_STRING:this._push(this.createByteString(e.ref,e.length));break;case Ie.PARENT.UTF8_STRING:this._push(this.createUtf8String(e.ref,e.length));break;case Ie.PARENT.MAP:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(e.ref,e.length));break;case Ie.PARENT.OBJECT:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(e.ref,e.length));break;case Ie.PARENT.ARRAY:this._push(this.createArray(e.ref,e.length));break}this._currentParent&&this._currentParent.type===Ie.PARENT.TAG&&this._dec()}_dec(){const e=this._currentParent;e.length<0||(e.length--,e.length===0&&this._closeParent())}_push(e,r){const n=this._currentParent;switch(n.values++,n.type){case Ie.PARENT.ARRAY:case Ie.PARENT.BYTE_STRING:case Ie.PARENT.UTF8_STRING:n.length>-1?this._ref[this._ref.length-n.length]=e:this._ref.push(e),this._dec();break;case Ie.PARENT.OBJECT:n.tmpKey!=null?(this._ref[n.tmpKey]=e,n.tmpKey=null,this._dec()):(n.tmpKey=e,typeof n.tmpKey!="string"&&(n.type=Ie.PARENT.MAP,n.ref=nt.buildMap(n.ref)));break;case Ie.PARENT.MAP:n.tmpKey!=null?(this._ref.set(n.tmpKey,e),n.tmpKey=null,this._dec()):n.tmpKey=e;break;case Ie.PARENT.TAG:this._ref.push(e),r||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(e,r,n){this._parents[this._depth]={type:r,length:n,ref:e,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:Ie.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(e,r){const n=this._knownTags[e];return n?n(r):new Zf(e,r)}createMap(e,r){return e}createObject(e,r){return e}createArray(e,r){return e}createByteString(e,r){return kr.concat(e)}createByteStringFromHeap(e,r){return e===r?kr.alloc(0):kr.from(this._heap.slice(e,r))}createInt(e){return e}createInt32(e,r){return nt.buildInt32(e,r)}createInt64(e,r,n,i){return nt.buildInt64(e,r,n,i)}createFloat(e){return e}createFloatSingle(e,r,n,i){return wo.read([e,r,n,i],0,!1,23,4)}createFloatDouble(e,r,n,i,s,a,o,h){return wo.read([e,r,n,i,s,a,o,h],0,!1,52,8)}createInt32Neg(e,r){return-1-nt.buildInt32(e,r)}createInt64Neg(e,r,n,i){const s=nt.buildInt32(e,r),a=nt.buildInt32(n,i);return s>Ie.MAX_SAFE_HIGH?Ie.NEG_ONE.minus(new Wf(s).times(Ie.SHIFT32).plus(a)):-1-(s*Ie.SHIFT32+a)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(e,r){return e.join("")}createUtf8StringFromHeap(e,r){return e===r?"":this._buffer.toString("utf8",e,r)}createSimpleUnassigned(e){return new zf(e)}pushInt(e){this._push(this.createInt(e))}pushInt32(e,r){this._push(this.createInt32(e,r))}pushInt64(e,r,n,i){this._push(this.createInt64(e,r,n,i))}pushFloat(e){this._push(this.createFloat(e))}pushFloatSingle(e,r,n,i){this._push(this.createFloatSingle(e,r,n,i))}pushFloatDouble(e,r,n,i,s,a,o,h){this._push(this.createFloatDouble(e,r,n,i,s,a,o,h))}pushInt32Neg(e,r){this._push(this.createInt32Neg(e,r))}pushInt64Neg(e,r,n,i){this._push(this.createInt64Neg(e,r,n,i))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],Ie.PARENT.ARRAY,-1)}pushArrayStartFixed(e){this._createArrayStartFixed(e)}pushArrayStartFixed32(e,r){const n=nt.buildInt32(e,r);this._createArrayStartFixed(n)}pushArrayStartFixed64(e,r,n,i){const s=nt.buildInt64(e,r,n,i);this._createArrayStartFixed(s)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(e){this._createObjectStartFixed(e)}pushObjectStartFixed32(e,r){const n=nt.buildInt32(e,r);this._createObjectStartFixed(n)}pushObjectStartFixed64(e,r,n,i){const s=nt.buildInt64(e,r,n,i);this._createObjectStartFixed(s)}pushByteStringStart(){this._parents[this._depth]={type:Ie.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(e,r){this._push(this.createByteStringFromHeap(e,r))}pushUtf8StringStart(){this._parents[this._depth]={type:Ie.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(e,r){this._push(this.createUtf8StringFromHeap(e,r))}pushSimpleUnassigned(e){this._push(this.createSimpleUnassigned(e))}pushTagStart(e){this._parents[this._depth]={type:Ie.PARENT.TAG,length:1,ref:[e]}}pushTagStart4(e,r){this.pushTagStart(nt.buildInt32(e,r))}pushTagStart8(e,r,n,i){this.pushTagStart(nt.buildInt64(e,r,n,i))}pushTagUnassigned(e){this._push(this.createTag(e))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(e){if(e===0){this._push(this.createObject({}));return}this._createParent({},Ie.PARENT.OBJECT,e)}_createArrayStartFixed(e){if(e===0){this._push(this.createArray([]));return}this._createParent(new Array(e),Ie.PARENT.ARRAY,e)}_decode(e){if(e.byteLength===0)throw new Error("Input too short");this._reset(),this._heap8.set(e);const r=this.parser.parse(e.byteLength);if(this._depth>1){for(;this._currentParent.length===0;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(r>0)throw new Error("Failed to parse");if(this._res.length===0)throw new Error("No valid result")}decodeFirst(e){return this._decode(e),this._res[0]}decodeAll(e){return this._decode(e),this._res}static decode(e,r){return typeof e=="string"&&(e=kr.from(e,r||"hex")),new Ns({size:e.length}).decodeFirst(e)}static decodeAll(e,r){return typeof e=="string"&&(e=kr.from(e,r||"hex")),new Ns({size:e.length}).decodeAll(e)}};Ss.decodeFirst=Ss.decode;var uc=Ss;const{Buffer:Qi}=Un,Xf=uc,Jf=Pi;class Ls extends Xf{createTag(e,r){return`${e}(${r})`}createInt(e){return super.createInt(e).toString()}createInt32(e,r){return super.createInt32(e,r).toString()}createInt64(e,r,n,i){return super.createInt64(e,r,n,i).toString()}createInt32Neg(e,r){return super.createInt32Neg(e,r).toString()}createInt64Neg(e,r,n,i){return super.createInt64Neg(e,r,n,i).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(e){const r=super.createFloat(e);return Jf.isNegativeZero(e)?"-0_1":`${r}_1`}createFloatSingle(e,r,n,i){return`${super.createFloatSingle(e,r,n,i)}_2`}createFloatDouble(e,r,n,i,s,a,o,h){return`${super.createFloatDouble(e,r,n,i,s,a,o,h)}_3`}createByteString(e,r){const n=e.join(", ");return r===-1?`(_ ${n})`:`h'${n}`}createByteStringFromHeap(e,r){return`h'${Qi.from(super.createByteStringFromHeap(e,r)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(e){return`simple(${e})`}createArray(e,r){const n=super.createArray(e,r);return r===-1?`[_ ${n.join(", ")}]`:`[${n.join(", ")}]`}createMap(e,r){const n=super.createMap(e),i=Array.from(n.keys()).reduce(go(n),"");return r===-1?`{_ ${i}}`:`{${i}}`}createObject(e,r){const n=super.createObject(e),i=Object.keys(n).reduce(go(n),"");return r===-1?`{_ ${i}}`:`{${i}}`}createUtf8String(e,r){const n=e.join(", ");return r===-1?`(_ ${n})`:`"${n}"`}createUtf8StringFromHeap(e,r){return`"${Qi.from(super.createUtf8StringFromHeap(e,r)).toString("utf8")}"`}static diagnose(e,r){return typeof e=="string"&&(e=Qi.from(e,r||"hex")),new Ls().decodeFirst(e)}}var Qf=Ls;function go(t){return(e,r)=>e?`${e}, ${r}: ${t[r]}`:`${r}: ${t[r]}`}const{Buffer:It}=Un,{URL:el}=cc,Is=Fi.BigNumber,es=Pi,He=rt,gt=He.MT,Gn=He.NUMBYTES,mo=He.SHIFT32,bo=He.SYMS,Mr=He.TAG,tl=He.MT.SIMPLE_FLOAT<<5|He.NUMBYTES.TWO,rl=He.MT.SIMPLE_FLOAT<<5|He.NUMBYTES.FOUR,nl=He.MT.SIMPLE_FLOAT<<5|He.NUMBYTES.EIGHT,il=He.MT.SIMPLE_FLOAT<<5|He.SIMPLE.TRUE,sl=He.MT.SIMPLE_FLOAT<<5|He.SIMPLE.FALSE,ol=He.MT.SIMPLE_FLOAT<<5|He.SIMPLE.UNDEFINED,_o=He.MT.SIMPLE_FLOAT<<5|He.SIMPLE.NULL,al=new Is("0x20000000000000"),cl=It.from("f97e00","hex"),ul=It.from("f9fc00","hex"),fl=It.from("f97c00","hex");function ll(t){return{}.toString.call(t).slice(8,-1)}class wi{constructor(e){e=e||{},this.streaming=typeof e.stream=="function",this.onData=e.stream,this.semanticTypes=[[el,this._pushUrl],[Is,this._pushBigNumber]];const r=e.genTypes||[],n=r.length;for(let i=0;i<n;i++)this.addSemanticType(r[i][0],r[i][1]);this._reset()}addSemanticType(e,r){const n=this.semanticTypes.length;for(let i=0;i<n;i++)if(this.semanticTypes[i][0]===e){const a=this.semanticTypes[i][1];return this.semanticTypes[i][1]=r,a}return this.semanticTypes.push([e,r]),null}push(e){return e&&(this.result[this.offset]=e,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=e.length,this.offset++,this.streaming&&this.onData(this.finalize())),!0}pushWrite(e,r,n){return this.result[this.offset]=e,this.resultMethod[this.offset]=r,this.resultLength[this.offset]=n,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(e){return this.pushWrite(e,1,1)}_pushUInt16BE(e){return this.pushWrite(e,2,2)}_pushUInt32BE(e){return this.pushWrite(e,3,4)}_pushDoubleBE(e){return this.pushWrite(e,4,8)}_pushNaN(){return this.push(cl)}_pushInfinity(e){const r=e<0?ul:fl;return this.push(r)}_pushFloat(e){const r=It.allocUnsafe(2);if(es.writeHalf(r,e)&&es.parseHalf(r)===e)return this._pushUInt8(tl)&&this.push(r);const n=It.allocUnsafe(4);return n.writeFloatBE(e,0),n.readFloatBE(0)===e?this._pushUInt8(rl)&&this.push(n):this._pushUInt8(nl)&&this._pushDoubleBE(e)}_pushInt(e,r,n){const i=r<<5;return e<24?this._pushUInt8(i|e):e<=255?this._pushUInt8(i|Gn.ONE)&&this._pushUInt8(e):e<=65535?this._pushUInt8(i|Gn.TWO)&&this._pushUInt16BE(e):e<=4294967295?this._pushUInt8(i|Gn.FOUR)&&this._pushUInt32BE(e):e<=Number.MAX_SAFE_INTEGER?this._pushUInt8(i|Gn.EIGHT)&&this._pushUInt32BE(Math.floor(e/mo))&&this._pushUInt32BE(e%mo):r===gt.NEG_INT?this._pushFloat(n):this._pushFloat(e)}_pushIntNum(e){return e<0?this._pushInt(-e-1,gt.NEG_INT,e):this._pushInt(e,gt.POS_INT)}_pushNumber(e){switch(!1){case e===e:return this._pushNaN(e);case isFinite(e):return this._pushInfinity(e);case e%1!==0:return this._pushIntNum(e);default:return this._pushFloat(e)}}_pushString(e){const r=It.byteLength(e,"utf8");return this._pushInt(r,gt.UTF8_STRING)&&this.pushWrite(e,5,r)}_pushBoolean(e){return this._pushUInt8(e?il:sl)}_pushUndefined(e){return this._pushUInt8(ol)}_pushArray(e,r){const n=r.length;if(!e._pushInt(n,gt.ARRAY))return!1;for(let i=0;i<n;i++)if(!e.pushAny(r[i]))return!1;return!0}_pushTag(e){return this._pushInt(e,gt.TAG)}_pushDate(e,r){return e._pushTag(Mr.DATE_EPOCH)&&e.pushAny(Math.round(r/1e3))}_pushBuffer(e,r){return e._pushInt(r.length,gt.BYTE_STRING)&&e.push(r)}_pushNoFilter(e,r){return e._pushBuffer(e,r.slice())}_pushRegexp(e,r){return e._pushTag(Mr.REGEXP)&&e.pushAny(r.source)}_pushSet(e,r){if(!e._pushInt(r.size,gt.ARRAY))return!1;for(const n of r)if(!e.pushAny(n))return!1;return!0}_pushUrl(e,r){return e._pushTag(Mr.URI)&&e.pushAny(r.format())}_pushBigint(e){let r=Mr.POS_BIGINT;e.isNegative()&&(e=e.negated().minus(1),r=Mr.NEG_BIGINT);let n=e.toString(16);n.length%2&&(n="0"+n);const i=It.from(n,"hex");return this._pushTag(r)&&this._pushBuffer(this,i)}_pushBigNumber(e,r){if(r.isNaN())return e._pushNaN();if(!r.isFinite())return e._pushInfinity(r.isNegative()?-1/0:1/0);if(r.isInteger())return e._pushBigint(r);if(!(e._pushTag(Mr.DECIMAL_FRAC)&&e._pushInt(2,gt.ARRAY)))return!1;const n=r.decimalPlaces(),i=r.multipliedBy(new Is(10).pow(n));return e._pushIntNum(-n)?i.abs().isLessThan(al)?e._pushIntNum(i.toNumber()):e._pushBigint(i):!1}_pushMap(e,r){return e._pushInt(r.size,gt.MAP)?this._pushRawMap(r.size,Array.from(r)):!1}_pushObject(e){if(!e)return this._pushUInt8(_o);for(var r=this.semanticTypes.length,n=0;n<r;n++)if(e instanceof this.semanticTypes[n][0])return this.semanticTypes[n][1].call(e,this,e);var i=e.encodeCBOR;if(typeof i=="function")return i.call(e,this);var s=Object.keys(e),a=s.length;return this._pushInt(a,gt.MAP)?this._pushRawMap(a,s.map(o=>[o,e[o]])):!1}_pushRawMap(e,r){r=r.map(function(i){return i[0]=wi.encode(i[0]),i}).sort(es.keySorter);for(var n=0;n<e;n++)if(!this.push(r[n][0])||!this.pushAny(r[n][1]))return!1;return!0}write(e){return this.pushAny(e)}pushAny(e){var r=ll(e);switch(r){case"Number":return this._pushNumber(e);case"String":return this._pushString(e);case"Boolean":return this._pushBoolean(e);case"Object":return this._pushObject(e);case"Array":return this._pushArray(this,e);case"Uint8Array":return this._pushBuffer(this,It.isBuffer(e)?e:It.from(e));case"Null":return this._pushUInt8(_o);case"Undefined":return this._pushUndefined(e);case"Map":return this._pushMap(this,e);case"Set":return this._pushSet(this,e);case"URL":return this._pushUrl(this,e);case"BigNumber":return this._pushBigNumber(this,e);case"Date":return this._pushDate(this,e);case"RegExp":return this._pushRegexp(this,e);case"Symbol":switch(e){case bo.NULL:return this._pushObject(null);case bo.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+e.toString())}default:throw new Error("Unknown type: "+typeof e+", "+(e?e.toString():""))}}finalize(){if(this.offset===0)return null;for(var e=this.result,r=this.resultLength,n=this.resultMethod,i=this.offset,s=0,a=0;a<i;a++)s+=r[a];var o=It.allocUnsafe(s),h=0,w=0;for(a=0;a<i;a++){switch(w=r[a],n[a]){case 0:e[a].copy(o,h);break;case 1:o.writeUInt8(e[a],h,!0);break;case 2:o.writeUInt16BE(e[a],h,!0);break;case 3:o.writeUInt32BE(e[a],h,!0);break;case 4:o.writeDoubleBE(e[a],h,!0);break;case 5:o.write(e[a],h,w,"utf8");break;default:throw new Error("unkown method")}h+=w}var A=o;return this._reset(),A}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(e){const r=new wi;if(!r.pushAny(e))throw new Error("Failed to encode input");return r.finalize()}}var hl=wi;(function(t){t.Diagnose=Qf,t.Decoder=uc,t.Encoder=hl,t.Simple=ic,t.Tagged=sc,t.decodeAll=t.Decoder.decodeAll,t.decodeFirst=t.Decoder.decodeFirst,t.diagnose=t.Diagnose.diagnose,t.encode=t.Encoder.encode,t.decode=t.Decoder.decode,t.leveldb={decode:t.Decoder.decodeAll,encode:t.Encoder.encode,buffer:!0,name:"cbor"}})(rc);const fc=qu(rc);function xt(t){return yn(Bf.create().update(new Uint8Array(t)).digest())}function Zn(t){if(t instanceof fc.Tagged)return Zn(t.value);if(typeof t=="string")return lc(t);if(typeof t=="number")return xt(Ce(t));if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))return xt(t);if(Array.isArray(t)){const e=t.map(Zn);return xt(Et(...e))}else{if(t&&typeof t=="object"&&t._isPrincipal)return xt(t.toUint8Array());if(typeof t=="object"&&t!==null&&typeof t.toHash=="function")return Zn(t.toHash());if(typeof t=="object")return gi(t);if(typeof t=="bigint")return xt(Ce(t))}throw Object.assign(new Error(`Attempt to hash a value of unsupported type: ${t}`),{value:t})}const lc=t=>{const e=new TextEncoder().encode(t);return xt(e)};function mn(t){return gi(t)}function gi(t){const n=Object.entries(t).filter(([,a])=>a!==void 0).map(([a,o])=>{const h=lc(a),w=Zn(o);return[h,w]}).sort(([a],[o])=>ga(a,o)),i=Et(...n.map(a=>Et(...a)));return xt(i)}var dl=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};const pl=new TextEncoder().encode(`
ic-request`);class zs{getPrincipal(){return this._principal||(this._principal=be.selfAuthenticating(new Uint8Array(this.getPublicKey().toDer()))),this._principal}async transformRequest(e){const{body:r}=e,n=dl(e,["body"]),i=mn(r);return Object.assign(Object.assign({},n),{body:{content:r,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign(Et(pl,i))}})}}class mi{getPrincipal(){return be.anonymous()}async transformRequest(e){return Object.assign(Object.assign({},e),{body:{content:e.body}})}}var ct={},sn={},Ue={};Object.defineProperty(Ue,"__esModule",{value:!0});const yl=9007199254740992;function Zt(t,...e){const r=new Uint8Array(t.byteLength+e.reduce((i,s)=>i+s.byteLength,0));r.set(new Uint8Array(t),0);let n=t.byteLength;for(const i of e)r.set(new Uint8Array(i),n),n+=i.byteLength;return r.buffer}function vt(t,e,r){r=r.replace(/[^0-9a-fA-F]/g,"");const n=2**(e-24);r=r.slice(-n*2).padStart(n*2,"0");const i=[(t<<5)+e].concat(r.match(/../g).map(s=>parseInt(s,16)));return new Uint8Array(i).buffer}function ki(t,e){if(e<24)return new Uint8Array([(t<<5)+e]).buffer;{const r=e<=255?24:e<=65535?25:e<=4294967295?26:27;return vt(t,r,e.toString(16))}}function hc(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);n<128?e.push(n):n<2048?e.push(192|n>>6,128|n&63):n<55296||n>=57344?e.push(224|n>>12,128|n>>6&63,128|n&63):(r++,n=(n&1023)<<10|t.charCodeAt(r)&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63))}return Zt(new Uint8Array(ki(3,t.length)),new Uint8Array(e))}function wl(t,e){if(t==14277111)return Zt(new Uint8Array([217,217,247]),e);if(t<24)return Zt(new Uint8Array([192+t]),e);{const r=t<=255?24:t<=65535?25:t<=4294967295?26:27,n=2**(r-24),i=t.toString(16).slice(-n*2).padStart(n*2,"0"),s=[192+r].concat(i.match(/../g).map(a=>parseInt(a,16)));return new Uint8Array(s).buffer}}Ue.tagged=wl;function On(t){return new Uint8Array(t).buffer}Ue.raw=On;function Zs(t){if(isNaN(t))throw new RangeError("Invalid number.");t=Math.min(Math.max(0,t),23);const e=[0+t];return new Uint8Array(e).buffer}Ue.uSmall=Zs;function dc(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),255),t=t.toString(16),vt(0,24,t)}Ue.u8=dc;function pc(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),65535),t=t.toString(16),vt(0,25,t)}Ue.u16=pc;function yc(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),4294967295),t=t.toString(16),vt(0,26,t)}Ue.u32=yc;function Ds(t,e){if(typeof t=="string"&&e==16){if(t.match(/[^0-9a-fA-F]/))throw new RangeError("Invalid number.");return vt(0,27,t)}if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),yl),t=t.toString(16),vt(0,27,t)}Ue.u64=Ds;function wc(t){if(isNaN(t))throw new RangeError("Invalid number.");if(t===0)return Zs(0);t=Math.min(Math.max(0,-t),24)-1;const e=[32+t];return new Uint8Array(e).buffer}Ue.iSmall=wc;function gc(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,-t-1),255),t=t.toString(16),vt(1,24,t)}Ue.i8=gc;function mc(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,-t-1),65535),t=t.toString(16),vt(1,25,t)}Ue.i16=mc;function bc(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,-t-1),4294967295),t=t.toString(16),vt(1,26,t)}Ue.i32=bc;function _c(t,e){if(typeof t=="string"&&e==16){if(t.startsWith("-")?t=t.slice(1):t="0",t.match(/[^0-9a-fA-F]/)||t.length>16)throw new RangeError("Invalid number.");let r=!1,n=t.split("").reduceRight((i,s)=>{if(r)return s+i;let a=parseInt(s,16)-1;return a>=0?(r=!0,a.toString(16)+i):"f"+i},"");return r?vt(1,27,n):Ds(0)}if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,-t-1),9007199254740992),t=t.toString(16),vt(1,27,t)}Ue.i64=_c;function gl(t){return t>=0?t<24?Zs(t):t<=255?dc(t):t<=65535?pc(t):t<=4294967295?yc(t):Ds(t):t>=-24?wc(t):t>=-255?gc(t):t>=-65535?mc(t):t>=-4294967295?bc(t):_c(t)}Ue.number=gl;function ml(t){return Zt(ki(2,t.byteLength),t)}Ue.bytes=ml;function bl(t){return hc(t)}Ue.string=bl;function _l(t){return Zt(ki(4,t.length),...t)}Ue.array=_l;function xl(t,e=!1){t instanceof Map||(t=new Map(Object.entries(t)));let r=Array.from(t.entries());return e&&(r=r.sort(([n],[i])=>n.localeCompare(i))),Zt(ki(5,t.size),...r.map(([n,i])=>Zt(hc(n),i)))}Ue.map=xl;function El(t){const e=new Float32Array([t]);return Zt(new Uint8Array([250]),new Uint8Array(e.buffer))}Ue.singleFloat=El;function vl(t){const e=new Float64Array([t]);return Zt(new Uint8Array([251]),new Uint8Array(e.buffer))}Ue.doubleFloat=vl;function Bl(t){return t?xc():Ec()}Ue.bool=Bl;function xc(){return On(new Uint8Array([245]))}Ue.true_=xc;function Ec(){return On(new Uint8Array([244]))}Ue.false_=Ec;function Al(){return On(new Uint8Array([246]))}Ue.null_=Al;function Tl(){return On(new Uint8Array([247]))}Ue.undefined_=Tl;var Sl=Xr&&Xr.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(sn,"__esModule",{value:!0});const mt=Sl(Ue),Nl=[ArrayBuffer,Uint8Array,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array];class vc{constructor(e,r=!1){this._serializer=e,this._stable=r,this.name="jsonDefault",this.priority=-100}match(e){return["undefined","boolean","number","string","object"].indexOf(typeof e)!=-1}encode(e){switch(typeof e){case"undefined":return mt.undefined_();case"boolean":return mt.bool(e);case"number":return Math.floor(e)===e?mt.number(e):mt.doubleFloat(e);case"string":return mt.string(e);case"object":if(e===null)return mt.null_();if(Array.isArray(e))return mt.array(e.map(r=>this._serializer.serializeValue(r)));if(Nl.find(r=>e instanceof r))return mt.bytes(e.buffer);if(Object.getOwnPropertyNames(e).indexOf("toJSON")!==-1)return this.encode(e.toJSON());if(e instanceof Map){const r=new Map;for(const[n,i]of e.entries())r.set(n,this._serializer.serializeValue(i));return mt.map(r,this._stable)}else{const r=new Map;for(const[n,i]of Object.entries(e))r.set(n,this._serializer.serializeValue(i));return mt.map(r,this._stable)}default:throw new Error("Invalid value.")}}}sn.JsonDefaultCborEncoder=vc;class Bc{constructor(){this.name="cborEncoder",this.priority=-90}match(e){return typeof e=="object"&&typeof e.toCBOR=="function"}encode(e){return e.toCBOR()}}sn.ToCborEncoder=Bc;class Ac{constructor(){this._encoders=new Set}static withDefaultEncoders(e=!1){const r=new this;return r.addEncoder(new vc(r,e)),r.addEncoder(new Bc),r}removeEncoder(e){for(const r of this._encoders.values())r.name==e&&this._encoders.delete(r)}addEncoder(e){this._encoders.add(e)}getEncoderFor(e){let r=null;for(const n of this._encoders)(!r||n.priority>r.priority)&&n.match(e)&&(r=n);if(r===null)throw new Error("Could not find an encoder for value.");return r}serializeValue(e){return this.getEncoderFor(e).encode(e)}serialize(e){return this.serializeValue(e)}}sn.CborSerializer=Ac;class Il extends Ac{serialize(e){return mt.raw(new Uint8Array([...new Uint8Array([217,217,247]),...new Uint8Array(super.serializeValue(e))]))}}sn.SelfDescribeCborSerializer=Il;(function(t){function e(i){for(var s in i)t.hasOwnProperty(s)||(t[s]=i[s])}var r=Xr&&Xr.__importStar||function(i){if(i&&i.__esModule)return i;var s={};if(i!=null)for(var a in i)Object.hasOwnProperty.call(i,a)&&(s[a]=i[a]);return s.default=i,s};Object.defineProperty(t,"__esModule",{value:!0}),e(sn);const n=r(Ue);t.value=n})(ct);class Rl{get name(){return"Principal"}get priority(){return 0}match(e){return e&&e._isPrincipal===!0}encode(e){return ct.value.bytes(e.toUint8Array())}}class Ul{get name(){return"Buffer"}get priority(){return 1}match(e){return e instanceof ArrayBuffer||ArrayBuffer.isView(e)}encode(e){return ct.value.bytes(new Uint8Array(e))}}class Ol{get name(){return"BigInt"}get priority(){return 1}match(e){return typeof e=="bigint"}encode(e){return e>BigInt(0)?ct.value.tagged(2,ct.value.bytes(zt(e.toString(16)))):ct.value.tagged(3,ct.value.bytes(zt((BigInt("-1")*e).toString(16))))}}const Mi=ct.SelfDescribeCborSerializer.withDefaultEncoders(!0);Mi.addEncoder(new Rl);Mi.addEncoder(new Ul);Mi.addEncoder(new Ol);var Rs;(function(t){t[t.Uint64LittleEndian=71]="Uint64LittleEndian",t[t.Semantic=55799]="Semantic"})(Rs||(Rs={}));function ts(t){return Mi.serialize(t)}function xo(t){const e=t.byteLength;let r=BigInt(0);for(let n=0;n<e;n++)r=r*BigInt(256)+BigInt(t[n]);return r}class Fl extends fc.Decoder{createByteString(e){return Et(...e)}createByteStringFromHeap(e,r){return e===r?new ArrayBuffer(0):new Uint8Array(this._heap.slice(e,r))}}function Ht(t){const e=new Uint8Array(t),r=new Fl({size:e.byteLength,tags:{2:n=>xo(n),3:n=>-xo(n),[Rs.Semantic]:n=>n}});try{return r.decodeFirst(e)}catch(n){throw new Error(`Failed to decode CBOR: ${n}, input: ${ke(e)}`)}}const Kn=()=>{if(typeof window<"u"&&window.crypto&&window.crypto.getRandomValues){const t=new Uint32Array(1);return window.crypto.getRandomValues(t),t[0]}if(typeof crypto<"u"&&crypto.getRandomValues){const t=new Uint32Array(1);return crypto.getRandomValues(t),t[0]}return typeof crypto<"u"&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(Math.random()*4294967295)};var Us;(function(t){t.Call="call"})(Us||(Us={}));function Os(){const t=new ArrayBuffer(16),e=new DataView(t),r=Kn(),n=Kn(),i=Kn(),s=Kn();return e.setUint32(0,r),e.setUint32(4,n),e.setUint32(8,i),e.setUint32(12,s),t}const Eo=BigInt(1e6),Pl=60*1e3;class jn{constructor(e){if(e<90*1e3){const o=BigInt(Date.now()+e)*Eo/BigInt(1e9);this._value=o*BigInt(1e9);return}const s=BigInt(Math.floor(Date.now()+e-Pl))*Eo/BigInt(1e9)/BigInt(60)*BigInt(60)*BigInt(1e9);this._value=s}toCBOR(){return ct.value.u64(this._value.toString(16),16)}toHash(){return Ce(this._value)}}function vo(t=Os){return async e=>{const r=e.request.headers;e.request.headers=r,e.endpoint==="call"&&(e.body.nonce=t())}}function cn(t){const e=[];return t.forEach((r,n)=>{e.push([n,r])}),e}class rs extends Me{constructor(e,r){super(e),this.response=r,this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}class kl extends Me{constructor(e,r,n,i,s,a){super(e),this.response=r,this.requestId=n,this.senderPubkey=i,this.senderSig=s,this.ingressExpiry=a,this.name="AgentCallError",Object.setPrototypeOf(this,new.target.prototype)}}class Ml extends Me{constructor(e,r,n,i,s,a){super(e),this.response=r,this.requestId=n,this.senderPubkey=i,this.senderSig=s,this.ingressExpiry=a,this.name="AgentQueryError",Object.setPrototypeOf(this,new.target.prototype)}}class Cl extends Me{constructor(e,r,n,i,s,a){super(e),this.response=r,this.requestId=n,this.senderPubkey=i,this.senderSig=s,this.ingressExpiry=a,this.name="AgentReadStateError",Object.setPrototypeOf(this,new.target.prototype)}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Xs=BigInt(0),bi=BigInt(1);function bn(t,e=""){if(typeof t!="boolean"){const r=e&&`"${e}"`;throw new Error(r+"expected boolean, got type="+typeof t)}return t}function Zr(t,e,r=""){const n=Sn(t),i=t==null?void 0:t.length,s=e!==void 0;if(!n||s&&i!==e){const a=r&&`"${r}" `,o=s?` of length ${e}`:"",h=n?`length=${i}`:`type=${typeof t}`;throw new Error(a+"expected Uint8Array"+o+", got "+h)}return t}function Tc(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Xs:BigInt("0x"+t)}function Ft(t){return Tc(Qr(t))}function _n(t){return pt(t),Tc(Qr(Uint8Array.from(t).reverse()))}function Ze(t,e){return fa(t.toString(16).padStart(e*2,"0"))}function Sc(t,e){return Ze(t,e).reverse()}function at(t,e,r){let n;if(typeof e=="string")try{n=fa(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(Sn(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function Bo(t){return Uint8Array.from(t)}const ns=t=>typeof t=="bigint"&&Xs<=t;function Nc(t,e,r){return ns(t)&&ns(e)&&ns(r)&&e<=t&&t<r}function Ao(t,e,r,n){if(!Nc(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function xn(t){let e;for(e=0;t>Xs;t>>=bi,e+=1);return e}function $l(t,e){return t>>BigInt(e)&bi}const Ir=t=>(bi<<BigInt(t))-bi;function ql(t){return typeof t=="function"&&Number.isSafeInteger(t.outputLen)}function Fn(t,e,r={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function n(i,s,a){const o=t[i];if(a&&o===void 0)return;const h=typeof o;if(h!==s||o===null)throw new Error(`param "${i}" is invalid: expected ${s}, got ${h}`)}Object.entries(e).forEach(([i,s])=>n(i,s,!1)),Object.entries(r).forEach(([i,s])=>n(i,s,!0))}const Ic=()=>{throw new Error("not implemented")};function En(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(i!==void 0)return i;const s=t(r,...n);return e.set(r,s),s}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ut=BigInt(0),De=BigInt(1),br=BigInt(2),Rc=BigInt(3),Uc=BigInt(4),Oc=BigInt(5),Vl=BigInt(7),Fc=BigInt(8),Gl=BigInt(9),Pc=BigInt(16);function $e(t,e){const r=t%e;return r>=ut?r:e+r}function At(t,e,r){let n=t;for(;e-- >ut;)n*=n,n%=r;return n}function To(t,e){if(t===ut)throw new Error("invert: expected non-zero number");if(e<=ut)throw new Error("invert: expected positive modulus, got "+e);let r=$e(t,e),n=e,i=ut,s=De;for(;r!==ut;){const o=n/r,h=n%r,w=i-s*o;n=r,r=h,i=s,s=w}if(n!==De)throw new Error("invert: does not exist");return $e(i,e)}function Js(t,e,r){if(!t.eql(t.sqr(e),r))throw new Error("Cannot find square root")}function kc(t,e){const r=(t.ORDER+De)/Uc,n=t.pow(e,r);return Js(t,n,e),n}function Kl(t,e){const r=(t.ORDER-Oc)/Fc,n=t.mul(e,br),i=t.pow(n,r),s=t.mul(e,i),a=t.mul(t.mul(s,br),i),o=t.mul(s,t.sub(a,t.ONE));return Js(t,o,e),o}function jl(t){const e=hr(t),r=Mc(t),n=r(e,e.neg(e.ONE)),i=r(e,n),s=r(e,e.neg(n)),a=(t+Vl)/Pc;return(o,h)=>{let w=o.pow(h,a),A=o.mul(w,n);const _=o.mul(w,i),m=o.mul(w,s),E=o.eql(o.sqr(A),h),T=o.eql(o.sqr(_),h);w=o.cmov(w,A,E),A=o.cmov(m,_,T);const O=o.eql(o.sqr(A),h),Y=o.cmov(w,A,O);return Js(o,Y,h),Y}}function Mc(t){if(t<Rc)throw new Error("sqrt is not defined for small field");let e=t-De,r=0;for(;e%br===ut;)e/=br,r++;let n=br;const i=hr(t);for(;_i(i,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return kc;let s=i.pow(n,e);const a=(e+De)/br;return function(h,w){if(h.is0(w))return w;if(_i(h,w)!==1)throw new Error("Cannot find square root");let A=r,_=h.mul(h.ONE,s),m=h.pow(w,e),E=h.pow(w,a);for(;!h.eql(m,h.ONE);){if(h.is0(m))return h.ZERO;let T=1,O=h.sqr(m);for(;!h.eql(O,h.ONE);)if(T++,O=h.sqr(O),T===A)throw new Error("Cannot find square root");const Y=De<<BigInt(A-T-1),C=h.pow(_,Y);A=T,_=h.sqr(C),m=h.mul(m,_),E=h.mul(E,C)}return E}}function Hl(t){return t%Uc===Rc?kc:t%Fc===Oc?Kl:t%Pc===Gl?jl(t):Mc(t)}const Yl=(t,e)=>($e(t,e)&De)===De,Wl=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Cc(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},r=Wl.reduce((n,i)=>(n[i]="function",n),e);return Fn(t,r),t}function Ci(t,e,r){if(r<ut)throw new Error("invalid exponent, negatives unsupported");if(r===ut)return t.ONE;if(r===De)return e;let n=t.ONE,i=e;for(;r>ut;)r&De&&(n=t.mul(n,i)),i=t.sqr(i),r>>=De;return n}function Rr(t,e,r=!1){const n=new Array(e.length).fill(r?t.ZERO:void 0),i=e.reduce((a,o,h)=>t.is0(o)?a:(n[h]=a,t.mul(a,o)),t.ONE),s=t.inv(i);return e.reduceRight((a,o,h)=>t.is0(o)?a:(n[h]=t.mul(a,n[h]),t.mul(a,o)),s),n}function _i(t,e){const r=(t.ORDER-De)/br,n=t.pow(e,r),i=t.eql(n,t.ONE),s=t.eql(n,t.ZERO),a=t.eql(n,t.neg(t.ONE));if(!i&&!s&&!a)throw new Error("invalid Legendre symbol result");return i?1:s?0:-1}function Ll(t,e){e!==void 0&&tf(e);const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function hr(t,e,r=!1,n={}){if(t<=ut)throw new Error("invalid field: expected ORDER > 0, got "+t);let i,s,a=!1,o;if(typeof e=="object"&&e!=null){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");const m=e;m.BITS&&(i=m.BITS),m.sqrt&&(s=m.sqrt),typeof m.isLE=="boolean"&&(r=m.isLE),typeof m.modFromBytes=="boolean"&&(a=m.modFromBytes),o=m.allowedLengths}else typeof e=="number"&&(i=e),n.sqrt&&(s=n.sqrt);const{nBitLength:h,nByteLength:w}=Ll(t,i);if(w>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let A;const _=Object.freeze({ORDER:t,isLE:r,BITS:h,BYTES:w,MASK:Ir(h),ZERO:ut,ONE:De,allowedLengths:o,create:m=>$e(m,t),isValid:m=>{if(typeof m!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof m);return ut<=m&&m<t},is0:m=>m===ut,isValidNot0:m=>!_.is0(m)&&_.isValid(m),isOdd:m=>(m&De)===De,neg:m=>$e(-m,t),eql:(m,E)=>m===E,sqr:m=>$e(m*m,t),add:(m,E)=>$e(m+E,t),sub:(m,E)=>$e(m-E,t),mul:(m,E)=>$e(m*E,t),pow:(m,E)=>Ci(_,m,E),div:(m,E)=>$e(m*To(E,t),t),sqrN:m=>m*m,addN:(m,E)=>m+E,subN:(m,E)=>m-E,mulN:(m,E)=>m*E,inv:m=>To(m,t),sqrt:s||(m=>(A||(A=Hl(t)),A(_,m))),toBytes:m=>r?Sc(m,w):Ze(m,w),fromBytes:(m,E=!0)=>{if(o){if(!o.includes(m.length)||m.length>w)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+m.length);const O=new Uint8Array(w);O.set(m,r?0:O.length-m.length),m=O}if(m.length!==w)throw new Error("Field.fromBytes: expected "+w+" bytes, got "+m.length);let T=r?_n(m):Ft(m);if(a&&(T=$e(T,t)),!E&&!_.isValid(T))throw new Error("invalid field element: outside of range 0..ORDER");return T},invertBatch:m=>Rr(_,m),cmov:(m,E,T)=>T?E:m});return Object.freeze(_)}function $c(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function qc(t){const e=$c(t);return e+Math.ceil(e/2)}function zl(t,e,r=!1){const n=t.length,i=$c(e),s=qc(e);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);const a=r?_n(t):Ft(t),o=$e(a,e-De)+De;return r?Sc(o,i):Ze(o,i)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const tn=BigInt(0),_r=BigInt(1);function xi(t,e){const r=e.negate();return t?r:e}function Yt(t,e){const r=Rr(t.Fp,e.map(n=>n.Z));return e.map((n,i)=>t.fromAffine(n.toAffine(r[i])))}function Vc(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function is(t,e){Vc(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1),i=2**t,s=Ir(t),a=BigInt(t);return{windows:r,windowSize:n,mask:s,maxNumber:i,shiftBy:a}}function So(t,e,r){const{windowSize:n,mask:i,maxNumber:s,shiftBy:a}=r;let o=Number(t&i),h=t>>a;o>n&&(o-=s,h+=_r);const w=e*n,A=w+Math.abs(o)-1,_=o===0,m=o<0,E=e%2!==0;return{nextN:h,offset:A,isZero:_,isNeg:m,isNegF:E,offsetF:w}}function Zl(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function Dl(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const ss=new WeakMap,Gc=new WeakMap;function os(t){return Gc.get(t)||1}function No(t){if(t!==tn)throw new Error("invalid wNAF")}class Kc{constructor(e,r){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=r}_unsafeLadder(e,r,n=this.ZERO){let i=e;for(;r>tn;)r&_r&&(n=n.add(i)),i=i.double(),r>>=_r;return n}precomputeWindow(e,r){const{windows:n,windowSize:i}=is(r,this.bits),s=[];let a=e,o=a;for(let h=0;h<n;h++){o=a,s.push(o);for(let w=1;w<i;w++)o=o.add(a),s.push(o);a=o.double()}return s}wNAF(e,r,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let i=this.ZERO,s=this.BASE;const a=is(e,this.bits);for(let o=0;o<a.windows;o++){const{nextN:h,offset:w,isZero:A,isNeg:_,isNegF:m,offsetF:E}=So(n,o,a);n=h,A?s=s.add(xi(m,r[E])):i=i.add(xi(_,r[w]))}return No(n),{p:i,f:s}}wNAFUnsafe(e,r,n,i=this.ZERO){const s=is(e,this.bits);for(let a=0;a<s.windows&&n!==tn;a++){const{nextN:o,offset:h,isZero:w,isNeg:A}=So(n,a,s);if(n=o,!w){const _=r[h];i=i.add(A?_.negate():_)}}return No(n),i}getPrecomputes(e,r,n){let i=ss.get(r);return i||(i=this.precomputeWindow(r,e),e!==1&&(typeof n=="function"&&(i=n(i)),ss.set(r,i))),i}cached(e,r,n){const i=os(e);return this.wNAF(i,this.getPrecomputes(i,e,n),r)}unsafe(e,r,n,i){const s=os(e);return s===1?this._unsafeLadder(e,r,i):this.wNAFUnsafe(s,this.getPrecomputes(s,e,n),r,i)}createCache(e,r){Vc(r,this.bits),Gc.set(e,r),ss.delete(e)}hasCache(e){return os(e)!==1}}function Xl(t,e,r,n){let i=e,s=t.ZERO,a=t.ZERO;for(;r>tn||n>tn;)r&_r&&(s=s.add(i)),n&_r&&(a=a.add(i)),i=i.double(),r>>=_r,n>>=_r;return{p1:s,p2:a}}function jc(t,e,r,n){Zl(r,t),Dl(n,e);const i=r.length,s=n.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");const a=t.ZERO,o=xn(BigInt(i));let h=1;o>12?h=o-3:o>4?h=o-2:o>0&&(h=2);const w=Ir(h),A=new Array(Number(w)+1).fill(a),_=Math.floor((e.BITS-1)/h)*h;let m=a;for(let E=_;E>=0;E-=h){A.fill(a);for(let O=0;O<s;O++){const Y=n[O],C=Number(Y>>BigInt(E)&w);A[C]=A[C].add(r[O])}let T=a;for(let O=A.length-1,Y=a;O>0;O--)Y=Y.add(A[O]),T=T.add(Y);if(m=m.add(T),E!==0)for(let O=0;O<h;O++)m=m.double()}return m}function Io(t,e,r){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Cc(e),e}else return hr(t,{isLE:r})}function Hc(t,e,r={},n){if(n===void 0&&(n=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const h of["p","n","h"]){const w=e[h];if(!(typeof w=="bigint"&&w>tn))throw new Error(`CURVE.${h} must be positive bigint`)}const i=Io(e.p,r.Fp,n),s=Io(e.n,r.Fn,n),o=["Gx","Gy","a",t==="weierstrass"?"b":"d"];for(const h of o)if(!i.isValid(e[h]))throw new Error(`CURVE.${h} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:i,Fn:s}}const Jl=Ft;function sr(t,e){if(vn(t),vn(e),t<0||t>=1<<8*e)throw new Error("invalid I2OSP input: "+t);const r=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)r[n]=t&255,t>>>=8;return new Uint8Array(r)}function Ql(t,e){const r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}function vn(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function Yc(t){if(!Sn(t)&&typeof t!="string")throw new Error("DST must be Uint8Array or string");return typeof t=="string"?Nn(t):t}function e0(t,e,r,n){pt(t),vn(r),e=Yc(e),e.length>255&&(e=n(qe(Nn("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:s}=n,a=Math.ceil(r/i);if(r>65535||a>255)throw new Error("expand_message_xmd: invalid lenInBytes");const o=qe(e,sr(e.length,1)),h=sr(0,s),w=sr(r,2),A=new Array(a),_=n(qe(h,t,w,sr(0,1),o));A[0]=n(qe(_,sr(1,1),o));for(let E=1;E<=a;E++){const T=[Ql(_,A[E-1]),sr(E+1,1),o];A[E]=n(qe(...T))}return qe(...A).slice(0,r)}function t0(t,e,r,n,i){if(pt(t),vn(r),e=Yc(e),e.length>255){const s=Math.ceil(2*n/8);e=i.create({dkLen:s}).update(Nn("H2C-OVERSIZE-DST-")).update(e).digest()}if(r>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(t).update(sr(r,2)).update(e).update(sr(e.length,1)).digest()}function as(t,e,r){Fn(r,{p:"bigint",m:"number",k:"number",hash:"function"});const{p:n,k:i,m:s,hash:a,expand:o,DST:h}=r;if(!ql(r.hash))throw new Error("expected valid hash");pt(t),vn(e);const w=n.toString(2).length,A=Math.ceil((w+i)/8),_=e*s*A;let m;if(o==="xmd")m=e0(t,h,_,a);else if(o==="xof")m=t0(t,h,_,i,a);else if(o==="_internal_pass")m=t;else throw new Error('expand must be "xmd" or "xof"');const E=new Array(e);for(let T=0;T<e;T++){const O=new Array(s);for(let Y=0;Y<s;Y++){const C=A*(Y+T*s),G=m.subarray(C,C+A);O[Y]=$e(Jl(G),n)}E[T]=O}return E}function Wc(t,e){const r=e.map(n=>Array.from(n).reverse());return(n,i)=>{const[s,a,o,h]=r.map(_=>_.reduce((m,E)=>t.add(t.mul(m,n),E))),[w,A]=Rr(t,[a,h],!0);return n=t.mul(s,w),i=t.mul(i,t.mul(o,A)),{x:n,y:i}}}const r0=Nn("HashToScalar-");function Ro(t,e,r){if(typeof e!="function")throw new Error("mapToCurve() must be defined");function n(s){return t.fromAffine(e(s))}function i(s){const a=s.clearCofactor();return a.equals(t.ZERO)?t.ZERO:(a.assertValidity(),a)}return{defaults:r,hashToCurve(s,a){const o=Object.assign({},r,a),h=as(s,2,o),w=n(h[0]),A=n(h[1]);return i(w.add(A))},encodeToCurve(s,a){const o=r.encodeDST?{DST:r.encodeDST}:{},h=Object.assign({},r,o,a),w=as(s,1,h),A=n(w[0]);return i(A)},mapToCurve(s){if(!Array.isArray(s))throw new Error("expected array of bigints");for(const a of s)if(typeof a!="bigint")throw new Error("expected array of bigints");return i(n(s))},hashToScalar(s,a){const o=t.Fn.ORDER,h=Object.assign({},r,{p:o,m:1,DST:r0},a);return as(s,1,h)[0][0]}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Uo=(t,e)=>(t+(t>=0?e:-e)/Mt)/e;function n0(t,e,r){const[[n,i],[s,a]]=e,o=Uo(a*t,r),h=Uo(-i*t,r);let w=t-o*n-h*s,A=-o*i-h*a;const _=w<xr,m=A<xr;_&&(w=-w),m&&(A=-A);const E=Ir(Math.ceil(xn(r)/2))+st;if(w<xr||w>=E||A<xr||A>=E)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:_,k1:w,k2neg:m,k2:A}}const xr=BigInt(0),st=BigInt(1),Mt=BigInt(2),Wr=BigInt(3),Fs=BigInt(4);function Ei(t,e){const{BYTES:r}=t;let n;if(typeof e=="bigint")n=e;else{let i=at("private key",e);try{n=t.fromBytes(i)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof e}`)}}if(!t.isValidNot0(n))throw new Error("invalid private key: out of range [1..N-1]");return n}function i0(t,e={}){const r=Hc("weierstrass",t,e),{Fp:n,Fn:i}=r;let s=r.CURVE;const{h:a,n:o}=s;Fn(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:h}=e;if(h&&(!n.is0(s.a)||typeof h.beta!="bigint"||!Array.isArray(h.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const w=a0(n,i);function A(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function _(X,q,Z){const{x:Q,y:ue}=q.toAffine(),le=n.toBytes(Q);if(bn(Z,"isCompressed"),Z){A();const J=!n.isOdd(ue);return qe(s0(J),le)}else return qe(Uint8Array.of(4),le,n.toBytes(ue))}function m(X){Zr(X,void 0,"Point");const{publicKey:q,publicKeyUncompressed:Z}=w,Q=X.length,ue=X[0],le=X.subarray(1);if(Q===q&&(ue===2||ue===3)){const J=n.fromBytes(le);if(!n.isValid(J))throw new Error("bad point: is not on curve, wrong x");const se=O(J);let oe;try{oe=n.sqrt(se)}catch(Te){const x=Te instanceof Error?": "+Te.message:"";throw new Error("bad point: is not on curve, sqrt error"+x)}A();const re=n.isOdd(oe);return(ue&1)===1!==re&&(oe=n.neg(oe)),{x:J,y:oe}}else if(Q===Z&&ue===4){const J=n.BYTES,se=n.fromBytes(le.subarray(0,J)),oe=n.fromBytes(le.subarray(J,J*2));if(!Y(se,oe))throw new Error("bad point: is not on curve");return{x:se,y:oe}}else throw new Error(`bad point: got length ${Q}, expected compressed=${q} or uncompressed=${Z}`)}const E=e.toBytes||_,T=e.fromBytes||m;function O(X){const q=n.sqr(X),Z=n.mul(q,X);return n.add(n.add(Z,n.mul(X,s.a)),s.b)}function Y(X,q){const Z=n.sqr(q),Q=O(X);return n.eql(Z,Q)}if(!Y(s.Gx,s.Gy))throw new Error("bad curve params: generator point");const C=n.mul(n.pow(s.a,Wr),Fs),G=n.mul(n.sqr(s.b),BigInt(27));if(n.is0(n.add(C,G)))throw new Error("bad curve params: a or b");function F(X,q,Z=!1){if(!n.isValid(q)||Z&&n.is0(q))throw new Error(`bad point coordinate ${X}`);return q}function z(X){if(!(X instanceof $))throw new Error("ProjectivePoint expected")}function L(X){if(!h||!h.basises)throw new Error("no endo");return n0(X,h.basises,i.ORDER)}const j=En((X,q)=>{const{X:Z,Y:Q,Z:ue}=X;if(n.eql(ue,n.ONE))return{x:Z,y:Q};const le=X.is0();q==null&&(q=le?n.ONE:n.inv(ue));const J=n.mul(Z,q),se=n.mul(Q,q),oe=n.mul(ue,q);if(le)return{x:n.ZERO,y:n.ZERO};if(!n.eql(oe,n.ONE))throw new Error("invZ was invalid");return{x:J,y:se}}),W=En(X=>{if(X.is0()){if(e.allowInfinityPoint&&!n.is0(X.Y))return;throw new Error("bad point: ZERO")}const{x:q,y:Z}=X.toAffine();if(!n.isValid(q)||!n.isValid(Z))throw new Error("bad point: x or y not field elements");if(!Y(q,Z))throw new Error("bad point: equation left != right");if(!X.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function D(X,q,Z,Q,ue){return Z=new $(n.mul(Z.X,X),Z.Y,Z.Z),q=xi(Q,q),Z=xi(ue,Z),q.add(Z)}class ${constructor(q,Z,Q){this.X=F("x",q),this.Y=F("y",Z,!0),this.Z=F("z",Q),Object.freeze(this)}static CURVE(){return s}static fromAffine(q){const{x:Z,y:Q}=q||{};if(!q||!n.isValid(Z)||!n.isValid(Q))throw new Error("invalid affine point");if(q instanceof $)throw new Error("projective point not allowed");return n.is0(Z)&&n.is0(Q)?$.ZERO:new $(Z,Q,n.ONE)}static fromBytes(q){const Z=$.fromAffine(T(Zr(q,void 0,"point")));return Z.assertValidity(),Z}static fromHex(q){return $.fromBytes(at("pointHex",q))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(q=8,Z=!0){return te.createCache(this,q),Z||this.multiply(Wr),this}assertValidity(){W(this)}hasEvenY(){const{y:q}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(q)}equals(q){z(q);const{X:Z,Y:Q,Z:ue}=this,{X:le,Y:J,Z:se}=q,oe=n.eql(n.mul(Z,se),n.mul(le,ue)),re=n.eql(n.mul(Q,se),n.mul(J,ue));return oe&&re}negate(){return new $(this.X,n.neg(this.Y),this.Z)}double(){const{a:q,b:Z}=s,Q=n.mul(Z,Wr),{X:ue,Y:le,Z:J}=this;let se=n.ZERO,oe=n.ZERO,re=n.ZERO,ne=n.mul(ue,ue),Te=n.mul(le,le),x=n.mul(J,J),me=n.mul(ue,le);return me=n.add(me,me),re=n.mul(ue,J),re=n.add(re,re),se=n.mul(q,re),oe=n.mul(Q,x),oe=n.add(se,oe),se=n.sub(Te,oe),oe=n.add(Te,oe),oe=n.mul(se,oe),se=n.mul(me,se),re=n.mul(Q,re),x=n.mul(q,x),me=n.sub(ne,x),me=n.mul(q,me),me=n.add(me,re),re=n.add(ne,ne),ne=n.add(re,ne),ne=n.add(ne,x),ne=n.mul(ne,me),oe=n.add(oe,ne),x=n.mul(le,J),x=n.add(x,x),ne=n.mul(x,me),se=n.sub(se,ne),re=n.mul(x,Te),re=n.add(re,re),re=n.add(re,re),new $(se,oe,re)}add(q){z(q);const{X:Z,Y:Q,Z:ue}=this,{X:le,Y:J,Z:se}=q;let oe=n.ZERO,re=n.ZERO,ne=n.ZERO;const Te=s.a,x=n.mul(s.b,Wr);let me=n.mul(Z,le),Fe=n.mul(Q,J),Pe=n.mul(ue,se),ae=n.add(Z,Q),ce=n.add(le,J);ae=n.mul(ae,ce),ce=n.add(me,Fe),ae=n.sub(ae,ce),ce=n.add(Z,ue);let b=n.add(le,se);return ce=n.mul(ce,b),b=n.add(me,Pe),ce=n.sub(ce,b),b=n.add(Q,ue),oe=n.add(J,se),b=n.mul(b,oe),oe=n.add(Fe,Pe),b=n.sub(b,oe),ne=n.mul(Te,ce),oe=n.mul(x,Pe),ne=n.add(oe,ne),oe=n.sub(Fe,ne),ne=n.add(Fe,ne),re=n.mul(oe,ne),Fe=n.add(me,me),Fe=n.add(Fe,me),Pe=n.mul(Te,Pe),ce=n.mul(x,ce),Fe=n.add(Fe,Pe),Pe=n.sub(me,Pe),Pe=n.mul(Te,Pe),ce=n.add(ce,Pe),me=n.mul(Fe,ce),re=n.add(re,me),me=n.mul(b,ce),oe=n.mul(ae,oe),oe=n.sub(oe,me),me=n.mul(ae,Fe),ne=n.mul(b,ne),ne=n.add(ne,me),new $(oe,re,ne)}subtract(q){return this.add(q.negate())}is0(){return this.equals($.ZERO)}multiply(q){const{endo:Z}=e;if(!i.isValidNot0(q))throw new Error("invalid scalar: out of range");let Q,ue;const le=J=>te.cached(this,J,se=>Yt($,se));if(Z){const{k1neg:J,k1:se,k2neg:oe,k2:re}=L(q),{p:ne,f:Te}=le(se),{p:x,f:me}=le(re);ue=Te.add(me),Q=D(Z.beta,ne,x,J,oe)}else{const{p:J,f:se}=le(q);Q=J,ue=se}return Yt($,[Q,ue])[0]}multiplyUnsafe(q){const{endo:Z}=e,Q=this;if(!i.isValid(q))throw new Error("invalid scalar: out of range");if(q===xr||Q.is0())return $.ZERO;if(q===st)return Q;if(te.hasCache(this))return this.multiply(q);if(Z){const{k1neg:ue,k1:le,k2neg:J,k2:se}=L(q),{p1:oe,p2:re}=Xl($,Q,le,se);return D(Z.beta,oe,re,ue,J)}else return te.unsafe(Q,q)}multiplyAndAddUnsafe(q,Z,Q){const ue=this.multiplyUnsafe(Z).add(q.multiplyUnsafe(Q));return ue.is0()?void 0:ue}toAffine(q){return j(this,q)}isTorsionFree(){const{isTorsionFree:q}=e;return a===st?!0:q?q($,this):te.unsafe(this,o).is0()}clearCofactor(){const{clearCofactor:q}=e;return a===st?this:q?q($,this):this.multiplyUnsafe(a)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}toBytes(q=!0){return bn(q,"isCompressed"),this.assertValidity(),E($,this,q)}toHex(q=!0){return Qr(this.toBytes(q))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(q=!0){return this.toBytes(q)}_setWindowSize(q){this.precompute(q)}static normalizeZ(q){return Yt($,q)}static msm(q,Z){return jc($,i,q,Z)}static fromPrivateKey(q){return $.BASE.multiply(Ei(i,q))}}$.BASE=new $(s.Gx,s.Gy,n.ONE),$.ZERO=new $(n.ZERO,n.ONE,n.ZERO),$.Fp=n,$.Fn=i;const k=i.BITS,te=new Kc($,e.endo?Math.ceil(k/2):k);return $.BASE.precompute(8),$}function s0(t){return Uint8Array.of(t?2:3)}function o0(t,e){const r=t.ORDER;let n=xr;for(let T=r-st;T%Mt===xr;T/=Mt)n+=st;const i=n,s=Mt<<i-st-st,a=s*Mt,o=(r-st)/a,h=(o-st)/Mt,w=a-st,A=s,_=t.pow(e,o),m=t.pow(e,(o+st)/Mt);let E=(T,O)=>{let Y=_,C=t.pow(O,w),G=t.sqr(C);G=t.mul(G,O);let F=t.mul(T,G);F=t.pow(F,h),F=t.mul(F,C),C=t.mul(F,O),G=t.mul(F,T);let z=t.mul(G,C);F=t.pow(z,A);let L=t.eql(F,t.ONE);C=t.mul(G,m),F=t.mul(z,Y),G=t.cmov(C,G,L),z=t.cmov(F,z,L);for(let j=i;j>st;j--){let W=j-Mt;W=Mt<<W-st;let D=t.pow(z,W);const $=t.eql(D,t.ONE);C=t.mul(G,Y),Y=t.mul(Y,Y),D=t.mul(z,Y),G=t.cmov(C,G,$),z=t.cmov(D,z,$)}return{isValid:L,value:G}};if(t.ORDER%Fs===Wr){const T=(t.ORDER-Wr)/Fs,O=t.sqrt(t.neg(e));E=(Y,C)=>{let G=t.sqr(C);const F=t.mul(Y,C);G=t.mul(G,F);let z=t.pow(G,T);z=t.mul(z,F);const L=t.mul(z,O),j=t.mul(t.sqr(z),C),W=t.eql(j,Y);let D=t.cmov(L,z,W);return{isValid:W,value:D}}}return E}function Lc(t,e){Cc(t);const{A:r,B:n,Z:i}=e;if(!t.isValid(r)||!t.isValid(n)||!t.isValid(i))throw new Error("mapToCurveSimpleSWU: invalid opts");const s=o0(t,i);if(!t.isOdd)throw new Error("Field does not have .isOdd()");return a=>{let o,h,w,A,_,m,E,T;o=t.sqr(a),o=t.mul(o,i),h=t.sqr(o),h=t.add(h,o),w=t.add(h,t.ONE),w=t.mul(w,n),A=t.cmov(i,t.neg(h),!t.eql(h,t.ZERO)),A=t.mul(A,r),h=t.sqr(w),m=t.sqr(A),_=t.mul(m,r),h=t.add(h,_),h=t.mul(h,w),m=t.mul(m,A),_=t.mul(m,n),h=t.add(h,_),E=t.mul(o,w);const{isValid:O,value:Y}=s(h,m);T=t.mul(o,a),T=t.mul(T,Y),E=t.cmov(E,w,O),T=t.cmov(T,Y,O);const C=t.isOdd(a)===t.isOdd(T);T=t.cmov(t.neg(T),T,C);const G=Rr(t,[A],!0)[0];return E=t.mul(E,G),{x:E,y:T}}}function a0(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function Oo(t){const{CURVE:e,curveOpts:r}=c0(t),n=i0(e,r);return f0(t,n)}function c0(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r=t.Fp;let n=t.allowedPrivateKeyLengths?Array.from(new Set(t.allowedPrivateKeyLengths.map(a=>Math.ceil(a/2)))):void 0;const i=hr(e.n,{BITS:t.nBitLength,allowedLengths:n,modFromBytes:t.wrapPrivateKey}),s={Fp:r,Fn:i,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:s}}function u0(t,e,r){function n(i){const s=t.sqr(i),a=t.mul(s,i);return t.add(t.add(a,t.mul(i,e)),r)}return n}function f0(t,e){const{Fp:r,Fn:n}=e;function i(a){return Nc(a,st,n.ORDER)}const s=u0(r,t.a,t.b);return Object.assign({},{CURVE:t,Point:e,ProjectivePoint:e,normPrivateKeyToScalar:a=>Ei(n,a),weierstrassEquation:s,isWithinCurveOrder:i})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const l0=BigInt(0),Hn=BigInt(1),Fo=BigInt(2),Lr=BigInt(3);function h0(t){const e=[];for(;t>Hn;t>>=Hn)(t&Hn)===l0?e.unshift(0):(t&Lr)===Lr?(e.unshift(-1),t+=Hn):e.unshift(1);return e}function cs(t){if(!Array.isArray(t)||t.length===0)throw new Error("expected non-empty array")}function d0(t,e,r,n){const{Fp2:i,Fp12:s}=t,{twistType:a,ateLoopSize:o,xNegative:h,postPrecompute:w}=n;let A;if(a==="multiplicative")A=(F,z,L,j,W,D)=>s.mul014(j,F,i.mul(z,W),i.mul(L,D));else if(a==="divisive")A=(F,z,L,j,W,D)=>s.mul034(j,i.mul(L,D),i.mul(z,W),F);else throw new Error("bls: unknown twist type");const _=i.div(i.ONE,i.mul(i.ONE,Fo));function m(F,z,L,j){const W=i.sqr(L),D=i.sqr(j),$=i.mulByB(i.mul(D,Lr)),k=i.mul($,Lr),te=i.sub(i.sub(i.sqr(i.add(L,j)),D),W),X=i.sub($,W),q=i.mul(i.sqr(z),Lr),Z=i.neg(te);return F.push([X,q,Z]),z=i.mul(i.mul(i.mul(i.sub(W,k),z),L),_),L=i.sub(i.sqr(i.mul(i.add(W,k),_)),i.mul(i.sqr($),Lr)),j=i.mul(W,te),{Rx:z,Ry:L,Rz:j}}function E(F,z,L,j,W,D){const $=i.sub(L,i.mul(D,j)),k=i.sub(z,i.mul(W,j)),te=i.sub(i.mul($,W),i.mul(k,D)),X=i.neg($),q=k;F.push([te,X,q]);const Z=i.sqr(k),Q=i.mul(Z,k),ue=i.mul(Z,z),le=i.add(i.sub(Q,i.mul(ue,Fo)),i.mul(i.sqr($),j));return z=i.mul(k,le),L=i.sub(i.mul(i.sub(ue,le),$),i.mul(Q,L)),j=i.mul(j,Q),{Rx:z,Ry:L,Rz:j}}const T=h0(o),O=En(F=>{const z=F,{x:L,y:j}=z.toAffine(),W=L,D=j,$=i.neg(j);let k=W,te=D,X=i.ONE;const q=[];for(const Z of T){const Q=[];({Rx:k,Ry:te,Rz:X}=m(Q,k,te,X)),Z&&({Rx:k,Ry:te,Rz:X}=E(Q,k,te,X,W,Z===-1?$:D)),q.push(Q)}if(w){const Z=q[q.length-1];w(k,te,X,W,D,E.bind(null,Z))}return q});function Y(F,z=!1){let L=s.ONE;if(F.length){const j=F[0][0].length;for(let W=0;W<j;W++){L=s.sqr(L);for(const[D,$,k]of F)for(const[te,X,q]of D[W])L=A(te,X,q,L,$,k)}}return h&&(L=s.conjugate(L)),z?s.finalExponentiate(L):L}function C(F,z=!0){const L=[];Yt(e,F.map(({g1:j})=>j)),Yt(r,F.map(({g2:j})=>j));for(const{g1:j,g2:W}of F){if(j.is0()||W.is0())throw new Error("pairing is not available for ZERO point");j.assertValidity(),W.assertValidity();const D=j.toAffine();L.push([O(W),D.x,D.y])}return Y(L,z)}function G(F,z,L=!0){return C([{g1:F,g2:z}],L)}return{Fp12:s,millerLoopBatch:Y,pairing:G,pairingBatch:C,calcPairingPrecomputes:O}}function Po(t,e,r,n,i){const{Fp12:s,pairingBatch:a}=t;function o(_){return _ instanceof e.Point?_:e.Point.fromHex(_)}function h(_){return _ instanceof r.Point?_:r.Point.fromHex(_)}function w(_){if(!(_ instanceof r.Point))throw new Error(`expected valid message hashed to ${i?"G1":"G2"} curve`);return _}const A=i?(_,m)=>({g1:m,g2:_}):(_,m)=>({g1:_,g2:m});return{getPublicKey(_){const m=Ei(e.Point.Fn,_);return e.Point.BASE.multiply(m)},sign(_,m,E){if(E!=null)throw new Error("sign() expects 2 arguments");const T=Ei(e.Point.Fn,m);return w(_).assertValidity(),_.multiply(T)},verify(_,m,E,T){if(T!=null)throw new Error("verify() expects 3 arguments");_=h(_),E=o(E);const O=E.negate(),Y=e.Point.BASE,C=w(m),G=_,F=a([A(O,C),A(Y,G)]);return s.eql(F,s.ONE)},verifyBatch(_,m,E){if(cs(m),E.length!==m.length)throw new Error("amount of public keys and messages should be equal");const T=h(_),O=m,Y=E.map(o),C=new Map;for(let z=0;z<Y.length;z++){const L=Y[z],j=O[z];let W=C.get(j);W===void 0&&(W=[],C.set(j,W)),W.push(L)}const G=[],F=e.Point.BASE;try{for(const[z,L]of C){const j=L.reduce((W,D)=>W.add(D));G.push(A(j,z))}return G.push(A(F.negate(),T)),s.eql(a(G),s.ONE)}catch{return!1}},aggregatePublicKeys(_){cs(_),_=_.map(E=>o(E));const m=_.reduce((E,T)=>E.add(T),e.Point.ZERO);return m.assertValidity(),m},aggregateSignatures(_){cs(_),_=_.map(E=>h(E));const m=_.reduce((E,T)=>E.add(T),r.Point.ZERO);return m.assertValidity(),m},hash(_,m){pt(_);const E=m?{DST:m}:void 0;return r.hashToCurve(_,E)},Signature:n}}function p0(t){const{Fp:e,Fr:r,Fp2:n,Fp6:i,Fp12:s}=t.fields,a=Oo(t.G1),o=Object.assign(a,Ro(a.Point,t.G1.mapToCurve,{...t.htfDefaults,...t.G1.htfDefaults})),h=Oo(t.G2),w=Object.assign(h,Ro(h.Point,t.G2.mapToCurve,{...t.htfDefaults,...t.G2.htfDefaults})),A=d0(t.fields,o.Point,w.Point,{...t.params,postPrecompute:t.postPrecompute}),{millerLoopBatch:_,pairing:m,pairingBatch:E,calcPairingPrecomputes:T}=A,O=Po(A,o,w,t.G2.Signature,!1),Y=Po(A,w,o,t.G1.ShortSignature,!0),C=t.randomBytes||ha,G=()=>{const J=qc(r.ORDER);return zl(C(J),r.ORDER)},F={randomSecretKey:G,randomPrivateKey:G,calcPairingPrecomputes:T},{ShortSignature:z}=t.G1,{Signature:L}=t.G2;function j(J,se){return J instanceof o.Point?J:Y.hash(at("point",J),se==null?void 0:se.DST)}function W(J,se){return J instanceof w.Point?J:O.hash(at("point",J),se==null?void 0:se.DST)}function D(J){return O.getPublicKey(J).toBytes(!0)}function $(J){return Y.getPublicKey(J).toBytes(!0)}function k(J,se,oe){const re=W(J,oe),ne=O.sign(re,se);return J instanceof w.Point?ne:L.toBytes(ne)}function te(J,se,oe){const re=j(J,oe),ne=Y.sign(re,se);return J instanceof o.Point?ne:z.toBytes(ne)}function X(J,se,oe,re){const ne=W(se,re);return O.verify(J,ne,oe)}function q(J,se,oe,re){const ne=j(se,re);return Y.verify(J,ne,oe)}function Z(J){const se=O.aggregatePublicKeys(J);return J[0]instanceof o.Point?se:se.toBytes(!0)}function Q(J){const se=O.aggregateSignatures(J);return J[0]instanceof w.Point?se:L.toBytes(se)}function ue(J){const se=Y.aggregateSignatures(J);return J[0]instanceof o.Point?se:z.toBytes(se)}function le(J,se,oe,re){const ne=se.map(Te=>W(Te,re));return O.verifyBatch(J,ne,oe)}return o.Point.BASE.precompute(4),{longSignatures:O,shortSignatures:Y,millerLoopBatch:_,pairing:m,pairingBatch:E,verifyBatch:le,fields:{Fr:r,Fp:e,Fp2:n,Fp6:i,Fp12:s},params:{ateLoopSize:t.params.ateLoopSize,twistType:t.params.twistType,r:t.params.r,G1b:t.G1.b,G2b:t.G2.b},utils:F,getPublicKey:D,getPublicKeyForShortSignatures:$,sign:k,signShortSignature:te,verify:X,verifyShortSignature:q,aggregatePublicKeys:Z,aggregateSignatures:Q,aggregateShortSignatures:ue,G1:o,G2:w,Signature:L,ShortSignature:z}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ko=BigInt(0),Wt=BigInt(1),ot=BigInt(2),Mo=BigInt(3);function Qs(t,e,r,n,i=1,s){const a=BigInt(s===void 0?n:s),o=r**BigInt(n),h=[];for(let w=0;w<i;w++){const A=BigInt(w+1),_=[];for(let m=0,E=Wt;m<n;m++){const T=(A*E-A)/a%o;_.push(t.pow(e,T)),E*=r}h.push(_)}return h}function y0(t,e,r){const n=e.pow(r,(t.ORDER-Wt)/Mo),i=e.pow(r,(t.ORDER-Wt)/ot);function s(m,E){const T=e.mul(e.frobeniusMap(m,1),n),O=e.mul(e.frobeniusMap(E,1),i);return[T,O]}const a=e.pow(r,(t.ORDER**ot-Wt)/Mo),o=e.pow(r,(t.ORDER**ot-Wt)/ot);if(!e.eql(o,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function h(m,E){return[e.mul(m,a),e.neg(E)]}const w=m=>(E,T)=>{const O=T.toAffine(),Y=m(O.x,O.y);return E.fromAffine({x:Y[0],y:Y[1]})},A=w(s),_=w(h);return{psi:s,psi2:h,G2psi:A,G2psi2:_,PSI_X:n,PSI_Y:i,PSI2_X:a,PSI2_Y:o}}const Co=(t,e)=>{if(e.length!==2)throw new Error("invalid tuple");const r=e.map(n=>t.create(n));return{c0:r[0],c1:r[1]}};class w0{constructor(e,r={}){this.MASK=Wt;const n=e.ORDER,i=n*n;this.Fp=e,this.ORDER=i,this.BITS=xn(i),this.BYTES=Math.ceil(xn(i)/8),this.isLE=e.isLE,this.ZERO={c0:e.ZERO,c1:e.ZERO},this.ONE={c0:e.ONE,c1:e.ZERO},this.Fp_NONRESIDUE=e.create(r.NONRESIDUE||BigInt(-1)),this.Fp_div2=e.div(e.ONE,ot),this.NONRESIDUE=Co(e,r.FP2_NONRESIDUE),this.FROBENIUS_COEFFICIENTS=Qs(e,this.Fp_NONRESIDUE,e.ORDER,2)[0],this.mulByB=r.Fp2mulByB,Object.seal(this)}fromBigTuple(e){return Co(this.Fp,e)}create(e){return e}isValid({c0:e,c1:r}){function n(i,s){return typeof i=="bigint"&&ko<=i&&i<s}return n(e,this.ORDER)&&n(r,this.ORDER)}is0({c0:e,c1:r}){return this.Fp.is0(e)&&this.Fp.is0(r)}isValidNot0(e){return!this.is0(e)&&this.isValid(e)}eql({c0:e,c1:r},{c0:n,c1:i}){return this.Fp.eql(e,n)&&this.Fp.eql(r,i)}neg({c0:e,c1:r}){return{c0:this.Fp.neg(e),c1:this.Fp.neg(r)}}pow(e,r){return Ci(this,e,r)}invertBatch(e){return Rr(this,e)}add(e,r){const{c0:n,c1:i}=e,{c0:s,c1:a}=r;return{c0:this.Fp.add(n,s),c1:this.Fp.add(i,a)}}sub({c0:e,c1:r},{c0:n,c1:i}){return{c0:this.Fp.sub(e,n),c1:this.Fp.sub(r,i)}}mul({c0:e,c1:r},n){const{Fp:i}=this;if(typeof n=="bigint")return{c0:i.mul(e,n),c1:i.mul(r,n)};const{c0:s,c1:a}=n;let o=i.mul(e,s),h=i.mul(r,a);const w=i.sub(o,h),A=i.sub(i.mul(i.add(e,r),i.add(s,a)),i.add(o,h));return{c0:w,c1:A}}sqr({c0:e,c1:r}){const{Fp:n}=this,i=n.add(e,r),s=n.sub(e,r),a=n.add(e,e);return{c0:n.mul(i,s),c1:n.mul(a,r)}}addN(e,r){return this.add(e,r)}subN(e,r){return this.sub(e,r)}mulN(e,r){return this.mul(e,r)}sqrN(e){return this.sqr(e)}div(e,r){const{Fp:n}=this;return this.mul(e,typeof r=="bigint"?n.inv(n.create(r)):this.inv(r))}inv({c0:e,c1:r}){const{Fp:n}=this,i=n.inv(n.create(e*e+r*r));return{c0:n.mul(i,n.create(e)),c1:n.mul(i,n.create(-r))}}sqrt(e){const{Fp:r}=this,n=this,{c0:i,c1:s}=e;if(r.is0(s))return _i(r,i)===1?n.create({c0:r.sqrt(i),c1:r.ZERO}):n.create({c0:r.ZERO,c1:r.sqrt(r.div(i,this.Fp_NONRESIDUE))});const a=r.sqrt(r.sub(r.sqr(i),r.mul(r.sqr(s),this.Fp_NONRESIDUE)));let o=r.mul(r.add(a,i),this.Fp_div2);_i(r,o)===-1&&(o=r.sub(o,a));const w=r.sqrt(o),A=n.create({c0:w,c1:r.div(r.mul(s,this.Fp_div2),w)});if(!n.eql(n.sqr(A),e))throw new Error("Cannot find square root");const _=A,m=n.neg(_),{re:E,im:T}=n.reim(_),{re:O,im:Y}=n.reim(m);return T>Y||T===Y&&E>O?_:m}isOdd(e){const{re:r,im:n}=this.reim(e),i=r%ot,s=r===ko,a=n%ot;return BigInt(i||s&&a)==Wt}fromBytes(e){const{Fp:r}=this;if(e.length!==this.BYTES)throw new Error("fromBytes invalid length="+e.length);return{c0:r.fromBytes(e.subarray(0,r.BYTES)),c1:r.fromBytes(e.subarray(r.BYTES))}}toBytes({c0:e,c1:r}){return qe(this.Fp.toBytes(e),this.Fp.toBytes(r))}cmov({c0:e,c1:r},{c0:n,c1:i},s){return{c0:this.Fp.cmov(e,n,s),c1:this.Fp.cmov(r,i,s)}}reim({c0:e,c1:r}){return{re:e,im:r}}Fp4Square(e,r){const n=this,i=n.sqr(e),s=n.sqr(r);return{first:n.add(n.mulByNonresidue(s),i),second:n.sub(n.sub(n.sqr(n.add(e,r)),i),s)}}mulByNonresidue({c0:e,c1:r}){return this.mul({c0:e,c1:r},this.NONRESIDUE)}frobeniusMap({c0:e,c1:r},n){return{c0:e,c1:this.Fp.mul(r,this.FROBENIUS_COEFFICIENTS[n%2])}}}class g0{constructor(e){this.MASK=Wt,this.Fp2=e,this.ORDER=e.ORDER,this.BITS=3*e.BITS,this.BYTES=3*e.BYTES,this.isLE=e.isLE,this.ZERO={c0:e.ZERO,c1:e.ZERO,c2:e.ZERO},this.ONE={c0:e.ONE,c1:e.ZERO,c2:e.ZERO};const{Fp:r}=e,n=Qs(e,e.NONRESIDUE,r.ORDER,6,2,3);this.FROBENIUS_COEFFICIENTS_1=n[0],this.FROBENIUS_COEFFICIENTS_2=n[1],Object.seal(this)}add({c0:e,c1:r,c2:n},{c0:i,c1:s,c2:a}){const{Fp2:o}=this;return{c0:o.add(e,i),c1:o.add(r,s),c2:o.add(n,a)}}sub({c0:e,c1:r,c2:n},{c0:i,c1:s,c2:a}){const{Fp2:o}=this;return{c0:o.sub(e,i),c1:o.sub(r,s),c2:o.sub(n,a)}}mul({c0:e,c1:r,c2:n},i){const{Fp2:s}=this;if(typeof i=="bigint")return{c0:s.mul(e,i),c1:s.mul(r,i),c2:s.mul(n,i)};const{c0:a,c1:o,c2:h}=i,w=s.mul(e,a),A=s.mul(r,o),_=s.mul(n,h);return{c0:s.add(w,s.mulByNonresidue(s.sub(s.mul(s.add(r,n),s.add(o,h)),s.add(A,_)))),c1:s.add(s.sub(s.mul(s.add(e,r),s.add(a,o)),s.add(w,A)),s.mulByNonresidue(_)),c2:s.sub(s.add(A,s.mul(s.add(e,n),s.add(a,h))),s.add(w,_))}}sqr({c0:e,c1:r,c2:n}){const{Fp2:i}=this;let s=i.sqr(e),a=i.mul(i.mul(e,r),ot),o=i.mul(i.mul(r,n),ot),h=i.sqr(n);return{c0:i.add(i.mulByNonresidue(o),s),c1:i.add(i.mulByNonresidue(h),a),c2:i.sub(i.sub(i.add(i.add(a,i.sqr(i.add(i.sub(e,r),n))),o),s),h)}}addN(e,r){return this.add(e,r)}subN(e,r){return this.sub(e,r)}mulN(e,r){return this.mul(e,r)}sqrN(e){return this.sqr(e)}create(e){return e}isValid({c0:e,c1:r,c2:n}){const{Fp2:i}=this;return i.isValid(e)&&i.isValid(r)&&i.isValid(n)}is0({c0:e,c1:r,c2:n}){const{Fp2:i}=this;return i.is0(e)&&i.is0(r)&&i.is0(n)}isValidNot0(e){return!this.is0(e)&&this.isValid(e)}neg({c0:e,c1:r,c2:n}){const{Fp2:i}=this;return{c0:i.neg(e),c1:i.neg(r),c2:i.neg(n)}}eql({c0:e,c1:r,c2:n},{c0:i,c1:s,c2:a}){const{Fp2:o}=this;return o.eql(e,i)&&o.eql(r,s)&&o.eql(n,a)}sqrt(e){return Ic()}div(e,r){const{Fp2:n}=this,{Fp:i}=n;return this.mul(e,typeof r=="bigint"?i.inv(i.create(r)):this.inv(r))}pow(e,r){return Ci(this,e,r)}invertBatch(e){return Rr(this,e)}inv({c0:e,c1:r,c2:n}){const{Fp2:i}=this;let s=i.sub(i.sqr(e),i.mulByNonresidue(i.mul(n,r))),a=i.sub(i.mulByNonresidue(i.sqr(n)),i.mul(e,r)),o=i.sub(i.sqr(r),i.mul(e,n)),h=i.inv(i.add(i.mulByNonresidue(i.add(i.mul(n,a),i.mul(r,o))),i.mul(e,s)));return{c0:i.mul(h,s),c1:i.mul(h,a),c2:i.mul(h,o)}}fromBytes(e){const{Fp2:r}=this;if(e.length!==this.BYTES)throw new Error("fromBytes invalid length="+e.length);const n=r.BYTES;return{c0:r.fromBytes(e.subarray(0,n)),c1:r.fromBytes(e.subarray(n,n*2)),c2:r.fromBytes(e.subarray(2*n))}}toBytes({c0:e,c1:r,c2:n}){const{Fp2:i}=this;return qe(i.toBytes(e),i.toBytes(r),i.toBytes(n))}cmov({c0:e,c1:r,c2:n},{c0:i,c1:s,c2:a},o){const{Fp2:h}=this;return{c0:h.cmov(e,i,o),c1:h.cmov(r,s,o),c2:h.cmov(n,a,o)}}fromBigSix(e){const{Fp2:r}=this;if(!Array.isArray(e)||e.length!==6)throw new Error("invalid Fp6 usage");return{c0:r.fromBigTuple(e.slice(0,2)),c1:r.fromBigTuple(e.slice(2,4)),c2:r.fromBigTuple(e.slice(4,6))}}frobeniusMap({c0:e,c1:r,c2:n},i){const{Fp2:s}=this;return{c0:s.frobeniusMap(e,i),c1:s.mul(s.frobeniusMap(r,i),this.FROBENIUS_COEFFICIENTS_1[i%6]),c2:s.mul(s.frobeniusMap(n,i),this.FROBENIUS_COEFFICIENTS_2[i%6])}}mulByFp2({c0:e,c1:r,c2:n},i){const{Fp2:s}=this;return{c0:s.mul(e,i),c1:s.mul(r,i),c2:s.mul(n,i)}}mulByNonresidue({c0:e,c1:r,c2:n}){const{Fp2:i}=this;return{c0:i.mulByNonresidue(n),c1:e,c2:r}}mul1({c0:e,c1:r,c2:n},i){const{Fp2:s}=this;return{c0:s.mulByNonresidue(s.mul(n,i)),c1:s.mul(e,i),c2:s.mul(r,i)}}mul01({c0:e,c1:r,c2:n},i,s){const{Fp2:a}=this;let o=a.mul(e,i),h=a.mul(r,s);return{c0:a.add(a.mulByNonresidue(a.sub(a.mul(a.add(r,n),s),h)),o),c1:a.sub(a.sub(a.mul(a.add(i,s),a.add(e,r)),o),h),c2:a.add(a.sub(a.mul(a.add(e,n),i),o),h)}}}class m0{constructor(e,r){this.MASK=Wt;const{Fp2:n}=e,{Fp:i}=n;this.Fp6=e,this.ORDER=n.ORDER,this.BITS=2*e.BITS,this.BYTES=2*e.BYTES,this.isLE=e.isLE,this.ZERO={c0:e.ZERO,c1:e.ZERO},this.ONE={c0:e.ONE,c1:e.ZERO},this.FROBENIUS_COEFFICIENTS=Qs(n,n.NONRESIDUE,i.ORDER,12,1,6)[0],this.X_LEN=r.X_LEN,this.finalExponentiate=r.Fp12finalExponentiate}create(e){return e}isValid({c0:e,c1:r}){const{Fp6:n}=this;return n.isValid(e)&&n.isValid(r)}is0({c0:e,c1:r}){const{Fp6:n}=this;return n.is0(e)&&n.is0(r)}isValidNot0(e){return!this.is0(e)&&this.isValid(e)}neg({c0:e,c1:r}){const{Fp6:n}=this;return{c0:n.neg(e),c1:n.neg(r)}}eql({c0:e,c1:r},{c0:n,c1:i}){const{Fp6:s}=this;return s.eql(e,n)&&s.eql(r,i)}sqrt(e){Ic()}inv({c0:e,c1:r}){const{Fp6:n}=this;let i=n.inv(n.sub(n.sqr(e),n.mulByNonresidue(n.sqr(r))));return{c0:n.mul(e,i),c1:n.neg(n.mul(r,i))}}div(e,r){const{Fp6:n}=this,{Fp2:i}=n,{Fp:s}=i;return this.mul(e,typeof r=="bigint"?s.inv(s.create(r)):this.inv(r))}pow(e,r){return Ci(this,e,r)}invertBatch(e){return Rr(this,e)}add({c0:e,c1:r},{c0:n,c1:i}){const{Fp6:s}=this;return{c0:s.add(e,n),c1:s.add(r,i)}}sub({c0:e,c1:r},{c0:n,c1:i}){const{Fp6:s}=this;return{c0:s.sub(e,n),c1:s.sub(r,i)}}mul({c0:e,c1:r},n){const{Fp6:i}=this;if(typeof n=="bigint")return{c0:i.mul(e,n),c1:i.mul(r,n)};let{c0:s,c1:a}=n,o=i.mul(e,s),h=i.mul(r,a);return{c0:i.add(o,i.mulByNonresidue(h)),c1:i.sub(i.mul(i.add(e,r),i.add(s,a)),i.add(o,h))}}sqr({c0:e,c1:r}){const{Fp6:n}=this;let i=n.mul(e,r);return{c0:n.sub(n.sub(n.mul(n.add(n.mulByNonresidue(r),e),n.add(e,r)),i),n.mulByNonresidue(i)),c1:n.add(i,i)}}addN(e,r){return this.add(e,r)}subN(e,r){return this.sub(e,r)}mulN(e,r){return this.mul(e,r)}sqrN(e){return this.sqr(e)}fromBytes(e){const{Fp6:r}=this;if(e.length!==this.BYTES)throw new Error("fromBytes invalid length="+e.length);return{c0:r.fromBytes(e.subarray(0,r.BYTES)),c1:r.fromBytes(e.subarray(r.BYTES))}}toBytes({c0:e,c1:r}){const{Fp6:n}=this;return qe(n.toBytes(e),n.toBytes(r))}cmov({c0:e,c1:r},{c0:n,c1:i},s){const{Fp6:a}=this;return{c0:a.cmov(e,n,s),c1:a.cmov(r,i,s)}}fromBigTwelve(e){const{Fp6:r}=this;return{c0:r.fromBigSix(e.slice(0,6)),c1:r.fromBigSix(e.slice(6,12))}}frobeniusMap(e,r){const{Fp6:n}=this,{Fp2:i}=n,{c0:s,c1:a,c2:o}=n.frobeniusMap(e.c1,r),h=this.FROBENIUS_COEFFICIENTS[r%12];return{c0:n.frobeniusMap(e.c0,r),c1:n.create({c0:i.mul(s,h),c1:i.mul(a,h),c2:i.mul(o,h)})}}mulByFp2({c0:e,c1:r},n){const{Fp6:i}=this;return{c0:i.mulByFp2(e,n),c1:i.mulByFp2(r,n)}}conjugate({c0:e,c1:r}){return{c0:e,c1:this.Fp6.neg(r)}}mul014({c0:e,c1:r},n,i,s){const{Fp6:a}=this,{Fp2:o}=a;let h=a.mul01(e,n,i),w=a.mul1(r,s);return{c0:a.add(a.mulByNonresidue(w),h),c1:a.sub(a.sub(a.mul01(a.add(r,e),n,o.add(i,s)),h),w)}}mul034({c0:e,c1:r},n,i,s){const{Fp6:a}=this,{Fp2:o}=a,h=a.create({c0:o.mul(e.c0,n),c1:o.mul(e.c1,n),c2:o.mul(e.c2,n)}),w=a.mul01(r,i,s),A=a.mul01(a.add(e,r),o.add(n,i),s);return{c0:a.add(a.mulByNonresidue(w),h),c1:a.sub(A,a.add(h,w))}}_cyclotomicSquare({c0:e,c1:r}){const{Fp6:n}=this,{Fp2:i}=n,{c0:s,c1:a,c2:o}=e,{c0:h,c1:w,c2:A}=r,{first:_,second:m}=i.Fp4Square(s,w),{first:E,second:T}=i.Fp4Square(h,o),{first:O,second:Y}=i.Fp4Square(a,A),C=i.mulByNonresidue(Y);return{c0:n.create({c0:i.add(i.mul(i.sub(_,s),ot),_),c1:i.add(i.mul(i.sub(E,a),ot),E),c2:i.add(i.mul(i.sub(O,o),ot),O)}),c1:n.create({c0:i.add(i.mul(i.add(C,h),ot),C),c1:i.add(i.mul(i.add(m,w),ot),m),c2:i.add(i.mul(i.add(T,A),ot),T)})}}_cyclotomicExp(e,r){let n=this.ONE;for(let i=this.X_LEN-1;i>=0;i--)n=this._cyclotomicSquare(n),$l(r,i)&&(n=this.mul(n,e));return n}}function b0(t){const e=hr(t.ORDER),r=new w0(e,t),n=new g0(r),i=new m0(n,t);return{Fp:e,Fp2:r,Fp6:n,Fp12:i}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const tt=BigInt(0),vi=BigInt(1),yt=BigInt(2),$i=BigInt(3),Bn=BigInt(4),or=BigInt("0xd201000000010000"),_0=xn(or),Nr={p:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),n:BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001"),h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),a:tt,b:Bn,Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1")},x0=hr(Nr.n,{modFromBytes:!0,isLE:!0}),{Fp:de,Fp2:xe,Fp6:E0,Fp12:Ae}=b0({ORDER:Nr.p,X_LEN:_0,FP2_NONRESIDUE:[vi,vi],Fp2mulByB:({c0:t,c1:e})=>{const r=de.mul(t,Bn),n=de.mul(e,Bn);return{c0:de.sub(r,n),c1:de.add(r,n)}},Fp12finalExponentiate:t=>{const e=or,r=Ae.div(Ae.frobeniusMap(t,6),t),n=Ae.mul(Ae.frobeniusMap(r,2),r),i=Ae.conjugate(Ae._cyclotomicExp(n,e)),s=Ae.mul(Ae.conjugate(Ae._cyclotomicSquare(n)),i),a=Ae.conjugate(Ae._cyclotomicExp(s,e)),o=Ae.conjugate(Ae._cyclotomicExp(a,e)),h=Ae.mul(Ae.conjugate(Ae._cyclotomicExp(o,e)),Ae._cyclotomicSquare(i)),w=Ae.conjugate(Ae._cyclotomicExp(h,e)),A=Ae.frobeniusMap(Ae.mul(i,o),2),_=Ae.frobeniusMap(Ae.mul(a,n),3),m=Ae.frobeniusMap(Ae.mul(h,Ae.conjugate(n)),1),E=Ae.mul(Ae.mul(w,Ae.conjugate(s)),n);return Ae.mul(Ae.mul(Ae.mul(A,_),m),E)}}),{G2psi:$o,G2psi2:v0}=y0(de,xe,xe.div(xe.ONE,xe.NONRESIDUE)),us=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:de.ORDER,m:2,k:128,expand:"xmd",hash:wa}),eo={p:xe.ORDER,n:Nr.n,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),a:xe.ZERO,b:xe.fromBigTuple([Bn,Bn]),Gx:xe.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:xe.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")])},qi=Pn(de.toBytes(tt),{infinity:!0,compressed:!0});function Vi(t){t=t.slice();const e=t[0]&224,r=!!(e>>7&1),n=!!(e>>6&1),i=!!(e>>5&1);return t[0]&=31,{compressed:r,infinity:n,sort:i,value:t}}function Pn(t,e){if(t[0]&224)throw new Error("setMask: non-empty mask");return e.compressed&&(t[0]|=128),e.infinity&&(t[0]|=64),e.sort&&(t[0]|=32),t}function B0(t,e,r){const{BYTES:n,ORDER:i}=de,s=e.is0(),{x:a,y:o}=e.toAffine();if(r){if(s)return qi.slice();const h=!!(o*yt/i);return Pn(Ze(a,n),{compressed:!0,sort:h})}else return s?qe(Uint8Array.of(64),new Uint8Array(2*n-1)):qe(Ze(a,n),Ze(o,n))}function fs(t){t.assertValidity();const{BYTES:e,ORDER:r}=de,{x:n,y:i}=t.toAffine();if(t.is0())return qi.slice();const s=!!(i*yt/r);return Pn(Ze(n,e),{compressed:!0,sort:s})}function A0(t){const{compressed:e,infinity:r,sort:n,value:i}=Vi(t),{BYTES:s,ORDER:a}=de;if(i.length===48&&e){const o=Ft(i),h=de.create(o&Ir(de.BITS));if(r){if(h!==tt)throw new Error("invalid G1 point: non-empty, at infinity, with compression");return{x:tt,y:tt}}const w=de.add(de.pow(h,$i),de.create(Nr.b));let A=de.sqrt(w);if(!A)throw new Error("invalid G1 point: compressed point");return A*yt/a!==BigInt(n)&&(A=de.neg(A)),{x:de.create(h),y:de.create(A)}}else if(i.length===96&&!e){const o=Ft(i.subarray(0,s)),h=Ft(i.subarray(s));if(r){if(o!==tt||h!==tt)throw new Error("G1: non-empty point at infinity");return Gi.G1.Point.ZERO.toAffine()}return{x:de.create(o),y:de.create(h)}}else throw new Error("invalid G1 point: expected 48/96 bytes")}function qo(t){const{infinity:e,sort:r,value:n}=Vi(at("signatureHex",t,48)),i=de.ORDER,s=Gi.G1.Point,a=Ft(n);if(e)return s.ZERO;const o=de.create(a&Ir(de.BITS)),h=de.add(de.pow(o,$i),de.create(Nr.b));let w=de.sqrt(h);if(!w)throw new Error("invalid G1 point: compressed");const A=BigInt(r);w*yt/i!==A&&(w=de.neg(w));const _=s.fromAffine({x:o,y:w});return _.assertValidity(),_}function T0(t,e,r){const{BYTES:n,ORDER:i}=de,s=e.is0(),{x:a,y:o}=e.toAffine();if(r){if(s)return qe(qi,Ze(tt,n));const h=!!(o.c1===tt?o.c0*yt/i:o.c1*yt/i);return qe(Pn(Ze(a.c1,n),{compressed:!0,sort:h}),Ze(a.c0,n))}else{if(s)return qe(Uint8Array.of(64),new Uint8Array(4*n-1));const{re:h,im:w}=xe.reim(a),{re:A,im:_}=xe.reim(o);return qe(Ze(w,n),Ze(h,n),Ze(_,n),Ze(A,n))}}function ls(t){t.assertValidity();const{BYTES:e}=de;if(t.is0())return qe(qi,Ze(tt,e));const{x:r,y:n}=t.toAffine(),{re:i,im:s}=xe.reim(r),{re:a,im:o}=xe.reim(n),w=!!((o>tt?o*yt:a*yt)/de.ORDER&vi),A=i;return qe(Pn(Ze(s,e),{sort:w,compressed:!0}),Ze(A,e))}function S0(t){const{BYTES:e,ORDER:r}=de,{compressed:n,infinity:i,sort:s,value:a}=Vi(t);if(!n&&!i&&s||!n&&i&&s||s&&i&&n)throw new Error("invalid encoding flag: "+(t[0]&224));const o=(h,w,A)=>Ft(h.slice(w,A));if(a.length===96&&n){if(i){if(a.reduce((T,O)=>T!==0?O+1:O,0)>0)throw new Error("invalid G2 point: compressed");return{x:xe.ZERO,y:xe.ZERO}}const h=o(a,0,e),w=o(a,e,2*e),A=xe.create({c0:de.create(w),c1:de.create(h)}),_=xe.add(xe.pow(A,$i),eo.b);let m=xe.sqrt(_);const E=m.c1===tt?m.c0*yt/r:m.c1*yt/r?vi:tt;return m=s&&E>0?m:xe.neg(m),{x:A,y:m}}else if(a.length===192&&!n){if(i){if(a.reduce((m,E)=>m!==0?E+1:E,0)>0)throw new Error("invalid G2 point: uncompressed");return{x:xe.ZERO,y:xe.ZERO}}const h=o(a,0*e,1*e),w=o(a,1*e,2*e),A=o(a,2*e,3*e),_=o(a,3*e,4*e);return{x:xe.fromBigTuple([w,h]),y:xe.fromBigTuple([_,A])}}else throw new Error("invalid G2 point: expected 96/192 bytes")}function Vo(t){const{ORDER:e}=de,{infinity:r,sort:n,value:i}=Vi(at("signatureHex",t)),s=Gi.G2.Point,a=i.length/2;if(a!==48&&a!==96)throw new Error("invalid compressed signature length, expected 96/192 bytes");const o=Ft(i.slice(0,a)),h=Ft(i.slice(a));if(r)return s.ZERO;const w=de.create(o&Ir(de.BITS)),A=de.create(h),_=xe.create({c0:A,c1:w}),m=xe.add(xe.pow(_,$i),eo.b);let E=xe.sqrt(m);if(!E)throw new Error("Failed to find a square root");const{re:T,im:O}=xe.reim(E),Y=BigInt(n),C=O>tt&&O*yt/e!==Y,G=O===tt&&T*yt/e!==Y;(C||G)&&(E=xe.neg(E));const F=s.fromAffine({x:_,y:E});return F.assertValidity(),F}const Gi=p0({fields:{Fp:de,Fp2:xe,Fp6:E0,Fp12:Ae,Fr:x0},G1:{...Nr,Fp:de,htfDefaults:{...us,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(t,e)=>{const r=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),n=new t(de.mul(e.X,r),e.Y,e.Z);return e.multiplyUnsafe(or).negate().multiplyUnsafe(or).equals(n)},clearCofactor:(t,e)=>e.multiplyUnsafe(or).add(e),mapToCurve:O0,fromBytes:A0,toBytes:B0,ShortSignature:{fromBytes(t){return pt(t),qo(t)},fromHex(t){return qo(t)},toBytes(t){return fs(t)},toRawBytes(t){return fs(t)},toHex(t){return Qr(fs(t))}}},G2:{...eo,Fp:xe,hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...us},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:F0,isTorsionFree:(t,e)=>e.multiplyUnsafe(or).negate().equals($o(t,e)),clearCofactor:(t,e)=>{const r=or;let n=e.multiplyUnsafe(r).negate(),i=$o(t,e),s=e.double();return s=v0(t,s),s=s.subtract(i),i=n.add(i),i=i.multiplyUnsafe(r).negate(),s=s.add(i),s=s.subtract(n),s.subtract(e)},fromBytes:S0,toBytes:T0,Signature:{fromBytes(t){return pt(t),Vo(t)},fromHex(t){return Vo(t)},toBytes(t){return ls(t)},toRawBytes(t){return ls(t)},toHex(t){return Qr(ls(t))}}},params:{ateLoopSize:or,r:Nr.n,xNegative:!0,twistType:"multiplicative"},htfDefaults:us}),N0=Wc(xe,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(t=>t.map(e=>xe.fromBigTuple(e.map(BigInt))))),I0=Wc(de,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(e=>BigInt(e)))),R0=Lc(de,{A:de.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:de.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:de.create(BigInt(11))}),U0=Lc(xe,{A:xe.create({c0:de.create(tt),c1:de.create(BigInt(240))}),B:xe.create({c0:de.create(BigInt(1012)),c1:de.create(BigInt(1012))}),Z:xe.create({c0:de.create(BigInt(-2)),c1:de.create(BigInt(-1))})});function O0(t){const{x:e,y:r}=R0(de.create(t[0]));return I0(e,r)}function F0(t){const{x:e,y:r}=U0(xe.fromBigTuple(t));return N0(e,r)}function P0(t,e,r){const n=typeof t=="string"?t:ke(t),i=typeof e=="string"?e:ke(e),s=typeof r=="string"?r:ke(r);return Gi.verifyShortSignature(i,s,n)}const zc=t=>Le(new nn(t)),to=t=>{const e=zc(t);return new Date(Number(e)/1e6)};var k0=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},M0=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Dn;class Rt extends Me{constructor(e){super(`Invalid certificate: ${e}`)}}var ft;(function(t){t[t.Empty=0]="Empty",t[t.Fork=1]="Fork",t[t.Labeled=2]="Labeled",t[t.Leaf=3]="Leaf",t[t.Pruned=4]="Pruned"})(ft||(ft={}));function C0(t,e){const r=new Uint8Array(t),n=new Uint8Array(e);for(let i=0;i<r.length;i++)if(r[i]>n[i])return!0;return!1}class Er{constructor(e,r,n,i,s=5,a=!1){this._rootKey=r,this._canisterId=n,this._blsVerify=i,this._maxAgeInMinutes=s,Dn.set(this,!1),k0(this,Dn,a,"f"),this.cert=Ht(new Uint8Array(e))}static async create(e){const r=Er.createUnverified(e);return await r.verify(),r}static createUnverified(e){let r=e.blsVerify;return r||(r=P0),new Er(e.certificate,e.rootKey,e.canisterId,r,e.maxAgeInMinutes,e.disableTimeVerification)}lookup(e){return rn(e,this.cert.tree)}lookup_label(e){return this.lookup([e])}async verify(){const e=await Xn(this.cert.tree),r=await this._checkDelegationAndGetKey(this.cert.delegation),n=this.cert.signature,i=q0(r),s=Et(un("ic-state-root"),e);let a=!1;const o=dt(this.lookup(["time"]));if(!o)throw new Rt("Certificate does not contain a time");if(!M0(this,Dn,"f")){const w=this._maxAgeInMinutes*60*1e3,A=Date.now(),_=A-w,m=A+3e5,E=to(o);if(E.getTime()<_)throw new Rt(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: `+E.toISOString()+" Current time: "+new Date(A).toISOString());if(E.getTime()>m)throw new Rt("Certificate is signed more than 5 minutes in the future. Certificate time: "+E.toISOString()+" Current time: "+new Date(A).toISOString())}try{a=await this._blsVerify(new Uint8Array(i),new Uint8Array(n),new Uint8Array(s))}catch{a=!1}if(!a)throw new Rt("Signature verification failed")}async _checkDelegationAndGetKey(e){if(!e)return this._rootKey;const r=await Er.createUnverified({certificate:e.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,maxAgeInMinutes:1/0});if(r.cert.delegation)throw new Rt("Delegation certificates cannot be nested");if(await r.verify(),this._canisterId.toString()!==fh&&!Zc({canisterId:this._canisterId,subnetId:be.fromUint8Array(new Uint8Array(e.subnet_id)),tree:r.cert.tree}))throw new Rt(`Canister ${this._canisterId} not in range of delegations for subnet 0x${ke(e.subnet_id)}`);const n=dt(r.lookup(["subnet",e.subnet_id,"public_key"]));if(!n)throw new Error(`Could not find subnet key for subnet 0x${ke(e.subnet_id)}`);return n}}Dn=new WeakMap;const an=zt("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),$0=96;function q0(t){const e=an.byteLength+$0;if(t.byteLength!==e)throw new TypeError(`BLS DER-encoded public key must be ${e} bytes long`);const r=t.slice(0,an.byteLength);if(!In(r,an))throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${an}, but get ${r}`);return t.slice(an.byteLength)}function dt(t){if(t.status===Ke.Found){if(t.value instanceof ArrayBuffer)return t.value;if(t.value instanceof Uint8Array)return t.value.buffer}}async function Xn(t){switch(t[0]){case ft.Empty:return xt(un("ic-hashtree-empty"));case ft.Pruned:return t[1];case ft.Leaf:return xt(Et(un("ic-hashtree-leaf"),t[1]));case ft.Labeled:return xt(Et(un("ic-hashtree-labeled"),t[1],await Xn(t[2])));case ft.Fork:return xt(Et(un("ic-hashtree-fork"),await Xn(t[1]),await Xn(t[2])));default:throw new Error("unreachable")}}function un(t){const e=new Uint8Array([t.length]),r=new TextEncoder().encode(t);return Et(e,r)}var Ke;(function(t){t.Unknown="unknown",t.Absent="absent",t.Found="found"})(Ke||(Ke={}));var Gt;(function(t){t.Less="less",t.Greater="greater"})(Gt||(Gt={}));function rn(t,e){if(t.length===0)switch(e[0]){case ft.Leaf:{if(!e[1])throw new Error("Invalid tree structure for leaf");return e[1]instanceof ArrayBuffer?{status:Ke.Found,value:e[1]}:e[1]instanceof Uint8Array?{status:Ke.Found,value:e[1].buffer}:{status:Ke.Found,value:e[1]}}default:return{status:Ke.Found,value:e}}const r=typeof t[0]=="string"?new TextEncoder().encode(t[0]):t[0],n=Jn(r,e);switch(n.status){case Ke.Found:return rn(t.slice(1),n.value);case Gt.Greater:case Gt.Less:return{status:Ke.Absent};default:return n}}function Ps(t){switch(t[0]){case ft.Empty:return[];case ft.Fork:return Ps(t[1]).concat(Ps(t[2]));default:return[t]}}function Jn(t,e){switch(e[0]){case ft.Labeled:return C0(t,e[1])?{status:Gt.Greater}:In(t,e[1])?{status:Ke.Found,value:e[2]}:{status:Gt.Less};case ft.Fork:const r=Jn(t,e[1]);switch(r.status){case Gt.Greater:{const n=Jn(t,e[2]);return n.status===Gt.Less?{status:Ke.Absent}:n}case Ke.Unknown:{let n=Jn(t,e[2]);return n.status===Gt.Less?{status:Ke.Unknown}:n}default:return r}case ft.Pruned:return{status:Ke.Unknown};default:return{status:Ke.Absent}}}function Zc(t){const{canisterId:e,subnetId:r,tree:n}=t,i=rn(["subnet",r.toUint8Array(),"canister_ranges"],n);if(i.status!==Ke.Found||!(i.value instanceof ArrayBuffer))throw new Error(`Could not find canister ranges for subnet ${r}`);return Ht(i.value).map(h=>[be.fromUint8Array(h[0]),be.fromUint8Array(h[1])]).some(h=>h[0].ltEq(e)&&h[1].gtEq(e))}class V0{constructor(e,r,n){this.key=e,this.path=r,this.decodeStrategy=n}}const Dc=async t=>{const{agent:e,paths:r}=t,n=be.from(t.canisterId),i=[...new Set(r)],s=i.map(h=>ks(h,n)),a=new Map,o=i.map((h,w)=>(async()=>{var A;try{const _=await e.readState(n,{paths:[s[w]]});if(e.rootKey==null)throw new Error("Agent is missing root key");const m=await Er.create({certificate:_.certificate,rootKey:e.rootKey,canisterId:n,disableTimeVerification:!0}),E=(Y,C)=>{if(C==="subnet"){if(e.rootKey==null)throw new Error("Agent is missing root key");const G=Xc(_.certificate,n,e.rootKey);return{path:C,data:G}}else return{path:C,data:dt(Y.lookup(ks(C,n)))}},{path:T,data:O}=E(m,i[w]);if(!O)console.warn(`Expected to find result for path ${T}, but instead found nothing.`),typeof T=="string"?a.set(T,null):a.set(T.key,null);else switch(T){case"time":{a.set(T,to(O));break}case"controllers":{a.set(T,K0(O));break}case"module_hash":{a.set(T,Go(O));break}case"subnet":{a.set(T,O);break}case"candid":{a.set(T,new TextDecoder().decode(O));break}default:if(typeof T!="string"&&"key"in T&&"path"in T)switch(T.decodeStrategy){case"raw":a.set(T.key,O);break;case"leb128":{a.set(T.key,zc(O));break}case"cbor":{a.set(T.key,Jc(O));break}case"hex":{a.set(T.key,Go(O));break}case"utf-8":a.set(T.key,G0(O))}}}catch(_){if(!((A=_==null?void 0:_.message)===null||A===void 0)&&A.includes("Invalid certificate"))throw new Me(_.message);typeof h!="string"&&"key"in h&&"path"in h?a.set(h.key,null):a.set(h,null),console.group(),console.warn(`Expected to find result for path ${h}, but instead found nothing.`),console.warn(_),console.groupEnd()}})());return await Promise.all(o),a},Xc=(t,e,r)=>{if(!e._isPrincipal)throw new Error("Invalid canisterId");const n=Ht(new Uint8Array(t)),i=n.tree;let s=n.delegation,a;if(s&&s.subnet_id?a=be.fromUint8Array(new Uint8Array(s.subnet_id)):!s&&typeof r<"u"?(a=be.selfAuthenticating(new Uint8Array(r)),s={subnet_id:a.toUint8Array(),certificate:new ArrayBuffer(0)}):(a=be.selfAuthenticating(be.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),s={subnet_id:a.toUint8Array(),certificate:new ArrayBuffer(0)}),!Zc({canisterId:e,subnetId:a,tree:i}))throw new Error("Canister not in range");const h=rn(["subnet",s.subnet_id,"node"],i);if(h.status!==Ke.Found)throw new Error("Node not found");if(h.value instanceof ArrayBuffer)throw new Error("Invalid node tree");const w=Ps(h.value),A=new Map;return w.forEach(_=>{const m=be.from(new Uint8Array(_[1])).toText(),E=rn(["public_key"],_[2]);if(E.status!==Ke.Found)throw new Error("Public key not found");const T=E.value;if(T.byteLength!==44)throw new Error("Invalid public key length");A.set(m,T)}),{subnetId:be.fromUint8Array(new Uint8Array(s.subnet_id)).toText(),nodeKeys:A}},ks=(t,e)=>{const r=new TextEncoder,n=s=>new DataView(r.encode(s).buffer).buffer,i=new DataView(e.toUint8Array().buffer).buffer;switch(t){case"time":return[n("time")];case"controllers":return[n("canister"),i,n("controllers")];case"module_hash":return[n("canister"),i,n("module_hash")];case"subnet":return[n("subnet")];case"candid":return[n("canister"),i,n("metadata"),n("candid:service")];default:if("key"in t&&"path"in t)if(typeof t.path=="string"||t.path instanceof ArrayBuffer){const s=t.path,a=typeof s=="string"?n(s):s;return[n("canister"),i,n("metadata"),a]}else return t.path}throw new Error(`An unexpeected error was encountered while encoding your path for canister status. Please ensure that your path, ${t} was formatted correctly.`)},Go=t=>ke(t),Jc=t=>Ht(t),G0=t=>new TextDecoder().decode(t),K0=t=>Jc(t).map(r=>be.fromUint8Array(new Uint8Array(r))),j0=Object.freeze(Object.defineProperty({__proto__:null,CustomPath:V0,encodePath:ks,fetchNodeKeys:Xc,request:Dc},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const nr=BigInt(0),We=BigInt(1),hs=BigInt(2),H0=BigInt(8);function Y0(t,e,r,n){const i=t.sqr(r),s=t.sqr(n),a=t.add(t.mul(e.a,i),s),o=t.add(t.ONE,t.mul(e.d,t.mul(i,s)));return t.eql(a,o)}function W0(t,e={}){const r=Hc("edwards",t,e,e.FpFnLE),{Fp:n,Fn:i}=r;let s=r.CURVE;const{h:a}=s;Fn(e,{},{uvRatio:"function"});const o=hs<<BigInt(i.BYTES*8)-We,h=Y=>n.create(Y),w=e.uvRatio||((Y,C)=>{try{return{isValid:!0,value:n.sqrt(n.div(Y,C))}}catch{return{isValid:!1,value:nr}}});if(!Y0(n,s,s.Gx,s.Gy))throw new Error("bad curve params: generator point");function A(Y,C,G=!1){const F=G?We:nr;return Ao("coordinate "+Y,C,F,o),C}function _(Y){if(!(Y instanceof T))throw new Error("ExtendedPoint expected")}const m=En((Y,C)=>{const{X:G,Y:F,Z:z}=Y,L=Y.is0();C==null&&(C=L?H0:n.inv(z));const j=h(G*C),W=h(F*C),D=n.mul(z,C);if(L)return{x:nr,y:We};if(D!==We)throw new Error("invZ was invalid");return{x:j,y:W}}),E=En(Y=>{const{a:C,d:G}=s;if(Y.is0())throw new Error("bad point: ZERO");const{X:F,Y:z,Z:L,T:j}=Y,W=h(F*F),D=h(z*z),$=h(L*L),k=h($*$),te=h(W*C),X=h($*h(te+D)),q=h(k+h(G*h(W*D)));if(X!==q)throw new Error("bad point: equation left != right (1)");const Z=h(F*z),Q=h(L*j);if(Z!==Q)throw new Error("bad point: equation left != right (2)");return!0});class T{constructor(C,G,F,z){this.X=A("x",C),this.Y=A("y",G),this.Z=A("z",F,!0),this.T=A("t",z),Object.freeze(this)}static CURVE(){return s}static fromAffine(C){if(C instanceof T)throw new Error("extended point not allowed");const{x:G,y:F}=C||{};return A("x",G),A("y",F),new T(G,F,We,h(G*F))}static fromBytes(C,G=!1){const F=n.BYTES,{a:z,d:L}=s;C=Bo(Zr(C,F,"point")),bn(G,"zip215");const j=Bo(C),W=C[F-1];j[F-1]=W&-129;const D=_n(j),$=G?o:n.ORDER;Ao("point.y",D,nr,$);const k=h(D*D),te=h(k-We),X=h(L*k-z);let{isValid:q,value:Z}=w(te,X);if(!q)throw new Error("bad point: invalid y coordinate");const Q=(Z&We)===We,ue=(W&128)!==0;if(!G&&Z===nr&&ue)throw new Error("bad point: x=0 and x_0=1");return ue!==Q&&(Z=h(-Z)),T.fromAffine({x:Z,y:D})}static fromHex(C,G=!1){return T.fromBytes(at("point",C),G)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(C=8,G=!0){return O.createCache(this,C),G||this.multiply(hs),this}assertValidity(){E(this)}equals(C){_(C);const{X:G,Y:F,Z:z}=this,{X:L,Y:j,Z:W}=C,D=h(G*W),$=h(L*z),k=h(F*W),te=h(j*z);return D===$&&k===te}is0(){return this.equals(T.ZERO)}negate(){return new T(h(-this.X),this.Y,this.Z,h(-this.T))}double(){const{a:C}=s,{X:G,Y:F,Z:z}=this,L=h(G*G),j=h(F*F),W=h(hs*h(z*z)),D=h(C*L),$=G+F,k=h(h($*$)-L-j),te=D+j,X=te-W,q=D-j,Z=h(k*X),Q=h(te*q),ue=h(k*q),le=h(X*te);return new T(Z,Q,le,ue)}add(C){_(C);const{a:G,d:F}=s,{X:z,Y:L,Z:j,T:W}=this,{X:D,Y:$,Z:k,T:te}=C,X=h(z*D),q=h(L*$),Z=h(W*F*te),Q=h(j*k),ue=h((z+L)*(D+$)-X-q),le=Q-Z,J=Q+Z,se=h(q-G*X),oe=h(ue*le),re=h(J*se),ne=h(ue*se),Te=h(le*J);return new T(oe,re,Te,ne)}subtract(C){return this.add(C.negate())}multiply(C){if(!i.isValidNot0(C))throw new Error("invalid scalar: expected 1 <= sc < curve.n");const{p:G,f:F}=O.cached(this,C,z=>Yt(T,z));return Yt(T,[G,F])[0]}multiplyUnsafe(C,G=T.ZERO){if(!i.isValid(C))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return C===nr?T.ZERO:this.is0()||C===We?this:O.unsafe(this,C,F=>Yt(T,F),G)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return O.unsafe(this,s.n).is0()}toAffine(C){return m(this,C)}clearCofactor(){return a===We?this:this.multiplyUnsafe(a)}toBytes(){const{x:C,y:G}=this.toAffine(),F=n.toBytes(G);return F[F.length-1]|=C&We?128:0,F}toHex(){return Qr(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(C){return Yt(T,C)}static msm(C,G){return jc(T,i,C,G)}_setWindowSize(C){this.precompute(C)}toRawBytes(){return this.toBytes()}}T.BASE=new T(s.Gx,s.Gy,We,h(s.Gx*s.Gy)),T.ZERO=new T(nr,We,We,nr),T.Fp=n,T.Fn=i;const O=new Kc(T,i.BITS);return T.BASE.precompute(8),T}function L0(t,e,r={}){if(typeof e!="function")throw new Error('"hash" function param is required');Fn(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:n}=r,{BASE:i,Fp:s,Fn:a}=t,o=r.randomBytes||ha,h=r.adjustScalarBytes||($=>$),w=r.domain||(($,k,te)=>{if(bn(te,"phflag"),k.length||te)throw new Error("Contexts/pre-hash are not supported");return $});function A($){return a.create(_n($))}function _($){const k=F.secretKey;$=at("private key",$,k);const te=at("hashed private key",e($),2*k),X=h(te.slice(0,k)),q=te.slice(k,2*k),Z=A(X);return{head:X,prefix:q,scalar:Z}}function m($){const{head:k,prefix:te,scalar:X}=_($),q=i.multiply(X),Z=q.toBytes();return{head:k,prefix:te,scalar:X,point:q,pointBytes:Z}}function E($){return m($).pointBytes}function T($=Uint8Array.of(),...k){const te=qe(...k);return A(e(w(te,at("context",$),!!n)))}function O($,k,te={}){$=at("message",$),n&&($=n($));const{prefix:X,scalar:q,pointBytes:Z}=m(k),Q=T(te.context,X,$),ue=i.multiply(Q).toBytes(),le=T(te.context,ue,Z,$),J=a.create(Q+le*q);if(!a.isValid(J))throw new Error("sign failed: invalid s");const se=qe(ue,a.toBytes(J));return Zr(se,F.signature,"result")}const Y={zip215:!0};function C($,k,te,X=Y){const{context:q,zip215:Z}=X,Q=F.signature;$=at("signature",$,Q),k=at("message",k),te=at("publicKey",te,F.publicKey),Z!==void 0&&bn(Z,"zip215"),n&&(k=n(k));const ue=Q/2,le=$.subarray(0,ue),J=_n($.subarray(ue,Q));let se,oe,re;try{se=t.fromBytes(te,Z),oe=t.fromBytes(le,Z),re=i.multiplyUnsafe(J)}catch{return!1}if(!Z&&se.isSmallOrder())return!1;const ne=T(q,oe.toBytes(),se.toBytes(),k);return oe.add(se.multiplyUnsafe(ne)).subtract(re).clearCofactor().is0()}const G=s.BYTES,F={secretKey:G,publicKey:G,signature:2*G,seed:G};function z($=o(F.seed)){return Zr($,F.seed,"seed")}function L($){const k=D.randomSecretKey($);return{secretKey:k,publicKey:E(k)}}function j($){return Sn($)&&$.length===a.BYTES}function W($,k){try{return!!t.fromBytes($,k)}catch{return!1}}const D={getExtendedPublicKey:m,randomSecretKey:z,isValidSecretKey:j,isValidPublicKey:W,toMontgomery($){const{y:k}=t.fromBytes($),te=F.publicKey,X=te===32;if(!X&&te!==57)throw new Error("only defined for 25519 and 448");const q=X?s.div(We+k,We-k):s.div(k-We,k+We);return s.toBytes(q)},toMontgomerySecret($){const k=F.secretKey;Zr($,k);const te=e($.subarray(0,k));return h(te).subarray(0,k)},randomPrivateKey:z,precompute($=8,k=t.BASE){return k.precompute($,!1)}};return Object.freeze({keygen:L,getPublicKey:E,sign:O,verify:C,utils:D,Point:t,lengths:F})}function z0(t){const e={a:t.a,d:t.d,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r=t.Fp,n=hr(e.n,t.nBitLength,!0),i={Fp:r,Fn:n,uvRatio:t.uvRatio},s={randomBytes:t.randomBytes,adjustScalarBytes:t.adjustScalarBytes,domain:t.domain,prehash:t.prehash,mapToCurve:t.mapToCurve};return{CURVE:e,curveOpts:i,hash:t.hash,eddsaOpts:s}}function Z0(t,e){const r=e.Point;return Object.assign({},e,{ExtendedPoint:r,CURVE:t,nBitLength:r.Fn.BITS,nByteLength:r.Fn.BYTES})}function D0(t){const{CURVE:e,curveOpts:r,hash:n,eddsaOpts:i}=z0(t),s=W0(e,r),a=L0(s,n,i);return Z0(t,a)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const X0=BigInt(1),Ko=BigInt(2);BigInt(3);const J0=BigInt(5),Q0=BigInt(8),ro=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),Qc={p:ro,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Q0,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function eh(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=ro,o=t*t%s*t%s,h=At(o,Ko,s)*o%s,w=At(h,X0,s)*t%s,A=At(w,J0,s)*w%s,_=At(A,e,s)*A%s,m=At(_,r,s)*_%s,E=At(m,n,s)*m%s,T=At(E,i,s)*E%s,O=At(T,i,s)*E%s,Y=At(O,e,s)*A%s;return{pow_p_5_8:At(Y,Ko,s)*t%s,b2:o}}function th(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const jo=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function rh(t,e){const r=ro,n=$e(e*e*e,r),i=$e(n*n*e,r),s=eh(t*i).pow_p_5_8;let a=$e(t*n*s,r);const o=$e(e*a*a,r),h=a,w=$e(a*jo,r),A=o===t,_=o===$e(-t,r),m=o===$e(-t*jo,r);return A&&(a=h),(_||m)&&(a=w),Yl(a,r)&&(a=$e(-a,r)),{isValid:A||_,value:a}}const nh=hr(Qc.p,{isLE:!0}),ih={...Qc,Fp:nh,hash:vf,adjustScalarBytes:th,uvRatio:rh},qr=D0(ih);var Ho=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},it=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Qe,fn,eu,tu;class sh{constructor(e={}){Qe.set(this,void 0),fn.set(this,void 0),this[eu]=this.entries.bind(this),this[tu]="ExpirableMap";const{source:r=[],expirationTime:n=10*60*1e3}=e,i=Date.now();Ho(this,Qe,new Map([...r].map(([s,a])=>[s,{value:a,timestamp:i}])),"f"),Ho(this,fn,n,"f")}prune(){const e=Date.now();for(const[r,n]of it(this,Qe,"f").entries())e-n.timestamp>it(this,fn,"f")&&it(this,Qe,"f").delete(r);return this}set(e,r){this.prune();const n={value:r,timestamp:Date.now()};return it(this,Qe,"f").set(e,n),this}get(e){const r=it(this,Qe,"f").get(e);if(r!==void 0){if(Date.now()-r.timestamp>it(this,fn,"f")){it(this,Qe,"f").delete(e);return}return r.value}}clear(){it(this,Qe,"f").clear()}entries(){const e=it(this,Qe,"f").entries();return function*(){for(const[n,i]of e)yield[n,i.value]}()}values(){const e=it(this,Qe,"f").values();return function*(){for(const n of e)yield n.value}()}keys(){return it(this,Qe,"f").keys()}forEach(e,r){for(const[n,i]of it(this,Qe,"f").entries())e.call(r,i.value,n,this)}has(e){return it(this,Qe,"f").has(e)}delete(e){return it(this,Qe,"f").delete(e)}get size(){return it(this,Qe,"f").size}}Qe=new WeakMap,fn=new WeakMap,eu=Symbol.iterator,tu=Symbol.toStringTag;const Yo=t=>{if(t<=127)return 1;if(t<=255)return 2;if(t<=65535)return 3;if(t<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")},Wo=(t,e,r)=>{if(r<=127)return t[e]=r,1;if(r<=255)return t[e]=129,t[e+1]=r,2;if(r<=65535)return t[e]=130,t[e+1]=r>>8,t[e+2]=r,3;if(r<=16777215)return t[e]=131,t[e+1]=r>>16,t[e+2]=r>>8,t[e+3]=r,4;throw new Error("Length too long (> 4 bytes)")},Ms=(t,e)=>{if(t[e]<128)return 1;if(t[e]===128)throw new Error("Invalid length 0");if(t[e]===129)return 2;if(t[e]===130)return 3;if(t[e]===131)return 4;throw new Error("Length too long (> 4 bytes)")},oh=(t,e)=>{const r=Ms(t,e);if(r===1)return t[e];if(r===2)return t[e+1];if(r===3)return(t[e+1]<<8)+t[e+2];if(r===4)return(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];throw new Error("Length too long (> 4 bytes)")};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);const Bi=Uint8Array.from([48,5,6,3,43,101,112]);Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);function ru(t,e){const r=2+Yo(t.byteLength+1),n=e.byteLength+r+t.byteLength;let i=0;const s=new Uint8Array(1+Yo(n)+n);return s[i++]=48,i+=Wo(s,i,n),s.set(e,i),i+=e.byteLength,s[i++]=3,i+=Wo(s,i,t.byteLength+1),s[i++]=0,s.set(new Uint8Array(t),i),s}const nu=(t,e)=>{let r=0;const n=(o,h)=>{if(i[r++]!==o)throw new Error("Expected: "+h)},i=new Uint8Array(t);if(n(48,"sequence"),r+=Ms(i,r),!In(i.slice(r,r+e.byteLength),e))throw new Error("Not the expected OID.");r+=e.byteLength,n(3,"bit string");const s=oh(i,r)-1;r+=Ms(i,r),n(0,"0 padding");const a=i.slice(r);if(s!==a.length)throw new Error(`DER payload mismatch: Expected length ${s} actual length ${a.length}`);return a};var Lo=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},zo=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Qn,ei;let iu=class ln{constructor(e){if(Qn.set(this,void 0),ei.set(this,void 0),e.byteLength!==ln.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");Lo(this,Qn,e,"f"),Lo(this,ei,ln.derEncode(e),"f")}static from(e){return this.fromDer(e.toDer())}static fromRaw(e){return new ln(e)}static fromDer(e){return new ln(this.derDecode(e))}static derEncode(e){return ru(e,Bi).buffer}static derDecode(e){const r=nu(e,Bi);if(r.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return r}get rawKey(){return zo(this,Qn,"f")}get derKey(){return zo(this,ei,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}};Qn=new WeakMap,ei=new WeakMap;iu.RAW_KEY_LENGTH=32;class ah{constructor(){this.observers=[]}subscribe(e){this.observers.push(e)}unsubscribe(e){this.observers=this.observers.filter(r=>r!==e)}notify(e,...r){this.observers.forEach(n=>n(e,...r))}}class ch extends ah{constructor(){super()}print(e,...r){this.notify({message:e,level:"info"},...r)}warn(e,...r){this.notify({message:e,level:"warn"},...r)}error(e,r,...n){this.notify({message:e,level:"error",error:r},...n)}}var Tt=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Je=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},St,ti,ri,ni,ii,si,oi,ai,Vr;const su=.5,ou=1.5,au=500,cu=6e4,uu=9e5,fu=10;class Ki{constructor(e=Ki.default){St.set(this,void 0),ti.set(this,void 0),ri.set(this,void 0),ni.set(this,void 0),ii.set(this,void 0),si.set(this,void 0),oi.set(this,void 0),ai.set(this,void 0),Vr.set(this,0);const{initialInterval:r=au,randomizationFactor:n=su,multiplier:i=ou,maxInterval:s=cu,maxElapsedTime:a=uu,maxIterations:o=fu,date:h=Date}=e;Tt(this,St,r,"f"),Tt(this,ti,n,"f"),Tt(this,ri,i,"f"),Tt(this,ni,s,"f"),Tt(this,ai,h,"f"),Tt(this,ii,h.now(),"f"),Tt(this,si,a,"f"),Tt(this,oi,o,"f")}get ellapsedTimeInMsec(){return Je(this,ai,"f").now()-Je(this,ii,"f")}get currentInterval(){return Je(this,St,"f")}get count(){return Je(this,Vr,"f")}get randomValueFromInterval(){const e=Je(this,ti,"f")*Je(this,St,"f"),r=Je(this,St,"f")-e,n=Je(this,St,"f")+e;return Math.random()*(n-r)+r}incrementCurrentInterval(){var e;return Tt(this,St,Math.min(Je(this,St,"f")*Je(this,ri,"f"),Je(this,ni,"f")),"f"),Tt(this,Vr,(e=Je(this,Vr,"f"),e++,e),"f"),Je(this,St,"f")}next(){return this.ellapsedTimeInMsec>=Je(this,si,"f")||Je(this,Vr,"f")>=Je(this,oi,"f")?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}}St=new WeakMap,ti=new WeakMap,ri=new WeakMap,ni=new WeakMap,ii=new WeakMap,si=new WeakMap,oi=new WeakMap,ai=new WeakMap,Vr=new WeakMap;Ki.default={initialInterval:au,randomizationFactor:su,multiplier:ou,maxInterval:cu,maxElapsedTime:uu,maxIterations:fu,date:Date};var ze=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},ie=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},et,dr,Dr,Nt,$t,zr,hn,Gr,bt,_t,pr,yr,dn,Kr,jr,wr,mr,lu,ci,ui,gr,qt;(function(t){t.Received="received",t.Processing="processing",t.Replied="replied",t.Rejected="rejected",t.Unknown="unknown",t.Done="done"})(qt||(qt={}));const Yn=60*1e3,uh="308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae",fh="aaaaa-aa",lh="ic0.app",hh=".ic0.app",dh="icp0.io",ph=".icp0.io",yh="icp-api.io",wh=".icp-api.io";class ds extends Me{constructor(e){super(e),this.message=e}}class Wn extends Me{constructor(e){super(e),this.message=e}}function gh(){let t;if(typeof window<"u")if(window.fetch)t=window.fetch.bind(window);else throw new ds("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.");else if(typeof global<"u")if(global.fetch)t=global.fetch.bind(global);else throw new ds("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.");else typeof self<"u"&&self.fetch&&(t=self.fetch.bind(self));if(t)return t;throw new ds("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.")}function mh(t){let e;if(t!==void 0)!t.match(/^[a-z]+:/)&&typeof window<"u"?e=new URL(window.location.protocol+"//"+t):e=new URL(t);else{const r=["ic0.app","icp0.io","127.0.0.1","localhost"],n=[".github.dev",".gitpod.io"],i=typeof window<"u"?window.location:void 0,s=i==null?void 0:i.hostname;let a;s&&typeof s=="string"&&(n.some(o=>s.endsWith(o))?a=s:a=r.find(o=>s.endsWith(o))),i&&a?e=new URL(`${i.protocol}//${a}${i.port?":"+i.port:""}`):e=new URL("https://icp-api.io")}return e.toString()}class pn{constructor(e={}){var r,n;et.add(this),dr.set(this,null),Dr.set(this,!1),Nt.set(this,void 0),$t.set(this,void 0),zr.set(this,void 0),hn.set(this,void 0),Gr.set(this,0),bt.set(this,void 0),_t.set(this,void 0),pr.set(this,void 0),yr.set(this,void 0),this._isAgent=!0,this.config={},dn.set(this,0),this.log=new ch,Kr.set(this,[]),jr.set(this,[]),wr.set(this,new sh({expirationTime:5*60*1e3})),mr.set(this,!0),ui.set(this,(a,o)=>{if(ie(this,mr,"f")===!1)return a;if(!o)throw new Rt("Invalid signature from replica signed query: no matching node key found.");const{status:h,signatures:w=[],requestId:A}=a,_=jt(new TextEncoder().encode("\vic-response"));for(const m of w){const{timestamp:E,identity:T}=m,O=be.fromUint8Array(T).toText();let Y;if(h==="replied"){const{reply:L}=a;Y=gi({status:h,reply:L,timestamp:BigInt(E),request_id:A})}else if(h==="rejected"){const{reject_code:L,reject_message:j,error_code:W}=a;Y=gi({status:h,reject_code:L,reject_message:j,error_code:W,timestamp:BigInt(E),request_id:A})}else throw new Error(`Unknown status: ${h}`);const C=Et(_,jt(new Uint8Array(Y))),G=o==null?void 0:o.nodeKeys.get(O);if(!G)throw new Rt("Invalid signature from replica signed query: no matching node key found.");const F=iu.fromDer(G).rawKey;if(qr.verify(m.signature,new Uint8Array(C),new Uint8Array(F)))return a;throw new Rt(`Invalid signature from replica ${O} signed query.`)}return a}),this.config=e,ze(this,$t,e.fetch||gh()||fetch.bind(global),"f"),ze(this,zr,e.fetchOptions,"f"),ze(this,hn,e.callOptions,"f"),ze(this,Dr,(r=e.shouldFetchRootKey)!==null&&r!==void 0?r:!1,"f"),e.rootKey?this.rootKey=e.rootKey:ie(this,Dr,"f")?this.rootKey=null:this.rootKey=zt(uh);const i=mh(e.host);this.host=new URL(i),e.verifyQuerySignatures!==void 0&&ze(this,mr,e.verifyQuerySignatures,"f"),ze(this,_t,(n=e.retryTimes)!==null&&n!==void 0?n:3,"f");const s=()=>new Ki({maxIterations:ie(this,_t,"f")});if(ze(this,pr,e.backoffStrategy||s,"f"),this.host.hostname.endsWith(hh)?this.host.hostname=lh:this.host.hostname.endsWith(ph)?this.host.hostname=dh:this.host.hostname.endsWith(wh)&&(this.host.hostname=yh),e.credentials){const{name:a,password:o}=e.credentials;ze(this,bt,`${a}${o?":"+o:""}`,"f")}if(ze(this,Nt,Promise.resolve(e.identity||new mi),"f"),e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes>5)throw new Me(`The maximum ingress expiry time is 5 minutes. Provided ingress expiry time is ${e.ingressExpiryInMinutes} minutes.`);if(e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes<=0)throw new Me(`Ingress expiry time must be greater than 0. Provided ingress expiry time is ${e.ingressExpiryInMinutes} minutes.`);ze(this,yr,e.ingressExpiryInMinutes||5,"f"),this.addTransform("update",vo(Os)),e.useQueryNonces&&this.addTransform("query",vo(Os)),e.logToConsole&&this.log.subscribe(a=>{a.level==="error"?console.error(a.message):a.level==="warn"?console.warn(a.message):console.log(a.message)})}get waterMark(){return ie(this,dn,"f")}static createSync(e={}){return new this(Object.assign({},e))}static async create(e={shouldFetchRootKey:!1}){const r=pn.createSync(e),n=[r.syncTime()];return r.host.toString()!=="https://icp-api.io"&&e.shouldFetchRootKey&&n.push(r.fetchRootKey()),await Promise.all(n),r}static async from(e){var r;try{return"config"in e?await pn.create(e.config):await pn.create({fetch:e._fetch,fetchOptions:e._fetchOptions,callOptions:e._callOptions,host:e._host.toString(),identity:(r=e._identity)!==null&&r!==void 0?r:void 0})}catch{throw new Me("Failed to create agent from provided agent")}}isLocal(){const e=this.host.hostname;return e==="127.0.0.1"||e.endsWith("127.0.0.1")}addTransform(e,r,n=r.priority||0){if(e==="update"){const i=ie(this,jr,"f").findIndex(s=>(s.priority||0)<n);ie(this,jr,"f").splice(i>=0?i:ie(this,jr,"f").length,0,Object.assign(r,{priority:n}))}else if(e==="query"){const i=ie(this,Kr,"f").findIndex(s=>(s.priority||0)<n);ie(this,Kr,"f").splice(i>=0?i:ie(this,Kr,"f").length,0,Object.assign(r,{priority:n}))}}async getPrincipal(){if(!ie(this,Nt,"f"))throw new Wn("This identity has expired due this application's security policy. Please refresh your authentication.");return(await ie(this,Nt,"f")).getPrincipal()}async call(e,r,n){var i,s;await ie(this,et,"m",gr).call(this);const a=(i=r.callSync)!==null&&i!==void 0?i:!0,o=await(n!==void 0?await n:await ie(this,Nt,"f"));if(!o)throw new Wn("This identity has expired due this application's security policy. Please refresh your authentication.");const h=be.from(e),w=r.effectiveCanisterId?be.from(r.effectiveCanisterId):h,A=o.getPrincipal()||be.anonymous();let _=new jn(ie(this,yr,"f")*Yn);Math.abs(ie(this,Gr,"f"))>1e3*30&&(_=new jn(ie(this,yr,"f")*Yn+ie(this,Gr,"f")));const m={request_type:Us.Call,canister_id:h,method_name:r.methodName,arg:r.arg,sender:A,ingress_expiry:_};let E=await this._transform({request:{body:null,method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ie(this,bt,"f")?{Authorization:"Basic "+btoa(ie(this,bt,"f"))}:{})},endpoint:"call",body:m}),T;r!=null&&r.nonce?T=O(r.nonce):E.body.nonce?T=O(E.body.nonce):T=void 0,m.nonce=T;function O(F){return new Uint8Array(F)}E=await o.transformRequest(E);const Y=ts(E.body),C=ie(this,pr,"f").call(this),G=mn(m);try{const F=()=>(this.log.print(`fetching "/api/v3/canister/${w.toText()}/call" with request:`,E),ie(this,$t,"f").call(this,""+new URL(`/api/v3/canister/${w.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},ie(this,hn,"f")),E.request),{body:Y}))),z=()=>(this.log.print(`fetching "/api/v2/canister/${w.toText()}/call" with request:`,E),ie(this,$t,"f").call(this,""+new URL(`/api/v2/canister/${w.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},ie(this,hn,"f")),E.request),{body:Y}))),j=await ie(this,et,"m",ci).call(this,{request:a?F:z,backoff:C,tries:0}),W=await j.arrayBuffer(),D=j.status===200&&W.byteLength>0?Ht(W):null;if(D&&"certificate"in D){const $=await this.parseTimeFromResponse({certificate:D.certificate});ze(this,dn,$,"f")}return{requestId:G,response:{ok:j.ok,status:j.status,statusText:j.statusText,body:D,headers:cn(j.headers)},requestDetails:m}}catch(F){if(F.message.includes("v3 api not supported."))return this.log.warn("v3 api not supported. Fall back to v2"),this.call(e,Object.assign(Object.assign({},r),{callSync:!1}),n);const z=`Error while making call: ${(s=F.message)!==null&&s!==void 0?s:String(F)}`,L=new kl(z,F,ke(G),ke(E.body.sender_pubkey),ke(E.body.sender_sig),String(E.body.content.ingress_expiry._value));throw this.log.error(z,L),L}}async query(e,r,n){var i,s,a,o;await ie(this,et,"m",gr).call(this);const h=ie(this,pr,"f").call(this),w=r.effectiveCanisterId?be.from(r.effectiveCanisterId):be.from(e);this.log.print(`ecid ${w.toString()}`),this.log.print(`canisterId ${e.toString()}`);let A,_;const m=await(n!==void 0?n:ie(this,Nt,"f"));if(!m)throw new Wn("This identity has expired due this application's security policy. Please refresh your authentication.");const E=be.from(e),T=(m==null?void 0:m.getPrincipal())||be.anonymous(),O={request_type:"query",canister_id:E,method_name:r.methodName,arg:r.arg,sender:T,ingress_expiry:new jn(ie(this,yr,"f")*Yn)},Y=mn(O);A=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ie(this,bt,"f")?{Authorization:"Basic "+btoa(ie(this,bt,"f"))}:{})},endpoint:"read",body:O}),A=await(m==null?void 0:m.transformRequest(A));const C=ts(A.body),G={canister:E.toText(),ecid:w,transformedRequest:A,body:C,requestId:Y,backoff:h,tries:0},F=async()=>({requestDetails:O,query:await ie(this,et,"m",lu).call(this,G)}),z=async()=>{if(!ie(this,mr,"f"))return;const L=ie(this,wr,"f").get(w.toString());return L||(await this.fetchSubnetKeys(w.toString()),ie(this,wr,"f").get(w.toString()))};try{const[L,j]=await Promise.all([F(),z()]);_=L;const{requestDetails:W,query:D}=_,$=Object.assign(Object.assign({},D),{requestDetails:W});if(this.log.print("Query response:",$),!ie(this,mr,"f"))return $;try{return ie(this,ui,"f").call(this,$,j)}catch{this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),ie(this,wr,"f").delete(e.toString()),await this.fetchSubnetKeys(w.toString());const te=ie(this,wr,"f").get(e.toString());if(!te)throw new Rt("Invalid signature from replica signed query: no matching node key found.");return ie(this,ui,"f").call(this,$,te)}}catch(L){const j=`Error while making call: ${(i=L.message)!==null&&i!==void 0?i:String(L)}`,W=new Ml(j,L,String(Y),ke((s=A==null?void 0:A.body)===null||s===void 0?void 0:s.sender_pubkey),ke((a=A==null?void 0:A.body)===null||a===void 0?void 0:a.sender_sig),String((o=A==null?void 0:A.body)===null||o===void 0?void 0:o.content.ingress_expiry._value));throw this.log.error(j,W),W}}async createReadStateRequest(e,r){await ie(this,et,"m",gr).call(this);const n=await(r!==void 0?await r:await ie(this,Nt,"f"));if(!n)throw new Wn("This identity has expired due this application's security policy. Please refresh your authentication.");const i=(n==null?void 0:n.getPrincipal())||be.anonymous(),s=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},ie(this,bt,"f")?{Authorization:"Basic "+btoa(ie(this,bt,"f"))}:{})},endpoint:"read_state",body:{request_type:"read_state",paths:e.paths,sender:i,ingress_expiry:new jn(ie(this,yr,"f")*Yn)}});return n==null?void 0:n.transformRequest(s)}async readState(e,r,n,i){var s,a,o,h;function w(O){for(const Y of O.paths){const[C,G]=Y,F=jt(new TextEncoder().encode("request_status"));if(In(C,F))return G}}const A=w(r);await ie(this,et,"m",gr).call(this);const _=typeof e=="string"?be.fromText(e):e,m=i??await this.createReadStateRequest(r,n),E=ts(m.body);this.log.print(`fetching "/api/v2/canister/${_}/read_state" with request:`,m);const T=ie(this,pr,"f").call(this);try{const O=await ie(this,et,"m",ci).call(this,{request:()=>ie(this,$t,"f").call(this,""+new URL(`/api/v2/canister/${_.toString()}/read_state`,this.host),Object.assign(Object.assign(Object.assign({},ie(this,zr,"f")),m.request),{body:E})),backoff:T,tries:0});if(!O.ok)throw new Error(`Server returned an error:
  Code: ${O.status} (${O.statusText})
  Body: ${await O.text()}
`);const Y=Ht(await O.arrayBuffer());this.log.print("Read state response:",Y);const C=await this.parseTimeFromResponse(Y);return C>0&&(this.log.print("Read state response time:",C),ze(this,dn,C,"f")),Y}catch(O){const Y=`Caught exception while attempting to read state: ${(s=O.message)!==null&&s!==void 0?s:String(O)}`,C=new Cl(Y,O,String(A),ke((a=m==null?void 0:m.body)===null||a===void 0?void 0:a.sender_pubkey),ke((o=m==null?void 0:m.body)===null||o===void 0?void 0:o.sender_sig),String((h=m==null?void 0:m.body)===null||h===void 0?void 0:h.content.ingress_expiry._value));throw this.log.error(Y,C),C}}async parseTimeFromResponse(e){let r;if(e.certificate){const n=Ht(e.certificate);if(n&&"tree"in n)r=n.tree;else throw new Error("Could not decode time from response");const i=rn(["time"],r);if(i.status!==Ke.Found)throw new Error("Time was not found in the response or was not in its expected format.");if(!(i.value instanceof ArrayBuffer)&&!ArrayBuffer.isView(i))throw new Error("Time was not found in the response or was not in its expected format.");const s=to(jt(i.value));return this.log.print("Time from response:",s),this.log.print("Time from response in milliseconds:",Number(s)),Number(s)}else this.log.warn("No certificate found in response");return 0}async syncTime(e){await ie(this,et,"m",gr).call(this);const r=await Ku(()=>Promise.resolve().then(()=>j0),void 0),n=Date.now();try{e||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const i=pn.createSync({identity:new mi,host:this.host.toString(),fetch:ie(this,$t,"f"),retryTimes:0}),a=(await r.request({canisterId:e??be.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),agent:i,paths:["time"]})).get("time");a&&(ze(this,Gr,Number(a)-Number(n),"f"),this.log.notify({message:`Syncing time: offset of ${ie(this,Gr,"f")}`,level:"info"}))}catch(i){this.log.error("Caught exception while attempting to sync time",i)}}async status(){const e=ie(this,bt,"f")?{Authorization:"Basic "+btoa(ie(this,bt,"f"))}:{};this.log.print('fetching "/api/v2/status"');const r=ie(this,pr,"f").call(this),n=await ie(this,et,"m",ci).call(this,{backoff:r,request:()=>ie(this,$t,"f").call(this,""+new URL("/api/v2/status",this.host),Object.assign({headers:e},ie(this,zr,"f"))),tries:0});return Ht(await n.arrayBuffer())}async fetchRootKey(){let e;return ie(this,dr,"f")?e=await ie(this,dr,"f"):(ze(this,dr,new Promise((r,n)=>{this.status().then(i=>{const s=i.root_key;this.rootKey=s,r(s)}).catch(n)}),"f"),e=await ie(this,dr,"f")),ze(this,dr,null,"f"),e}invalidateIdentity(){ze(this,Nt,null,"f")}replaceIdentity(e){ze(this,Nt,Promise.resolve(e),"f")}async fetchSubnetKeys(e){await ie(this,et,"m",gr).call(this);const r=be.from(e),i=(await Dc({canisterId:r,paths:["subnet"],agent:this})).get("subnet");if(i&&typeof i=="object"&&"nodeKeys"in i)return ie(this,wr,"f").set(r.toText(),i),i}_transform(e){let r=Promise.resolve(e);if(e.endpoint==="call")for(const n of ie(this,jr,"f"))r=r.then(i=>n(i).then(s=>s||i));else for(const n of ie(this,Kr,"f"))r=r.then(i=>n(i).then(s=>s||i));return r}}dr=new WeakMap,Dr=new WeakMap,Nt=new WeakMap,$t=new WeakMap,zr=new WeakMap,hn=new WeakMap,Gr=new WeakMap,bt=new WeakMap,_t=new WeakMap,pr=new WeakMap,yr=new WeakMap,dn=new WeakMap,Kr=new WeakMap,jr=new WeakMap,wr=new WeakMap,mr=new WeakMap,ui=new WeakMap,et=new WeakSet,lu=async function t(e){var r,n;const{ecid:i,transformedRequest:s,body:a,requestId:o,backoff:h,tries:w}=e,A=w===0?0:h.next();if(this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with tries:`,{tries:w,backoff:h,delay:A}),A===null)throw new Me(`Timestamp failed to pass the watermark after retrying the configured ${ie(this,_t,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);A>0&&await new Promise(T=>setTimeout(T,A));let _;try{this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with request:`,s);const T=await ie(this,$t,"f").call(this,""+new URL(`/api/v2/canister/${i.toString()}/query`,this.host),Object.assign(Object.assign(Object.assign({},ie(this,zr,"f")),s.request),{body:a}));if(T.status===200){const O=Ht(await T.arrayBuffer());_=Object.assign(Object.assign({},O),{httpDetails:{ok:T.ok,status:T.status,statusText:T.statusText,headers:cn(T.headers)},requestId:o})}else throw new rs(`Gateway returned an error:
  Code: ${T.status} (${T.statusText})
  Body: ${await T.text()}
`,{ok:T.ok,status:T.status,statusText:T.statusText,headers:cn(T.headers)})}catch(T){if(w<ie(this,_t,"f"))return this.log.warn(`Caught exception while attempting to make query:
  ${T}
  Retrying query.`),await ie(this,et,"m",t).call(this,Object.assign(Object.assign({},e),{tries:w+1}));throw T}const m=(n=(r=_.signatures)===null||r===void 0?void 0:r[0])===null||n===void 0?void 0:n.timestamp;if(!ie(this,mr,"f"))return _;if(!m)throw new Error("Timestamp not found in query response. This suggests a malformed or malicious response.");const E=Number(BigInt(m)/BigInt(1e6));if(this.log.print("watermark and timestamp",{waterMark:this.waterMark,timestamp:E}),Number(this.waterMark)>E){const T=new Me("Timestamp is below the watermark. Retrying query.");if(this.log.error("Timestamp is below",T,{timestamp:m,waterMark:this.waterMark}),w<ie(this,_t,"f"))return await ie(this,et,"m",t).call(this,Object.assign(Object.assign({},e),{tries:w+1}));throw new Me(`Timestamp failed to pass the watermark after retrying the configured ${ie(this,_t,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`)}return _},ci=async function t(e){const{request:r,backoff:n,tries:i}=e,s=i===0?0:n.next();if(s===null)throw new Me(`Timestamp failed to pass the watermark after retrying the configured ${ie(this,_t,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);s>0&&await new Promise(w=>setTimeout(w,s));let a;try{a=await r()}catch(w){if(ie(this,_t,"f")>i)return this.log.warn(`Caught exception while attempting to make request:
  ${w}
  Retrying request.`),await ie(this,et,"m",t).call(this,{request:r,backoff:n,tries:i+1});throw w}if(a.ok)return a;const o=await a.clone().text(),h=`Server returned an error:
  Code: ${a.status} (${a.statusText})
  Body: ${o}
`;if(a.status===404&&a.url.includes("api/v3"))throw new rs("v3 api not supported. Fall back to v2",{ok:a.ok,status:a.status,statusText:a.statusText,headers:cn(a.headers)});if(i<ie(this,_t,"f"))return await ie(this,et,"m",t).call(this,{request:r,backoff:n,tries:i+1});throw new rs(h,{ok:a.ok,status:a.status,statusText:a.statusText,headers:cn(a.headers)})},gr=async function(){if(!this.rootKey)if(this.rootKey===null&&ie(this,Dr,"f"))await this.fetchRootKey();else throw new Me(`Invalid root key detected. The root key for this agent is ${this.rootKey} and the shouldFetchRootKey value is set to ${ie(this,Dr,"f")}. The root key should only be unknown if you are in local development. Otherwise you should avoid fetching and use the default IC Root Key or the known root key of your environment.`)};var Zo;(function(t){t.Error="err",t.GetPrincipal="gp",t.GetPrincipalResponse="gpr",t.Query="q",t.QueryResponse="qr",t.Call="c",t.CallResponse="cr",t.ReadState="rs",t.ReadStateResponse="rsr",t.Status="s",t.StatusResponse="sr"})(Zo||(Zo={}));function Do(){const t=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.ic.agent:global.ic.agent:window.ic.agent;if(!t)throw new Error("No Agent could be found.");return t}const bh=5*60*1e3;function hu(){return Bh(xh(_h(),1e3),vh(1e3,1.2),Eh(bh))}function _h(){let t=!0;return async()=>t?(t=!1,!0):!1}function xh(t,e){return async(r,n,i)=>{if(await t(r,n,i))return new Promise(s=>setTimeout(s,e))}}function Eh(t){const e=Date.now()+t;return async(r,n,i)=>{if(Date.now()>e)throw new Error(`Request timed out after ${t} msec:
  Request ID: ${ke(n)}
  Request status: ${i}
`)}}function vh(t,e){let r=t;return()=>new Promise(n=>setTimeout(()=>{r*=e,n()},r))}function Bh(...t){return async(e,r,n)=>{for(const i of t)await i(e,r,n)}}async function du(t,e,r,n=hu(),i,s){var a;const o=[new TextEncoder().encode("request_status"),r],h=i??await((a=t.createReadStateRequest)===null||a===void 0?void 0:a.call(t,{paths:[o]})),w=await t.readState(e,{paths:[o]},void 0,h);if(t.rootKey==null)throw new Error("Agent root key not initialized before polling");const A=await Er.create({certificate:w.certificate,rootKey:t.rootKey,canisterId:e,blsVerify:s}),_=dt(A.lookup([...o,new TextEncoder().encode("status")]));let m;switch(typeof _>"u"?m=qt.Unknown:m=new TextDecoder().decode(_),m){case qt.Replied:return{reply:dt(A.lookup([...o,"reply"])),certificate:A};case qt.Received:case qt.Unknown:case qt.Processing:return await n(e,r,m),du(t,e,r,n,h,s);case qt.Rejected:{const E=new Uint8Array(dt(A.lookup([...o,"reject_code"])))[0],T=new TextDecoder().decode(dt(A.lookup([...o,"reject_message"])));throw new Error(`Call was rejected:
  Request ID: ${ke(r)}
  Reject code: ${E}
  Reject text: ${T}
`)}case qt.Done:throw new Error(`Call was marked as done but we never saw the reply:
  Request ID: ${ke(r)}
`)}throw new Error("unreachable")}const Ah=({IDL:t})=>{const e=t.Variant({mainnet:t.Null,testnet:t.Null}),r=t.Text,n=t.Record({network:e,address:r,min_confirmations:t.Opt(t.Nat32)}),i=t.Nat64,s=i,a=t.Nat32,o=t.Record({start_height:a,end_height:t.Opt(a),network:e}),h=t.Vec(t.Nat8),w=t.Record({tip_height:a,block_headers:t.Vec(h)}),A=t.Record({network:e}),_=t.Nat64,m=t.Vec(_),E=t.Record({network:e,filter:t.Opt(t.Variant({page:t.Vec(t.Nat8),min_confirmations:t.Nat32})),address:r}),T=t.Vec(t.Nat8),O=t.Record({txid:t.Vec(t.Nat8),vout:t.Nat32}),Y=t.Record({height:t.Nat32,value:i,outpoint:O}),C=t.Record({next_page:t.Opt(t.Vec(t.Nat8)),tip_height:a,tip_block_hash:T,utxos:t.Vec(Y)}),G=t.Record({transaction:t.Vec(t.Nat8),network:e}),F=t.Principal,z=t.Record({canister_id:F,num_requested_changes:t.Opt(t.Nat64)}),L=t.Variant({from_user:t.Record({user_id:t.Principal}),from_canister:t.Record({canister_version:t.Opt(t.Nat64),canister_id:t.Principal})}),j=t.Vec(t.Nat8),W=t.Variant({creation:t.Record({controllers:t.Vec(t.Principal)}),code_deployment:t.Record({mode:t.Variant({reinstall:t.Null,upgrade:t.Null,install:t.Null}),module_hash:t.Vec(t.Nat8)}),load_snapshot:t.Record({canister_version:t.Nat64,taken_at_timestamp:t.Nat64,snapshot_id:j}),controllers_change:t.Record({controllers:t.Vec(t.Principal)}),code_uninstall:t.Null}),D=t.Record({timestamp_nanos:t.Nat64,canister_version:t.Nat64,origin:L,details:W}),$=t.Record({controllers:t.Vec(t.Principal),module_hash:t.Opt(t.Vec(t.Nat8)),recent_changes:t.Vec(D),total_num_changes:t.Nat64}),k=t.Record({canister_id:F}),te=t.Variant({controllers:t.Null,public:t.Null,allowed_viewers:t.Vec(t.Principal)}),X=t.Record({freezing_threshold:t.Nat,controllers:t.Vec(t.Principal),reserved_cycles_limit:t.Nat,log_visibility:te,wasm_memory_limit:t.Nat,memory_allocation:t.Nat,compute_allocation:t.Nat}),q=t.Record({status:t.Variant({stopped:t.Null,stopping:t.Null,running:t.Null}),memory_size:t.Nat,cycles:t.Nat,settings:X,query_stats:t.Record({response_payload_bytes_total:t.Nat,num_instructions_total:t.Nat,num_calls_total:t.Nat,request_payload_bytes_total:t.Nat}),idle_cycles_burned_per_day:t.Nat,module_hash:t.Opt(t.Vec(t.Nat8)),reserved_cycles:t.Nat}),Z=t.Record({canister_id:F}),Q=t.Record({freezing_threshold:t.Opt(t.Nat),controllers:t.Opt(t.Vec(t.Principal)),reserved_cycles_limit:t.Opt(t.Nat),log_visibility:t.Opt(te),wasm_memory_limit:t.Opt(t.Nat),memory_allocation:t.Opt(t.Nat),compute_allocation:t.Opt(t.Nat)}),ue=t.Record({settings:t.Opt(Q),sender_canister_version:t.Opt(t.Nat64)}),le=t.Record({canister_id:F}),J=t.Record({canister_id:F}),se=t.Record({canister_id:F,snapshot_id:j}),oe=t.Record({canister_id:F}),re=t.Variant({secp256k1:t.Null}),ne=t.Record({key_id:t.Record({name:t.Text,curve:re}),canister_id:t.Opt(F),derivation_path:t.Vec(t.Vec(t.Nat8))}),Te=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),x=t.Record({canister_id:F}),me=t.Record({idx:t.Nat64,timestamp_nanos:t.Nat64,content:t.Vec(t.Nat8)}),Fe=t.Record({canister_log_records:t.Vec(me)}),Pe=t.Record({value:t.Text,name:t.Text}),ae=t.Record({status:t.Nat,body:t.Vec(t.Nat8),headers:t.Vec(Pe)}),ce=t.Record({url:t.Text,method:t.Variant({get:t.Null,head:t.Null,post:t.Null}),max_response_bytes:t.Opt(t.Nat64),body:t.Opt(t.Vec(t.Nat8)),transform:t.Opt(t.Record({function:t.Func([t.Record({context:t.Vec(t.Nat8),response:ae})],[ae],["query"]),context:t.Vec(t.Nat8)})),headers:t.Vec(Pe)}),b=t.Variant({reinstall:t.Null,upgrade:t.Opt(t.Record({wasm_memory_persistence:t.Opt(t.Variant({keep:t.Null,replace:t.Null})),skip_pre_upgrade:t.Opt(t.Bool)})),install:t.Null}),B=t.Record({hash:t.Vec(t.Nat8)}),N=t.Record({arg:t.Vec(t.Nat8),wasm_module_hash:t.Vec(t.Nat8),mode:b,chunk_hashes_list:t.Vec(B),target_canister:F,store_canister:t.Opt(F),sender_canister_version:t.Opt(t.Nat64)}),P=t.Vec(t.Nat8),U=t.Record({arg:t.Vec(t.Nat8),wasm_module:P,mode:b,canister_id:F,sender_canister_version:t.Opt(t.Nat64)}),M=t.Record({canister_id:F}),d=t.Record({id:j,total_size:t.Nat64,taken_at_timestamp:t.Nat64}),c=t.Vec(d),u=t.Record({canister_id:F,sender_canister_version:t.Opt(t.Nat64),snapshot_id:j}),y=t.Record({start_at_timestamp_nanos:t.Nat64,subnet_id:t.Principal}),g=t.Record({num_block_failures_total:t.Nat64,node_id:t.Principal,num_blocks_proposed_total:t.Nat64}),S=t.Vec(t.Record({timestamp_nanos:t.Nat64,node_metrics:t.Vec(g)})),V=t.Record({settings:t.Opt(Q),specified_id:t.Opt(F),amount:t.Opt(t.Nat),sender_canister_version:t.Opt(t.Nat64)}),ee=t.Record({canister_id:F}),fe=t.Record({canister_id:F,amount:t.Nat}),he=t.Vec(t.Nat8),ge=t.Variant({ed25519:t.Null,bip340secp256k1:t.Null}),p=t.Record({key_id:t.Record({algorithm:ge,name:t.Text}),canister_id:t.Opt(F),derivation_path:t.Vec(t.Vec(t.Nat8))}),f=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),l=t.Record({key_id:t.Record({name:t.Text,curve:re}),derivation_path:t.Vec(t.Vec(t.Nat8)),message_hash:t.Vec(t.Nat8)}),v=t.Record({signature:t.Vec(t.Nat8)}),R=t.Variant({bip341:t.Record({merkle_root_hash:t.Vec(t.Nat8)})}),H=t.Record({aux:t.Opt(R),key_id:t.Record({algorithm:ge,name:t.Text}),derivation_path:t.Vec(t.Vec(t.Nat8)),message:t.Vec(t.Nat8)}),K=t.Record({signature:t.Vec(t.Nat8)}),ye=t.Record({canister_id:F}),_e=t.Record({canister_id:F}),we=t.Record({canister_id:F}),pe=t.Vec(B),Se=t.Record({subnet_id:t.Principal}),Oe=t.Record({replica_version:t.Text}),Hi=t.Record({replace_snapshot:t.Opt(j),canister_id:F}),Yi=d,Wi=t.Record({canister_id:F,sender_canister_version:t.Opt(t.Nat64)}),Li=t.Record({canister_id:t.Principal,settings:Q,sender_canister_version:t.Opt(t.Nat64)}),zi=t.Record({chunk:t.Vec(t.Nat8),canister_id:t.Principal}),Xt=B;return t.Service({bitcoin_get_balance:t.Func([n],[s],[]),bitcoin_get_block_headers:t.Func([o],[w],[]),bitcoin_get_current_fee_percentiles:t.Func([A],[m],[]),bitcoin_get_utxos:t.Func([E],[C],[]),bitcoin_send_transaction:t.Func([G],[],[]),canister_info:t.Func([z],[$],[]),canister_status:t.Func([k],[q],[]),clear_chunk_store:t.Func([Z],[],[]),create_canister:t.Func([ue],[le],[]),delete_canister:t.Func([J],[],[]),delete_canister_snapshot:t.Func([se],[],[]),deposit_cycles:t.Func([oe],[],[]),ecdsa_public_key:t.Func([ne],[Te],[]),fetch_canister_logs:t.Func([x],[Fe],["query"]),http_request:t.Func([ce],[ae],[]),install_chunked_code:t.Func([N],[],[]),install_code:t.Func([U],[],[]),list_canister_snapshots:t.Func([M],[c],[]),load_canister_snapshot:t.Func([u],[],[]),node_metrics_history:t.Func([y],[S],[]),provisional_create_canister_with_cycles:t.Func([V],[ee],[]),provisional_top_up_canister:t.Func([fe],[],[]),raw_rand:t.Func([],[he],[]),schnorr_public_key:t.Func([p],[f],[]),sign_with_ecdsa:t.Func([l],[v],[]),sign_with_schnorr:t.Func([H],[K],[]),start_canister:t.Func([ye],[],[]),stop_canister:t.Func([_e],[],[]),stored_chunks:t.Func([we],[pe],[]),subnet_info:t.Func([Se],[Oe],[]),take_canister_snapshot:t.Func([Hi],[Yi],[]),uninstall_code:t.Func([Wi],[],[]),update_settings:t.Func([Li],[],[]),upload_chunk:t.Func([zi],[Xt],[])})};class pu extends Me{constructor(e,r,n,i){super(["Call failed:",`  Canister: ${e.toText()}`,`  Method: ${r} (${n})`,...Object.getOwnPropertyNames(i).map(s=>`  "${s}": ${JSON.stringify(i[s])}`)].join(`
`)),this.canisterId=e,this.methodName=r,this.type=n,this.props=i}}class Th extends pu{constructor(e,r,n){var i;super(e,r,"query",{Status:n.status,Code:(i=xs[n.reject_code])!==null&&i!==void 0?i:`Unknown Code "${n.reject_code}"`,Message:n.reject_message}),this.result=n}}class Xo extends pu{constructor(e,r,n,i,s,a,o){super(e,r,"update",Object.assign({"Request ID":ke(n)},i.body?Object.assign(Object.assign({},o?{"Error code":o}:{}),{"Reject code":String(s),"Reject message":a}):{"HTTP status code":i.status.toString(),"HTTP status text":i.statusText})),this.requestId=n,this.response=i,this.reject_code=s,this.reject_message=a,this.error_code=o}}const ht=Symbol.for("ic-agent-metadata");class no{constructor(e){this[ht]=Object.freeze(e)}static agentOf(e){return e[ht].config.agent}static interfaceOf(e){return e[ht].service}static canisterIdOf(e){return be.from(e[ht].config.canisterId)}static async install(e,r){const n=e.mode===void 0?{install:null}:e.mode,i=e.arg?[...new Uint8Array(e.arg)]:[],s=[...new Uint8Array(e.module)],a=typeof r.canisterId=="string"?be.fromText(r.canisterId):r.canisterId;await Jo(r).install_code({mode:n,arg:i,wasm_module:s,canister_id:a,sender_canister_version:[]})}static async createCanister(e,r){function n(s){return[{controllers:s.controllers?[s.controllers]:[],compute_allocation:s.compute_allocation?[s.compute_allocation]:[],freezing_threshold:s.freezing_threshold?[s.freezing_threshold]:[],memory_allocation:s.memory_allocation?[s.memory_allocation]:[],reserved_cycles_limit:[],log_visibility:[],wasm_memory_limit:[]}]}const{canister_id:i}=await Jo(e||{}).provisional_create_canister_with_cycles({amount:[],settings:n(r||{}),specified_id:[],sender_canister_version:[]});return i}static async createAndInstallCanister(e,r,n){const i=await this.createCanister(n);return await this.install(Object.assign({},r),Object.assign(Object.assign({},n),{canisterId:i})),this.createActor(e,Object.assign(Object.assign({},n),{canisterId:i}))}static createActorClass(e,r){const n=e({IDL:$f});class i extends no{constructor(a){if(!a.canisterId)throw new Me(`Canister ID is required, but received ${typeof a.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);const o=typeof a.canisterId=="string"?be.fromText(a.canisterId):a.canisterId;super({config:Object.assign(Object.assign(Object.assign({},yu),a),{canisterId:o}),service:n});for(const[h,w]of n._fields)r!=null&&r.httpDetails&&w.annotations.push(Cs),r!=null&&r.certificate&&w.annotations.push(wu),this[h]=Sh(this,h,w,a.blsVerify)}}return i}static createActor(e,r){if(!r.canisterId)throw new Me(`Canister ID is required, but received ${typeof r.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);return new(this.createActorClass(e))(r)}static createActorWithHttpDetails(e,r){return new(this.createActorClass(e,{httpDetails:!0}))(r)}static createActorWithExtendedDetails(e,r,n={httpDetails:!0,certificate:!0}){return new(this.createActorClass(e,n))(r)}}function Cr(t,e){const r=Ia(t,aa.Buffer.from(e));switch(r.length){case 0:return;case 1:return r[0];default:return r}}const yu={pollingStrategyFactory:hu},Cs="http-details",wu="certificate";function Sh(t,e,r,n){let i;r.annotations.includes("query")||r.annotations.includes("composite_query")?i=async(a,...o)=>{var h,w;a=Object.assign(Object.assign({},a),(w=(h=t[ht].config).queryTransform)===null||w===void 0?void 0:w.call(h,e,o,Object.assign(Object.assign({},t[ht].config),a)));const A=a.agent||t[ht].config.agent||Do(),_=be.from(a.canisterId||t[ht].config.canisterId),m=vs(r.argTypes,o),E=await A.query(_,{methodName:e,arg:m,effectiveCanisterId:a.effectiveCanisterId}),T=Object.assign(Object.assign({},E.httpDetails),{requestDetails:E.requestDetails});switch(E.status){case"rejected":throw new Th(_,e,E);case"replied":return r.annotations.includes(Cs)?{httpDetails:T,result:Cr(r.retTypes,E.reply.arg)}:Cr(r.retTypes,E.reply.arg)}}:i=async(a,...o)=>{var h,w;a=Object.assign(Object.assign({},a),(w=(h=t[ht].config).callTransform)===null||w===void 0?void 0:w.call(h,e,o,Object.assign(Object.assign({},t[ht].config),a)));const A=a.agent||t[ht].config.agent||Do(),{canisterId:_,effectiveCanisterId:m,pollingStrategyFactory:E}=Object.assign(Object.assign(Object.assign({},yu),t[ht].config),a),T=be.from(_),O=m!==void 0?be.from(m):T,Y=vs(r.argTypes,o),{requestId:C,response:G,requestDetails:F}=await A.call(T,{methodName:e,arg:Y,effectiveCanisterId:O});let z,L;if(G.body&&G.body.certificate){if(A.rootKey==null)throw new Error("Agent is missing root key");const $=G.body.certificate;L=await Er.create({certificate:vr($),rootKey:A.rootKey,canisterId:be.from(_),blsVerify:n});const k=[new TextEncoder().encode("request_status"),C];switch(new TextDecoder().decode(dt(L.lookup([...k,"status"])))){case"replied":z=dt(L.lookup([...k,"reply"]));break;case"rejected":{const X=new Uint8Array(dt(L.lookup([...k,"reject_code"])))[0],q=new TextDecoder().decode(dt(L.lookup([...k,"reject_message"]))),Z=dt(L.lookup([...k,"error_code"])),Q=Z?new TextDecoder().decode(Z):void 0;throw new Xo(T,e,C,G,X,q,Q)}}}else if(G.body&&"reject_message"in G.body){const{reject_code:$,reject_message:k,error_code:te}=G.body;throw new Xo(T,e,C,G,$,k,te)}if(G.status===202){const $=E(),k=await du(A,O,C,$,n);L=k.certificate,z=k.reply}const j=r.annotations.includes(Cs),W=r.annotations.includes(wu),D=Object.assign(Object.assign({},G),{requestDetails:F});if(z!==void 0)return j&&W?{httpDetails:D,certificate:L,result:Cr(r.retTypes,z)}:W?{certificate:L,result:Cr(r.retTypes,z)}:j?{httpDetails:D,result:Cr(r.retTypes,z)}:Cr(r.retTypes,z);if(r.retTypes.length===0)return j?{httpDetails:G,result:void 0}:void 0;throw new Error(`Call was returned undefined, but type [${r.retTypes.join(",")}].`)};const s=(...a)=>i({},...a);return s.withOptions=a=>(...o)=>i(a,...o),s}function Jo(t){function e(r,n){if(t.effectiveCanisterId)return{effectiveCanisterId:be.from(t.effectiveCanisterId)};const i=n[0];let s=be.fromHex("");return i&&typeof i=="object"&&i.target_canister&&r==="install_chunked_code"&&(s=be.from(i.target_canister)),i&&typeof i=="object"&&i.canister_id&&(s=be.from(i.canister_id)),{effectiveCanisterId:s}}return no.createActor(Ah,Object.assign(Object.assign(Object.assign({},t),{canisterId:be.fromHex("")}),{callTransform:e,queryTransform:e}))}var Ai=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},ar=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},fi,li,Hr,Yr;function Qo(t){return t!==null&&typeof t=="object"}class Lt{constructor(e){if(fi.set(this,void 0),li.set(this,void 0),e.byteLength!==Lt.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");Ai(this,fi,jt(e),"f"),Ai(this,li,Lt.derEncode(e),"f")}static from(e){if(typeof e=="string"){const r=zt(e);return this.fromRaw(r)}else if(Qo(e)){const r=e;if(Qo(r)&&Object.hasOwnProperty.call(r,"__derEncodedPublicKey__"))return this.fromDer(r);if(ArrayBuffer.isView(r)){const n=r;return this.fromRaw(jt(n.buffer))}else{if(r instanceof ArrayBuffer)return this.fromRaw(r);if("rawKey"in r)return this.fromRaw(r.rawKey);if("derKey"in r)return this.fromDer(r.derKey);if("toDer"in r)return this.fromDer(r.toDer())}}throw new Error("Cannot construct Ed25519PublicKey from the provided key.")}static fromRaw(e){return new Lt(e)}static fromDer(e){return new Lt(this.derDecode(e))}static derEncode(e){const r=ru(e,Bi).buffer;return r.__derEncodedPublicKey__=void 0,r}static derDecode(e){const r=nu(e,Bi);if(r.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return jt(r)}get rawKey(){return ar(this,fi,"f")}get derKey(){return ar(this,li,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}fi=new WeakMap,li=new WeakMap;Lt.RAW_KEY_LENGTH=32;class cr extends zs{constructor(e,r){super(),Hr.set(this,void 0),Yr.set(this,void 0),Ai(this,Hr,Lt.from(e),"f"),Ai(this,Yr,new Uint8Array(r),"f")}static generate(e){if(e&&e.length!==32)throw new Error("Ed25519 Seed needs to be 32 bytes long.");e||(e=qr.utils.randomPrivateKey()),In(e,new Uint8Array(new Array(32).fill(0)))&&console.warn("Seed is all zeros. This is not a secure seed. Please provide a seed with sufficient entropy if this is a production environment.");const r=new Uint8Array(32);for(let i=0;i<32;i++)r[i]=new Uint8Array(e)[i];const n=qr.getPublicKey(r);return cr.fromKeyPair(n,r)}static fromParsedJson(e){const[r,n]=e;return new cr(Lt.fromDer(zt(r)),zt(n))}static fromJSON(e){const r=JSON.parse(e);if(Array.isArray(r)){if(typeof r[0]=="string"&&typeof r[1]=="string")return this.fromParsedJson([r[0],r[1]]);throw new Error("Deserialization error: JSON must have at least 2 items.")}throw new Error(`Deserialization error: Invalid JSON type for string: ${JSON.stringify(e)}`)}static fromKeyPair(e,r){return new cr(Lt.fromRaw(e),r)}static fromSecretKey(e){const r=qr.getPublicKey(new Uint8Array(e));return cr.fromKeyPair(r,e)}toJSON(){return[ke(ar(this,Hr,"f").toDer()),ke(ar(this,Yr,"f"))]}getKeyPair(){return{secretKey:ar(this,Yr,"f"),publicKey:ar(this,Hr,"f")}}getPublicKey(){return ar(this,Hr,"f")}async sign(e){const r=new Uint8Array(e),n=yn(qr.sign(r,ar(this,Yr,"f").slice(0,32)));return Object.defineProperty(n,"__signature__",{enumerable:!1,value:void 0}),n}static verify(e,r,n){const[i,s,a]=[e,r,n].map(o=>(typeof o=="string"&&(o=zt(o)),o instanceof Uint8Array&&(o=jt(o.buffer)),new Uint8Array(o)));return qr.verify(i,s,a)}}Hr=new WeakMap,Yr=new WeakMap;class io extends Error{constructor(e){super(e),this.message=e,Object.setPrototypeOf(this,io.prototype)}}function ea(t){if(typeof global<"u"&&global.crypto&&global.crypto.subtle)return global.crypto.subtle;if(t)return t;if(typeof crypto<"u"&&crypto.subtle)return crypto.subtle;throw new io("Global crypto was not available and none was provided. Please inlcude a SubtleCrypto implementation. See https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto")}class Ti extends zs{constructor(e,r,n){super(),this._keyPair=e,this._derKey=r,this._subtleCrypto=n}static async generate(e){const{extractable:r=!1,keyUsages:n=["sign","verify"],subtleCrypto:i}=e??{},s=ea(i),a=await s.generateKey({name:"ECDSA",namedCurve:"P-256"},r,n),o=await s.exportKey("spki",a.publicKey);return new this(a,o,s)}static async fromKeyPair(e,r){const n=ea(r),i=await n.exportKey("spki",e.publicKey);return new Ti(e,i,n)}getKeyPair(){return this._keyPair}getPublicKey(){const e=this._derKey,r=Object.create(this._keyPair.publicKey);return r.toDer=function(){return e},r}async sign(e){const r={name:"ECDSA",hash:{name:"SHA-256"}};return await this._subtleCrypto.sign(r,this._keyPair.privateKey,e)}}var Nh=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},$r=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Ct;class Ih{constructor(e){Ct.set(this,void 0),Nh(this,Ct,e,"f")}get rawKey(){return $r(this,Ct,"f").rawKey}get derKey(){return $r(this,Ct,"f").derKey}toDer(){return $r(this,Ct,"f").toDer()}getPublicKey(){return $r(this,Ct,"f")}getPrincipal(){if(!$r(this,Ct,"f").rawKey)throw new Error("Cannot get principal from a public key without a raw key.");return be.fromUint8Array(new Uint8Array($r(this,Ct,"f").rawKey))}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}}Ct=new WeakMap;var Rh=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Uh=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Oh=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},hi;const Fh=new TextEncoder().encode("ic-request-auth-delegation"),Ph=new TextEncoder().encode(`
ic-request`);function ps(t){if(typeof t!="string"||t.length<64)throw new Error("Invalid public key.");return zt(t)}class so{constructor(e,r,n){this.pubkey=e,this.expiration=r,this.targets=n}toCBOR(){return ct.value.map(Object.assign({pubkey:ct.value.bytes(this.pubkey),expiration:ct.value.u64(this.expiration.toString(16),16)},this.targets&&{targets:ct.value.array(this.targets.map(e=>ct.value.bytes(vr(e.toUint8Array()))))}))}toJSON(){return Object.assign({expiration:this.expiration.toString(16),pubkey:ke(this.pubkey)},this.targets&&{targets:this.targets.map(e=>e.toHex())})}}async function kh(t,e,r,n){const i=new so(e.toDer(),BigInt(+r)*BigInt(1e6),n),s=new Uint8Array([...Fh,...new Uint8Array(mn(Object.assign({},i)))]),a=await t.sign(vr(s));return{delegation:i,signature:a}}class Si{constructor(e,r){this.delegations=e,this.publicKey=r}static async create(e,r,n=new Date(Date.now()+15*60*1e3),i={}){var s,a;const o=await kh(e,r,n,i.targets);return new Si([...((s=i.previous)===null||s===void 0?void 0:s.delegations)||[],o],((a=i.previous)===null||a===void 0?void 0:a.publicKey)||e.getPublicKey().toDer())}static fromJSON(e){const{publicKey:r,delegations:n}=typeof e=="string"?JSON.parse(e):e;if(!Array.isArray(n))throw new Error("Invalid delegations.");const i=n.map(s=>{const{delegation:a,signature:o}=s,{pubkey:h,expiration:w,targets:A}=a;if(A!==void 0&&!Array.isArray(A))throw new Error("Invalid targets.");return{delegation:new so(ps(h),BigInt("0x"+w),A&&A.map(_=>{if(typeof _!="string")throw new Error("Invalid target.");return be.fromHex(_)})),signature:ps(o)}});return new this(i,ps(r))}static fromDelegations(e,r){return new this(e,r)}toJSON(){return{delegations:this.delegations.map(e=>{const{delegation:r,signature:n}=e,{targets:i}=r;return{delegation:Object.assign({expiration:r.expiration.toString(16),pubkey:ke(r.pubkey)},i&&{targets:i.map(s=>s.toHex())}),signature:ke(n)}}),publicKey:ke(this.publicKey)}}}class ta extends zs{constructor(e,r){super(),this._inner=e,this._delegation=r}static fromDelegation(e,r){return new this(e,r)}getDelegation(){return this._delegation}getPublicKey(){return{derKey:this._delegation.publicKey,toDer:()=>this._delegation.publicKey}}sign(e){return this._inner.sign(e)}async transformRequest(e){const{body:r}=e,n=Oh(e,["body"]),i=await mn(r);return Object.assign(Object.assign({},n),{body:{content:r,sender_sig:await this.sign(vr(new Uint8Array([...Ph,...new Uint8Array(i)]))),sender_delegation:this._delegation.delegations,sender_pubkey:this._delegation.publicKey}})}}class Ni extends Ih{constructor(e,r){super(e),hi.set(this,void 0),Rh(this,hi,r,"f")}get delegation(){return Uh(this,hi,"f")}static fromDelegation(e,r){return new Ni(e,r)}}hi=new WeakMap;function Mh(t,e){for(const{delegation:n}of t.delegations)if(+new Date(Number(n.expiration/BigInt(1e6)))<=+Date.now())return!1;const r=[];for(const n of r){const i=n.toText();for(const{delegation:s}of t.delegations){if(s.targets===void 0)continue;let a=!0;for(const o of s.targets)if(o.toText()===i){a=!1;break}if(a)return!1}}return!0}var ra;(function(t){t[t.ECDSA_WITH_SHA256=-7]="ECDSA_WITH_SHA256"})(ra||(ra={}));const na=["mousedown","mousemove","keydown","touchstart","wheel"];class $s{constructor(e={}){var r;this.callbacks=[],this.idleTimeout=10*60*1e3,this.timeoutID=void 0;const{onIdle:n,idleTimeout:i=10*60*1e3}=e||{};this.callbacks=n?[n]:[],this.idleTimeout=i;const s=this._resetTimer.bind(this);window.addEventListener("load",s,!0),na.forEach(function(o){document.addEventListener(o,s,!0)});const a=(o,h)=>{let w;return(...A)=>{const _=this,m=function(){w=void 0,o.apply(_,A)};clearTimeout(w),w=window.setTimeout(m,h)}};if(e!=null&&e.captureScroll){const o=a(s,(r=e==null?void 0:e.scrollDebounce)!==null&&r!==void 0?r:100);window.addEventListener("scroll",o,!0)}s()}static create(e={}){return new this(e)}registerCallback(e){this.callbacks.push(e)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);const e=this._resetTimer.bind(this);na.forEach(function(r){document.removeEventListener(r,e,!0)}),this.callbacks.forEach(r=>r())}_resetTimer(){const e=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(e,this.idleTimeout)}}const Ch=(t,e)=>e.some(r=>t instanceof r);let ia,sa;function $h(){return ia||(ia=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function qh(){return sa||(sa=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const gu=new WeakMap,qs=new WeakMap,mu=new WeakMap,ys=new WeakMap,oo=new WeakMap;function Vh(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(fr(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&gu.set(r,t)}).catch(()=>{}),oo.set(e,t),e}function Gh(t){if(qs.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});qs.set(t,e)}let Vs={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return qs.get(t);if(e==="objectStoreNames")return t.objectStoreNames||mu.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return fr(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Kh(t){Vs=t(Vs)}function jh(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(ws(this),e,...r);return mu.set(n,e.sort?e.sort():[e]),fr(n)}:qh().includes(t)?function(...e){return t.apply(ws(this),e),fr(gu.get(this))}:function(...e){return fr(t.apply(ws(this),e))}}function Hh(t){return typeof t=="function"?jh(t):(t instanceof IDBTransaction&&Gh(t),Ch(t,$h())?new Proxy(t,Vs):t)}function fr(t){if(t instanceof IDBRequest)return Vh(t);if(ys.has(t))return ys.get(t);const e=Hh(t);return e!==t&&(ys.set(t,e),oo.set(e,t)),e}const ws=t=>oo.get(t);function Yh(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=fr(a);return n&&a.addEventListener("upgradeneeded",h=>{n(fr(a.result),h.oldVersion,h.newVersion,fr(a.transaction),h)}),r&&a.addEventListener("blocked",h=>r(h.oldVersion,h.newVersion,h)),o.then(h=>{s&&h.addEventListener("close",()=>s()),i&&h.addEventListener("versionchange",w=>i(w.oldVersion,w.newVersion,w))}).catch(()=>{}),o}const Wh=["get","getKey","getAll","getAllKeys","count"],Lh=["put","add","delete","clear"],gs=new Map;function oa(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(gs.get(e))return gs.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=Lh.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||Wh.includes(r)))return;const s=async function(a,...o){const h=this.transaction(a,i?"readwrite":"readonly");let w=h.store;return n&&(w=w.index(o.shift())),(await Promise.all([w[r](...o),i&&h.done]))[0]};return gs.set(e,s),s}Kh(t=>({...t,get:(e,r,n)=>oa(e,r)||t.get(e,r,n),has:(e,r)=>!!oa(e,r)||t.has(e,r)}));const bu="auth-client-db",_u="ic-keyval",zh=async(t=bu,e=_u,r)=>(xu&&(localStorage!=null&&localStorage.getItem(Kt))&&(localStorage.removeItem(Kt),localStorage.removeItem(Vt)),await Yh(t,r,{upgrade:n=>{n.objectStoreNames.contains(e)&&n.clear(e),n.createObjectStore(e)}}));async function Zh(t,e,r){return await t.get(e,r)}async function Dh(t,e,r,n){return await t.put(e,n,r)}async function Xh(t,e,r){return await t.delete(e,r)}class ji{constructor(e,r){this._db=e,this._storeName=r}static async create(e){const{dbName:r=bu,storeName:n=_u,version:i=td}=e??{},s=await zh(r,n,i);return new ji(s,n)}async set(e,r){return await Dh(this._db,this._storeName,e,r)}async get(e){var r;return(r=await Zh(this._db,this._storeName,e))!==null&&r!==void 0?r:null}async remove(e){return await Xh(this._db,this._storeName,e)}}var Jh=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Qh=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},di;const Vt="identity",Kt="delegation",ed="iv",td=1,xu=typeof window<"u";class Eu{constructor(e="ic-",r){this.prefix=e,this._localStorage=r}get(e){return Promise.resolve(this._getLocalStorage().getItem(this.prefix+e))}set(e,r){return this._getLocalStorage().setItem(this.prefix+e,r),Promise.resolve()}remove(e){return this._getLocalStorage().removeItem(this.prefix+e),Promise.resolve()}_getLocalStorage(){if(this._localStorage)return this._localStorage;const e=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.localStorage:global.localStorage:window.localStorage;if(!e)throw new Error("Could not find local storage.");return e}}class vu{constructor(e){di.set(this,void 0),Jh(this,di,e??{},"f")}get _db(){return new Promise(e=>{if(this.initializedDb){e(this.initializedDb);return}ji.create(Qh(this,di,"f")).then(r=>{this.initializedDb=r,e(r)})})}async get(e){return await(await this._db).get(e)}async set(e,r){await(await this._db).set(e,r)}async remove(e){await(await this._db).remove(e)}}di=new WeakMap;const rd="https://identity.internetcomputer.org",nd="#authorize",ms="ECDSA",bs="Ed25519",id=500,Bu="UserInterrupt";class sd{constructor(e,r,n,i,s,a,o,h){this._identity=e,this._key=r,this._chain=n,this._storage=i,this.idleManager=s,this._createOptions=a,this._idpWindow=o,this._eventHandler=h,this._registerDefaultIdleCallback()}static async create(e={}){var r,n,i;const s=(r=e.storage)!==null&&r!==void 0?r:new vu,a=(n=e.keyType)!==null&&n!==void 0?n:ms;let o=null;if(e.identity)o=e.identity;else{let _=await s.get(Vt);if(!_&&xu)try{const m=new Eu,E=await m.get(Kt),T=await m.get(Vt);E&&T&&a===ms&&(console.log("Discovered an identity stored in localstorage. Migrating to IndexedDB"),await s.set(Kt,E),await s.set(Vt,T),_=E,await m.remove(Kt),await m.remove(Vt))}catch(m){console.error("error while attempting to recover localstorage: "+m)}if(_)try{typeof _=="object"?a===bs&&typeof _=="string"?o=await cr.fromJSON(_):o=await Ti.fromKeyPair(_):typeof _=="string"&&(o=cr.fromJSON(_))}catch{}}let h=new mi,w=null;if(o)try{const _=await s.get(Kt);if(typeof _=="object"&&_!==null)throw new Error("Delegation chain is incorrectly stored. A delegation chain should be stored as a string.");e.identity?h=e.identity:_&&(w=Si.fromJSON(_),Mh(w)?"toDer"in o?h=Ni.fromDelegation(o,w):h=ta.fromDelegation(o,w):(await _s(s),o=null))}catch(_){console.error(_),await _s(s),o=null}let A;return!((i=e.idleOptions)===null||i===void 0)&&i.disableIdle?A=void 0:(w||e.identity)&&(A=$s.create(e.idleOptions)),o||(a===bs?(o=await cr.generate(),await s.set(Vt,JSON.stringify(o.toJSON()))):(e.storage&&a===ms&&console.warn(`You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '${bs}' as the key type, as it can serialize to a string`),o=await Ti.generate(),await s.set(Vt,o.getKeyPair()))),new this(h,o,w,s,A,e)}_registerDefaultIdleCallback(){var e,r;const n=(e=this._createOptions)===null||e===void 0?void 0:e.idleOptions;!(n!=null&&n.onIdle)&&!(n!=null&&n.disableDefaultIdleCallback)&&((r=this.idleManager)===null||r===void 0||r.registerCallback(()=>{this.logout(),location.reload()}))}async _handleSuccess(e,r){var n,i;const s=e.delegations.map(w=>({delegation:new so(w.delegation.pubkey,w.delegation.expiration,w.delegation.targets),signature:w.signature.buffer})),a=Si.fromDelegations(s,e.userPublicKey.buffer),o=this._key;if(!o)return;this._chain=a,"toDer"in o?this._identity=Ni.fromDelegation(o,this._chain):this._identity=ta.fromDelegation(o,this._chain),(n=this._idpWindow)===null||n===void 0||n.close();const h=(i=this._createOptions)===null||i===void 0?void 0:i.idleOptions;!this.idleManager&&!(h!=null&&h.disableIdle)&&(this.idleManager=$s.create(h),this._registerDefaultIdleCallback()),this._removeEventListener(),delete this._idpWindow,this._chain&&await this._storage.set(Kt,JSON.stringify(this._chain.toJSON())),r==null||r(e)}getIdentity(){return this._identity}async isAuthenticated(){return!this.getIdentity().getPrincipal().isAnonymous()&&this._chain!==null}async login(e){var r,n,i,s;const a=BigInt(8)*BigInt(36e11),o=new URL(((r=e==null?void 0:e.identityProvider)===null||r===void 0?void 0:r.toString())||rd);o.hash=nd,(n=this._idpWindow)===null||n===void 0||n.close(),this._removeEventListener(),this._eventHandler=this._getEventHandler(o,Object.assign({maxTimeToLive:(i=e==null?void 0:e.maxTimeToLive)!==null&&i!==void 0?i:a},e)),window.addEventListener("message",this._eventHandler),this._idpWindow=(s=window.open(o.toString(),"idpWindow",e==null?void 0:e.windowOpenerFeatures))!==null&&s!==void 0?s:void 0;const h=()=>{this._idpWindow&&(this._idpWindow.closed?this._handleFailure(Bu,e==null?void 0:e.onError):setTimeout(h,id))};h()}_getEventHandler(e,r){return async n=>{var i,s,a;if(n.origin!==e.origin)return;const o=n.data;switch(o.kind){case"authorize-ready":{const h=Object.assign({kind:"authorize-client",sessionPublicKey:new Uint8Array((i=this._key)===null||i===void 0?void 0:i.getPublicKey().toDer()),maxTimeToLive:r==null?void 0:r.maxTimeToLive,allowPinAuthentication:r==null?void 0:r.allowPinAuthentication,derivationOrigin:(s=r==null?void 0:r.derivationOrigin)===null||s===void 0?void 0:s.toString()},r==null?void 0:r.customValues);(a=this._idpWindow)===null||a===void 0||a.postMessage(h,e.origin);break}case"authorize-client-success":try{await this._handleSuccess(o,r==null?void 0:r.onSuccess)}catch(h){this._handleFailure(h.message,r==null?void 0:r.onError)}break;case"authorize-client-failure":this._handleFailure(o.text,r==null?void 0:r.onError);break}}}_handleFailure(e,r){var n;(n=this._idpWindow)===null||n===void 0||n.close(),r==null||r(e),this._removeEventListener(),delete this._idpWindow}_removeEventListener(){this._eventHandler&&window.removeEventListener("message",this._eventHandler),this._eventHandler=void 0}async logout(e={}){if(await _s(this._storage),this._identity=new mi,this._chain=null,e.returnTo)try{window.history.pushState({},"",e.returnTo)}catch{window.location.href=e.returnTo}}}async function _s(t){await t.remove(Vt),await t.remove(Kt),await t.remove(ed)}const Ed=Object.freeze(Object.defineProperty({__proto__:null,AuthClient:sd,ERROR_USER_INTERRUPT:Bu,IdbKeyVal:ji,IdbStorage:vu,IdleManager:$s,KEY_STORAGE_DELEGATION:Kt,KEY_STORAGE_KEY:Vt,LocalStorage:Eu},Symbol.toStringTag,{value:"Module"}));export{sd as A,pn as H,Ku as _,no as a,aa as b,Ed as i};
